(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5468:function(e,t,a){e.exports=a(5685)},5510:function(e,t,a){},5685:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(28),o=a.n(c),i=a(24),l=a(11);Object(l.b)();a(5510);var s=a(3),u=a(14),m=a(7),d=a.n(m),p=a(8),g=a(37),f={drawerWidth:240},b={light:{primary:"#C4C3C4",secondary:"#656774",error:"#AA2121",background:"#F4F3F4",accent:"#000",accentAlt:"#fff"},dark:{primary:"#949C9B",secondary:"#A1A4AD",error:"#ff4181",background:"#241C2B",accent:"#fff",accentAlt:"#000"}},h=function(e){var t=b[e];return t?{primary:{main:t.primary},secondary:{main:t.secondary},error:{main:t.error},background:{default:t.background}}:{}},v=function(e,t){return Object(g.createMuiTheme)(Object(p.a)({palette:Object(p.a)({type:void 0!==t?t:e},h(e)),typography:{useNextVariants:!0}},f,b[e]))},E=Object(n.createContext)(null),y=function(){return Object(n.useContext)(E)};function O(e){var t=e.children,a=e.initialTheme,c=Object(n.useReducer)(function(e,t){switch(t){case"light":case"dark":return t;case"toggle":return"light"===e?"dark":"light";default:return e}},a),o=Object(s.a)(c,2),i=o[0],u=o[1];return r.a.createElement(l.a,{theme:v(i)},r.a.createElement(E.Provider,{value:[i,u]},t))}var j=a(1),w=a(51),x=a(10),k=a(23),N=a.n(k),C=a(27),S=a(33),_=a.n(S),W=a(231),D=a(232),T=a(34),I=a.n(T),R=function(){return I.a.get("access_token")},q=function(){return void 0!==R()},L=function(){return I.a.get("user_id")},F=function(){return I.a.get("username")},U=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_SERVER_IP,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_SERVER_TIMEOUT||1e4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(W.a)(this,e);var c="".concat(a?"https://":"http://").concat(t);this.baseURL=c,this.client=_.a.create({baseURL:c,timeout:n,headers:r})}return Object(D.a)(e,[{key:"makeRequester",value:function(e){var t=this;return function(a,n,r){return t.request(e,a,n,r)}}},{key:"request",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(arguments.length>4&&void 0!==arguments[4]&&arguments[4]){var r={username:R()};n.auth=r}switch(e){case"request":case"getUri":return this.client[e](n);case"get":case"delete":case"head":case"options":return this.client[e](t,Object(p.a)({},n,{params:a}));case"post":case"put":case"patch":return this.client[e](t,a,n);default:return this.client.request(Object(p.a)({url:t,method:e,params:a,data:a},n))}}},{key:"getData",value:function(){var e=Object(C.a)(N.a.mark(function e(t){var a,n,r,c,o,i,l,s=arguments;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:null,n=s.length>2&&void 0!==s[2]?s[2]:[],r=s.length>3&&void 0!==s[3]?s[3]:[],c=s.length>4&&void 0!==s[4]?s[4]:0,o=s.length>5&&void 0!==s[5]?s[5]:10,i=s.length>6&&void 0!==s[6]&&s[6],l="b=".concat(c,"&l=").concat(o),null!==a&&(l+="&q=".concat(a)),e.abrupt("return",this.request("get","/".concat(t,"?").concat(l),{filters:n,sorters:r},{},i));case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}()),P=function(){var e=Object(C.a)(N.a.mark(function e(t){var a,n,r,c,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.request("post","/login",t);case 3:return a=e.sent,n=a.data,r=n.response,c=1e3*r.expires_in_secs-36e5,o=new Date((new Date).getTime()+c),I.a.set("access_token",r.token,{expires:o}),I.a.set("user_id",n.response.user_id,{expires:o}),I.a.set("username",n.response.username,{expires:o}),e.abrupt("return",n);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(C.a)(N.a.mark(function e(t){var a,n,r,c,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.request("post","/users",t);case 3:return a=e.sent,n=a.data,r=n.response,c=1e3*r.expires_in_secs-36e5,o=new Date((new Date).getTime()+c),I.a.set("access_token",r.token,{expires:o}),I.a.set("user_id",n.response.user_id,{expires:o}),I.a.set("username",n.response.username,{expires:o}),e.abrupt("return",n);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}));return function(t){return e.apply(this,arguments)}}(),M=function(){I.a.remove("access_token")},z={loading:!1,success:!1},G=function(e,t){switch(t){case"submit":return{loading:!0,success:!1};case"success":return{loading:!1,success:!0};case"error":case"initial":return z;default:return e}},B={loading:!1,success:!1},J=function(e,t){switch(t){case"loading":return{loading:!0,success:!1};case"success":return{loading:!1,success:!0};case"error":case"initial":return B;default:return e}},V={action:null,credentials:null},H=function(e,t){switch(t.type){case"register":case"login":return{action:t.type,credentials:t.credentials};case"logout":return{action:t.type};default:return e}},K=Object(n.createContext)(null),Q=function(){return Object(n.useContext)(K)};function Y(e){var t=e.children,a=Object(n.useReducer)(G,z),c=Object(s.a)(a,2),o=c[0],i=c[1],l=Object(n.useReducer)(J,B),u=Object(s.a)(l,2),m=u[0],d=u[1],g=Object(n.useReducer)(H,V),f=Object(s.a)(g,2),b=f[0],h=f[1],v=Object(n.useState)(q()),E=Object(s.a)(v,2),y=E[0],O=E[1],j=Object(n.useState)({}),w=Object(s.a)(j,2),x=w[0],k=w[1],S=function(){var e=Object(C.a)(N.a.mark(function e(){var t,a,n,r,c,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=b.action,e.next="register"===e.t0?3:"login"===e.t0?19:"logout"===e.t0?35:41;break;case 3:return i("loading"),e.prev=4,e.next=7,A(b.credentials);case 7:(t=e.sent).error?(i("error"),k({message:t.error})):(i("success"),k({}),O(!0)),e.next=18;break;case 11:e.prev=11,e.t1=e.catch(4),a="",e.t1.response?400===(n=e.t1.response.status)?(r=e.t1.response.data.error)["not unique"]?r["not unique"].forEach(function(t){e.t1[t+"Error"]=!0,e.t1[t+"ErrorMsg"]="Must be unique"}):a=e.t1.error:a=n>=500&&n<600?"Server error ".concat(n,", please contact the admins"):"Sorry, unknown error ".concat(n):a=e.t1.request?e.t1.message:"Sorry, unknown error",console.log("auth",e.t1),i("error"),k(Object(p.a)({},e.t1,{message:a}));case 18:return e.abrupt("break",42);case 19:return d("loading"),e.prev=20,e.next=23,P(b.credentials);case 23:(t=e.sent).error?(d("error"),k({message:t.error})):(d("success"),k({}),O(!0)),e.next=34;break;case 27:e.prev=27,e.t2=e.catch(20),c="",e.t2.response?(o=e.t2.response.status,c=401===o?"Invalid login":o>=500&&o<600?"Server error ".concat(o,", please contact the admins"):"Sorry, unknown error ".concat(o)):c=e.t2.request?e.t2.message:"Sorry, unknown error",console.log("auth",e.t2),d("error"),k(Object(p.a)({},e.t2,{message:c}));case 34:return e.abrupt("break",42);case 35:return console.log("auth logging out"),M(),d("initial"),i("initial"),O(!1),e.abrupt("break",42);case 41:return e.abrupt("break",42);case 42:case"end":return e.stop()}},e,null,[[4,11],[20,27]])}));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)(function(){S()},[b]),r.a.createElement(K.Provider,{value:[y,h,x,m,o]},t)}var X=Object(l.c)(function(e){return{root:{display:"flex"},paper:{marginRight:2*e.spacing.unit},rightIcon:{marginLeft:e.spacing.unit},button:{margin:e.spacing.unit},formControl:{margin:e.spacing.unit,minWidth:160}}});function $(e){var t=X(),a=Object(n.useState)(!1),c=Object(s.a)(a,2),o=c[0],l=c[1],m=Object(n.useState)(!1),d=Object(s.a)(m,2),g=d[0],f=d[1],b=Object(n.useRef)(null),h=Q(),v=Object(s.a)(h,1)[0],E=Object(n.useState)([]),y=Object(s.a)(E,2),O=y[0],w=y[1],k=Object(n.useState)(new Map),S=Object(s.a)(k,2),W=S[0],D=S[1],T=Object(n.useState)([]),I=Object(s.a)(T,2),q=I[0],P=I[1],A=Object(n.useState)(new Map),M=Object(s.a)(A,2),z=M[0],G=M[1],B=Object(n.useState)([]),J=Object(s.a)(B,2),V=J[0],H=J[1],K=Object(n.useState)({message:""}),Y=Object(s.a)(K,2),$=Y[0],Z=Y[1],ee=Object(n.useState)({id:"",name:"",labelWidth:0}),te=Object(s.a)(ee,2),ae=te[0],ne=te[1];var re,ce=!1;function oe(){return(oe=Object(C.a)(N.a.mark(function e(){var t,a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $.contacting_id=parseInt(L()),$.contacted_id=W.get(ae.name),console.log("messages sending",$,R()),e.prev=3,e.next=6,U.request("post","/messages/upload",$,{},!0);case 6:return t=e.sent,console.log("messages send",t),a=t.data,le(),e.abrupt("return",a);case 13:throw e.prev=13,e.t0=e.catch(3),console.log("messages send",e.t0),e.t0;case 17:case"end":return e.stop()}},e,null,[[3,13]])}))).apply(this,arguments)}function ie(e){b.current.contains(e.target)||l(!1)}function le(){f(!1),Z("")}return Object(n.useEffect)(function(){if(o&&v){var e=[],t=[];e.push(U.request("get","/users/".concat(L(),"/contacts"))),t.push("contacts"),e.push(U.request("get","/messages/".concat(L()))),t.push("messages"),_.a.all(e).then(function(e){ce||e.forEach(function(e,a){var n=t[a];"contacts"===n?(console.log("contacts: ",e.data.response),w(function(e){for(var t=[],a=new Map,n=0;n<e.length;n++)e[n].contacting_id===parseInt(L())?a.set(e[n].username,e[n].contacted_id):a.set(e[n].username,e[n].contacting_id),t.push(e[n].username);return D(a),t}(e.data.response))):"messages"===n&&(console.log("messages: ",e.data.response),P(function(e){var t=[],a=new Map,n=new Map,r=e.length-1,c=1;if(0===e.length)return G(new Map),[];e[0].contact_username!==F()&&(r--,c--);for(var o=c;o<=r;o+=2)e[o].contacted_id===parseInt(L())?(a.delete(e[o].contact_username),e[o].contact_username!==F()?a.set(e[o].contact_username,[e[o].message,e[o].contacting_id.toString()]):e[o].contact_username===F()&&o%2===0?a.set(e[o+1].contact_username,[e[o].message,e[o].contacting_id.toString()]):a.set(e[o-1].contact_username,[e[o].message,e[o].contacting_id.toString()])):(a.delete(e[o].contact_username),e[o].contact_username!==F()?a.set(e[o].contact_username,[e[o].message,e[o].contacted_id.toString()]):e[o].contact_username===F()&&o%2===0?a.set(e[o+1].contact_username,[e[o].message,e[o].contacted_id.toString()]):a.set(e[o-1].contact_username,[e[o].message,e[o].contacted_id.toString()]));for(var i=r;i>=c;i-=2)n.has(e[i].contact_username)?n.set(e[i].contact_username,n.get(e[i].contact_username).concat([e[i]])):n.set(e[i].contact_username,[e[i]]);G(n);var l=!0,u=!1,m=void 0;try{for(var d,p=a[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var g=d.value,f=Object(s.a)(g,2),b=f[0],h=f[1];t.push([b,h])}}catch(v){u=!0,m=v}finally{try{l||null==p.return||p.return()}finally{if(u)throw m}}return t.reverse()}(e.data.response)))})}).catch(function(e){if(console.log(e),!ce){var t="";if(e.response){console.log(e.response);var a=e.response.status;t=a>=500&&a<600?"Server error ".concat(a,", please contact the admins"):404===a?"Messages not found":403===a?"Messages permission blocked":"Sorry, unknown error ".concat(a)}else e.request?(console.log(e.request),t="Could not connect to the server"):(console.log(e),t="Sorry, unknown error");console.log(t,e)}})}return function(){ce=!0}},[o]),r.a.createElement("div",{className:t.root},r.a.createElement("div",null,r.a.createElement(j.z,{buttonRef:b,"aria-owns":o?"menu-list-grow":void 0,"aria-haspopup":"true",onClick:function(){l(!o)}},r.a.createElement(x.l,null)),r.a.createElement(j.M,{open:o,anchorEl:b.current,placement:"bottom-end",transition:!0,disablePortal:!0},function(e){var a=e.TransitionProps,n=e.placement;return r.a.createElement(j.x,Object.assign({},a,{id:"menu-list-grow",style:{transformOrigin:"bottom"===n?"center top":"center bottom"}}),r.a.createElement(j.L,null,r.a.createElement(j.i,{onClickAway:ie},v?r.a.createElement("div",{className:t.root},r.a.createElement(j.C,{subheader:r.a.createElement(j.H,{component:"div"},"Messages")},r.a.createElement(j.p,null),r.a.createElement(j.D,null,r.a.createElement(j.G,{primary:"New message. . ."}),r.a.createElement(j.F,null,r.a.createElement(j.z,{onClick:function(){return ne({id:"",name:"",labelWidth:0}),H([]),void f(!0)}},r.a.createElement(x.p,null)))),q.map(function(e){return r.a.createElement(j.D,{key:e},r.a.createElement(j.G,{primary:e[0],secondary:r.a.createElement(r.a.Fragment,null,e[1][0])}),r.a.createElement(j.F,null,r.a.createElement(j.z,{onClick:function(){return function(e){f(!0),H(z.get(e[0]).reverse()),ne({id:e[1][1],name:e[0],labelWidth:0})}(e)}},r.a.createElement(x.w,null))))}))):r.a.createElement(j.K,{subheader:r.a.createElement(j.H,{component:"li"},"Messages")},r.a.createElement(j.J,{component:i.b,to:"/login"},r.a.createElement(j.G,{inset:!0,primary:"Please login to chat."}),r.a.createElement(j.E,null,r.a.createElement(x.b,null)))))))})),r.a.createElement(j.k,{open:g,onClose:le,"aria-labelledby":"form-dialog-title"},r.a.createElement(j.m,null,r.a.createElement(j.u,{className:t.formControl},r.a.createElement(j.B,null,"Choose contact. . ."),r.a.createElement(j.P,{value:ae.name,onChange:function(e){ne(Object(p.a)({},ae,Object(u.a)({},e.target.name,e.target.value))),void 0===z.get(e.target.value)?H([]):H(z.get(e.target.value).reverse())},name:"name",renderValue:function(e){return"".concat(e)}},O.map(function(e){return r.a.createElement(j.J,{key:e,value:e},e)}))),r.a.createElement(j.p,null),r.a.createElement(j.C,null,V.map(function(e){return r.a.createElement(j.D,{key:e.message_id},r.a.createElement(j.G,{style:e.contacting_id===parseInt(L())?{textAlign:"right"}:{textAlign:"left"},primary:e.contacting_id===parseInt(L())?e.message+" -":"- "+e.message}))})),r.a.createElement(j.U,{id:"standard-multiline-flexible",label:"Your message. . .",value:$.message,onChange:(re="message",function(e){Z(Object(p.a)({},$,Object(u.a)({},re,e.target.value)))}),multiline:!0,rowsMax:"4",className:t.textField,variant:"outlined"})),r.a.createElement(j.l,null,r.a.createElement(j.b,{onClick:le,color:"primary"},"Cancel"),r.a.createElement(j.b,{variant:"contained",color:"primary",className:t.button,onClick:function(){return oe.apply(this,arguments)}},"Send",r.a.createElement(x.y,{className:t.rightIcon},"send")))))}var Z=a(48),ee=Object(l.c)(function(e){return{masthead:{display:"flex"},appBar:Object(u.a)({},e.breakpoints.up("sm"),{zIndex:e.zIndex.drawer+1}),grow:{flexGrow:1},menuButton:{marginLeft:12,marginRight:12},titleWrap:Object(u.a)({width:"7em"},e.breakpoints.down("xs"),{display:"none"}),title:{textDecoration:"none"},search:Object(u.a)({display:"flex",alignItems:"center",position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(w.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(w.fade)(e.palette.common.white,.25)},marginRight:e.spacing.unit,maxWidth:"50%"},e.breakpoints.up("sm"),{marginLeft:e.spacing.unit,width:"auto"}),searchIconWrap:{width:5*e.spacing.unit,height:"100%",display:"flex",justifyContent:"center"},searchIcon:{width:4*e.spacing.unit,height:4*e.spacing.unit,padding:0},inputRoot:{color:"inherit",width:"100%"},inputInput:Object(u.a)({padding:e.spacing.unit,paddingRight:0,transition:e.transitions.create("width"),maxWidth:"100%"},e.breakpoints.up("sm"),{width:160,"&:focus":{width:260}})}});var te=Object(Z.g)(function(e){var t=ee(),a=y(),c=Object(s.a)(a,2),o=c[0],l=c[1],u=Object(n.useContext)(vt),m=Object(s.a)(u,2)[1],d=Object(n.useState)(null),p=Object(s.a)(d,2),g=p[0],f=p[1],b=Q(),h=Object(s.a)(b,2),v=h[0],E=h[1],O=new URLSearchParams(e.location.search),w=Object(n.useState)(O.get("q")||""),k=Object(s.a)(w,2),N=k[0],C=k[1];Object(n.useEffect)(function(){C(O.get("q")||"")},[e]);var S=function(){f(null)},_=function(t){return function(a){switch(t){case"account":e.history.push("/channel/".concat(L())),S();break;case"options":e.history.push("/options"),S();break;case"login":var n=e.location,r=n.pathname,c=n.search,o=new URLSearchParams(c);o.delete("redirect");var i=[],s=!0,u=!1,m=void 0;try{for(var d,p=o.keys()[Symbol.iterator]();!(s=(d=p.next()).done);s=!0){var g=d.value;i.push(g)}}catch(y){u=!0,m=y}finally{try{s||null==p.return||p.return()}finally{if(u)throw m}}var f=i.length>0,b=new URLSearchParams;if(f||"/"!==r&&"/login"!==r&&"/register"!==r)if(r=r.slice(1),f){var h=o.toString();b.set("redirect",encodeURIComponent("".concat(r,"?").concat(h)))}else b.set("redirect",encodeURIComponent("".concat(r)));var v=b.toString();v?e.history.push("/login?".concat(v)):e.history.push("/login"),S();break;case"logout":E({type:"logout"}),S();break;case"toggle theme":l("toggle")}}},W=function(){e.history.push("/browse?q=".concat(N))},D=Boolean(g),T=[r.a.createElement(j.J,{key:"toggledarkmode"},"Dark Mode",r.a.createElement(j.R,{checked:"dark"===o,onChange:function(){return l("toggle")},"aria-label":"Toggle dark mode"}))],I=[r.a.createElement(j.J,{key:"account",onClick:_("account")},"Account"),r.a.createElement(j.J,{key:"options",onClick:_("options")},"Options"),r.a.createElement(j.J,{key:"logout",onClick:_("logout")},"Log Out")],R=r.a.createElement(j.I,{anchorEl:g,open:D,onClose:S},v?[].concat(I):r.a.createElement(j.J,{key:"login",onClick:_("login")},"Login"),r.a.createElement(j.p,{key:"divider"}),T);return r.a.createElement("div",{className:t.masthead},r.a.createElement(j.a,{className:t.appBar,position:"fixed"},r.a.createElement(j.V,null,r.a.createElement(j.z,{className:t.menuButton,color:"inherit","aria-label":"Menu",onClick:function(){return m("toggle")}},r.a.createElement(x.o,null)),r.a.createElement("div",{className:t.titleWrap},r.a.createElement(j.W,{variant:"h6",component:i.b,to:"/",color:"inherit",className:t.title,noWrap:!0},"MeTube")),r.a.createElement("div",{className:t.search},r.a.createElement("div",{className:t.searchIconWrap},r.a.createElement(j.z,{className:t.searchIcon,color:"inherit","aria-label":"Search",onClick:W},r.a.createElement(x.x,null))),r.a.createElement(j.A,{placeholder:"Search...",classes:{root:t.inputRoot,input:t.inputInput},value:N,onChange:function(e){C(e.currentTarget.value)},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),W())}})),r.a.createElement("div",{className:t.grow}),v&&r.a.createElement(j.z,{"aria-label":"File Upload",onClick:function(){e.history.push("/upload")}},r.a.createElement(x.i,null)),r.a.createElement($,null),r.a.createElement(j.z,{"aria-haspopup":"true",onClick:function(e){f(e.currentTarget)}},r.a.createElement(x.b,null)))),R)}),ae=a(81),ne=a(78),re=a.n(ne),ce=Object(l.c)(function(e){return{drawerWrap:Object(u.a)({},e.breakpoints.up("md"),{width:e.drawerWidth,flexShrink:0}),drawer:{overflowX:"hidden"},list:{width:e.drawerWidth},header:{display:"flex",position:"relative",alignItems:"center",minHeight:64,paddingLeft:24,paddingRight:24,color:e.secondary},menuButton:{marginLeft:12,marginRight:12},titleWrap:{width:"7em"},title:{textDecoration:"none"}}});function oe(){var e=ce(),t=Object(n.useContext)(vt),a=Object(s.a)(t,2),c=a[0],o=a[1],u=Q(),m=Object(s.a)(u,1)[0],d=Object(l.d)(),p=Object(ae.unstable_useMediaQuery)(d.breakpoints.down("sm"))||document.body.clientWidth<d.breakpoints.values.md;Object(n.useEffect)(function(){p?o(!1):setTimeout(function(){document.body.clientWidth>=d.breakpoints.values.md&&o(!0)},330)},[p]);var g=function(e){return function(){o(e)}},f=r.a.createElement("div",{className:e.list},r.a.createElement("div",{className:e.header},r.a.createElement(j.z,{className:e.menuButton,color:"inherit","aria-label":"Menu",onClick:g(!1)},r.a.createElement(re.a,null)),r.a.createElement("div",{className:e.titleWrap},r.a.createElement(j.W,{variant:"h6",component:i.b,to:"/",color:"inherit",className:e.title,noWrap:!0},"MeTube"))),r.a.createElement(j.C,null,r.a.createElement(j.D,{button:!0,component:i.b,to:"/",key:"Home"},r.a.createElement(j.E,null,r.a.createElement(x.m,null)),r.a.createElement(j.G,{primary:"Home"})),m?r.a.createElement(r.a.Fragment,null):null,r.a.createElement(j.p,null),r.a.createElement(j.D,{button:!0,component:i.b,to:{pathname:"/browse",search:"?type=image"},key:"Images"},r.a.createElement(j.E,null,r.a.createElement(x.u,null)),r.a.createElement(j.G,{primary:"Images"})),r.a.createElement(j.D,{button:!0,component:i.b,to:{pathname:"/browse",search:"?type=video"},key:"Videos"},r.a.createElement(j.E,null,r.a.createElement(x.E,null)),r.a.createElement(j.G,{primary:"Videos"})),r.a.createElement(j.D,{button:!0,component:i.b,to:{pathname:"/browse",search:"?type=audio"},key:"Music"},r.a.createElement(j.E,null,r.a.createElement(x.n,null)),r.a.createElement(j.G,{primary:"Music"}))));return r.a.createElement("nav",{className:e.drawerWrap},r.a.createElement(j.y,{mdUp:!0,implementation:"js"},r.a.createElement(j.q,{variant:"temporary",open:c,onClose:g(!1)},r.a.createElement("div",{tabIndex:0,role:"button",onClick:g(!1),onKeyDown:g(!1),className:e.drawer},f))),r.a.createElement(j.y,{smDown:!0,implementation:"js"},r.a.createElement(j.q,{variant:"persistent",open:c,onClose:g(!1)},r.a.createElement("div",{tabIndex:0,role:"button",className:e.drawer},f))))}var ie={card:{w:210,h:205},media:{w:210,h:118},content:{w:210,h:85}},le={card:{w:"100%",h:118},media:{w:210,h:118},content:{w:"100%",h:"100%"}},se=Object(l.c)(function(e){return{cardWrap:{width:ie.card.w},card:{width:ie.card.w,height:ie.card.h,display:"flex",flexDirection:"column",alignItems:"stretch"},mediaWrap:{width:ie.media.w,height:ie.media.h},media:{width:"100%",height:"100%",backgroundColor:e.secondary},content:{height:ie.content.h},cardWrapMed:{width:210},cardMed:{width:210,height:205,display:"flex",flexDirection:"column",alignItems:"stretch"},mediaWrapMed:{width:210,height:118},mediaMed:{width:210,height:118,backgroundColor:e.secondary},contentMed:{height:85},cardWrapWide:{width:le.card.w},cardWide:{width:le.card.w,height:le.card.h,display:"grid",gridTemplateColumns:"210px 1fr"},mediaWrapWide:{width:le.media.w,height:le.media.h},mediaWide:{width:"100%",height:"100%",backgroundColor:e.secondary},contentWide:{width:le.content.w},thumbnailPlaceholder:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"4em",color:e.accentAlt},contentText:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}});function ue(e){var t=se(),a=e.className,n=e.thumbnail,c=e.name,o=e.result_type,i=e.mimetype;return n?r.a.createElement(j.f,{className:a,title:c,image:n}):r.a.createElement("div",{className:a},r.a.createElement("div",{className:t.thumbnailPlaceholder},function(e){switch(e){case"users":return r.a.createElement(x.s,{fontSize:"inherit"});case"playlists":return r.a.createElement(x.E,{fontSize:"inherit"});case"favorites":return r.a.createElement(x.A,{fontSize:"inherit"});case"files":return(t=i).includes("video")?r.a.createElement(x.r,{fontSize:"inherit"}):t.includes("audio")?r.a.createElement(x.q,{fontSize:"inherit"}):t.includes("image")?r.a.createElement(x.t,{fontSize:"inherit"}):r.a.createElement(x.d,{fontSize:"inherit"});default:return}var t}(o)))}function me(e){var t=se(),a=Object(l.d)(),n=Object(ae.unstable_useMediaQuery)(a.breakpoints.down("xs"))||document.body.clientWidth<a.breakpoints.values.xs,c=e.className,o=e.variant,s=e.name,u=e.owner,m=e.id,p=e.result_type,g=e.mimetype,f=e.thumbnail,b=e.playlist_id,h=function(e,t,a){if("favorites"===e)return"/channel/".concat(t,"/playlists/favorites");var n="";return a&&(n="?playlist=".concat(a)),"".concat(function(e){switch(e){case"users":return"/channel";case"playlists":return"/playlist";case"files":default:return"/view"}}(e),"/").concat(t).concat(n)},v=null;return"small"===o||n?v=r.a.createElement(j.c,{className:d()(c,t.cardWrap)},r.a.createElement(j.d,{className:t.card,component:i.b,to:h(p,m,b)},r.a.createElement("div",{className:t.mediaWrap},r.a.createElement(ue,Object.assign({className:t.media},{name:s,result_type:p,mimetype:g,thumbnail:f}))),r.a.createElement(j.e,{className:t.content},r.a.createElement(j.W,{gutterBottom:!0,variant:"subtitle1",className:t.contentText},s),r.a.createElement(j.W,{gutterBottom:!0,variant:"subtitle2",className:t.contentText},u)))):"wide"===o&&(v=r.a.createElement(j.c,{className:d()(c,t.cardWrapWide)},r.a.createElement(j.d,{className:t.cardWide,component:i.b,to:h(p,m,b)},r.a.createElement("div",{className:t.mediaWrapWide},r.a.createElement(ue,Object.assign({className:t.mediaWide},{name:s,result_type:p,mimetype:g,thumbnail:f}))),r.a.createElement(j.e,{className:t.contentWide},r.a.createElement(j.W,{gutterBottom:!0,variant:"subtitle1",className:t.contentText},s),r.a.createElement(j.W,{variant:"subtitle2",className:t.contentText},u))))),v}var de=Object(l.c)(function(e){return{section:{display:"flex",flexDirection:"column",width:"100%",margin:"".concat(2*e.spacing.unit,"px 0")},sectionHeader:{marginBottom:4},filesGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, 210px)",gridColumnGap:e.spacing.unit,gridRowGap:e.spacing.unit},resultErrorWrap:{display:"flex",height:100,flexDirection:"column",padding:"".concat(e.spacing.unit,"px 0"),backgroundColor:e.palette.background.paper,justifyContent:"center"},resultError:{textAlign:"left",paddingLeft:e.spacing.unit}}});function pe(e){var t,a=de(),c=Object(n.useState)([]),o=Object(s.a)(c,2),i=o[0],l=o[1],u=e.filters,m=e.sorters,d=e.name,p=e.type,g=e.subscribers;return Object(n.useEffect)(function(){U.getData("files",null,u,m,0,10).then(function(e){console.log("section",e),l(e.data.response)}).catch(function(e){var t="section";e.response?console.log(t,e.response):e.request?console.log(t,e.request):console.log(t,e)})},[]),t=i.length>0?r.a.createElement("div",{className:a.filesGrid},i.map(function(e){var t=e.file_id,n=e.title,c=e.username,o=e.mimetype;return r.a.createElement(me,{key:"result-files-".concat(t),className:a.resultItem,name:n,owner:c,result_type:"files",mimetype:o,id:t,variant:"small"})})):r.a.createElement("div",{className:a.resultErrorWrap},r.a.createElement(j.W,{variant:"h6",className:a.resultError},"No results")),r.a.createElement("div",{className:a.section},r.a.createElement("div",{className:a.sectionHeader},r.a.createElement(j.W,{variant:"h5",className:a.sectionTitle},d),"channel"===p&&r.a.createElement(j.W,{variant:"body1"},"".concat(g," ").concat(1===g?"subscriber":"subscribers"))),t)}var ge=function e(t){var a={};for(var n in t)void 0!==t[n]&&"object"===typeof t[n]?a[n]=e(t[n]):a[n]=t[n];return a},fe=function(e){return function(t){t.response?console.log(e,t.response):t.request?console.log(e,t.request):console.log(e,t)}},be=Object(l.c)(function(){return{container:{display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"left"}}});function he(){var e=be(),t=Object(n.useState)([]),a=Object(s.a)(t,2),c=a[0],o=a[1];Object(n.useEffect)(function(){U.getData("users/subscribers",null,[],[{column:"subscribers",descending:"true"}]).then(function(e){o(e.data.response)}).catch(fe("home"))},[]);var i=[{column:"upload_date",value:"0001-01-01",cmp:"max"}],l=[{column:"views",descending:"true"}];return r.a.createElement("div",{className:e.container},r.a.createElement(pe,{name:"Trending",route:"files",filters:i,sorters:l}),c.map(function(e){var t=e.user_id,a=e.username,n=e.subscribers;return r.a.createElement(pe,{key:"channel-".concat(t),name:a,type:"channel",subscribers:n,filters:[].concat(i,[{column:"user_id",value:t,cmp:"exact"}]),sorters:l})}))}var ve=a(25),Ee=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column",alignItems:"center"},root:Object(p.a)({display:"block"},e.mixins.gutters(),{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit}),form:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},buttonWrapper:{margin:e.spacing.unit,position:"relative"},buttonSuccess:{backgroundColor:ve.green[500],"&:hover":{backgroundColor:ve.green[700]}},buttonProgress:{color:ve.blue[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},registerLink:{textDecoration:"none",marginTop:2*e.spacing.unit}}});function ye(e){var t=Ee(),a=new URLSearchParams(e.location.search),c=decodeURIComponent(a.get("redirect")||""),o=Q(),l=Object(s.a)(o,4),m=l[0],g=l[1],f=l[2],b=l[3],h=Object(n.useState)(!1),v=Object(s.a)(h,2),E=v[0],y=v[1],O=Object(n.useState)({username:"",password:""}),w=Object(s.a)(O,2),x=w[0],k=w[1],N=null,C=function(e){return function(t){k(Object(p.a)({},x,Object(u.a)({},e,t.currentTarget.value)))}};Object(n.useEffect)(function(){m&&y(!0)},[]),Object(n.useEffect)(function(){return b.success&&(N=setTimeout(function(){y(!0)},800)),function(){clearTimeout(N)}},[b]);var S=b.loading,_=b.success;return r.a.createElement("div",{className:t.container},r.a.createElement(j.L,{className:t.root,elevation:1},r.a.createElement(j.W,{variant:"h5"},"Login"),r.a.createElement(j.W,{variant:"body1",color:"error"},f.message),r.a.createElement("form",{className:t.form,onSubmit:function(e){e.preventDefault(),b.loading||g({type:"login",credentials:x})}},r.a.createElement(j.U,{id:"username",label:"Username",type:"text",required:!0,className:t.textField,margin:"normal",variant:"outlined",onChange:C("username"),disabled:S,autoFocus:!0}),r.a.createElement(j.U,{id:"password",label:"Password",type:"password",required:!0,className:t.textField,margin:"normal",variant:"outlined",autoComplete:"on",onChange:C("password"),disabled:S}),r.a.createElement("div",{className:t.buttonWrapper},r.a.createElement(j.b,{type:"submit",size:"large",color:"primary",className:d()(Object(u.a)({},t.buttonSuccess,_)),variant:"contained",disabled:S},"Log In"),S&&r.a.createElement(j.h,{size:24,className:t.buttonProgress}))),E&&r.a.createElement(Z.a,{to:"/".concat(c)})),r.a.createElement(j.W,{className:t.registerLink,variant:"body1",component:i.b,to:"/register".concat(""!==c?"?redirect=".concat(c):"")},"Don't have an account? Register here!"))}var Oe=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column",alignItems:"center"},root:Object(p.a)({display:"block"},e.mixins.gutters(),{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit}),form:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},buttonWrapper:{margin:e.spacing.unit,position:"relative"},buttonSuccess:{backgroundColor:ve.green[500],"&:hover":{backgroundColor:ve.green[700]}},buttonProgress:{color:ve.blue[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}});function je(e){var t=Oe(),a=new URLSearchParams(e.location.search).get("redirect")||"",c=Q(),o=Object(s.a)(c,5),i=o[0],l=o[1],m=o[2],g=o[4],f=Object(n.useState)(!1),b=Object(s.a)(f,2),h=b[0],v=b[1],E=Object(n.useState)({email:"",username:"",password:""}),y=Object(s.a)(E,2),O=y[0],w=y[1],x=null,k=function(e){return function(t){w(Object(p.a)({},O,Object(u.a)({},e,t.currentTarget.value)))}};Object(n.useEffect)(function(){i&&v(!0)},[]),Object(n.useEffect)(function(){return g.success&&(x=setTimeout(function(){v(!0)},800)),function(){clearTimeout(x)}},[g]);var N=g.loading,C=g.success;return r.a.createElement("div",{className:t.container},r.a.createElement(j.L,{className:t.root,elevation:1},r.a.createElement(j.W,{variant:"h5"},"Register"),r.a.createElement(j.W,{variant:"body1",color:"error"},m.message),r.a.createElement("form",{className:t.form,onSubmit:function(e){e.preventDefault(),g.loading||l({type:"register",credentials:O})}},r.a.createElement(j.U,{id:"email",label:"Email",type:"email",required:!0,className:t.textField,margin:"normal",variant:"outlined",onChange:k("email"),disabled:N,autoFocus:!0,error:m.emailError,helperText:m.emailErrorMsg}),r.a.createElement(j.U,{id:"username",label:"Username",type:"text",required:!0,className:t.textField,margin:"normal",variant:"outlined",onChange:k("username"),disabled:N,error:m.usernameError,helperText:m.usernameErrorMsg}),r.a.createElement(j.U,{id:"password",label:"Password",type:"password",required:!0,className:t.textField,margin:"normal",variant:"outlined",autoComplete:"on",onChange:k("password"),disabled:N,error:m.passwordError,helperText:m.passwordErrorMsg}),r.a.createElement("div",{className:t.buttonWrapper},r.a.createElement(j.b,{type:"submit",size:"large",color:"primary",className:d()(Object(u.a)({},t.buttonSuccess,C)),variant:"contained",disabled:N},"Register"),N&&r.a.createElement(j.h,{size:24,className:t.buttonProgress}))),h&&r.a.createElement(Z.a,{to:"/".concat(a)})))}var we=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"left"},results:{marginTop:e.spacing.unit},resultError:{textAlign:"center"},resultItem:{marginBottom:e.spacing.unit},optionsToggle:{},optionsTitle:{fontSize:15,fontWeight:e.typography.fontWeightRegular,marginLeft:e.spacing.unit},options:{display:"grid",gridAutoRows:"1fr",gridAutoFlow:"column"},optionGroupLabel:{marginBottom:e.spacing.unit},optionLabel:{height:"2.2em",marginRight:3*e.spacing.unit},optionRadio:{padding:"0 12px 0 0",marginLeft:12}}}),xe=function(e){switch(e){case"video":case"audio":case"image":case"all":return e;default:return""}},ke={category:"all",type:"",sort:"views",sortDsc:!0};function Ne(e){var t=we(),a=new URLSearchParams(e.location.search),c=Object(n.useState)(a.get("q")||null),o=Object(s.a)(c,2),i=o[0],l=o[1],u=Object(n.useState)([]),m=Object(s.a)(u,2),d=m[0],g=m[1],f=Object(p.a)({},ke,{type:xe(a.get("type"))}),b=Object(n.useState)(Object(p.a)({},f,{category:""!==f.type?"files":ke.category})),h=Object(s.a)(b,2),v=h[0],E=h[1],y=!1,O=function(e){var t=[];return"files"===e&&"all"!==v.type&&t.push({column:"mimetype",value:v.type,cmp:"contains"}),t},w=function(e){var t=[];if("files"===e)switch(v.sort){case"likes":t.push({column:"upvotes",descending:v.sortDsc});break;case"downloads":break;case"subscribers":t.push({column:"subscribers",descending:v.sortDsc});break;case"views":default:t.push({column:"views",descending:v.sortDsc})}return t},k=function(e,t){var a=ge(v);switch(a[e]=t,e){case"category":switch(t){case"all":case"playlists":"subscribers"===a.sort&&(a.sort=ke.sort),a.type="";break;case"files":""===a.type&&(a.type="all"),"subscribers"===a.sort&&(a.sort=ke.sort);break;case"users":a.sort="subscribers",a.type=""}break;case"type":""!==t&&(a.category="files","subscribers"===a.sort&&(a.sort=ke.sort));break;case"sort":"subscribers"===t?(a.category="users",a.type=""):"users"===a.category&&(a.category=ke.category)}E(a)},N=function(t){return function(n){var r=n.currentTarget.value;"type"===t&&(a.set("type",r),e.history.push("/browse?".concat(a.toString()))),k(t,r)}};Object(n.useEffect)(function(){var t=new URLSearchParams(e.location.search),a=t.get("q")||null,n=t.get("type")||"";i!==a&&l(a),v.type!==n&&k("type",n)},[e]);var C;return Object(n.useEffect)(function(){var e=[],t=[];return"all"===v.category?["files","playlists","users"].forEach(function(a){e.push(U.getData(a,i,O(a),w(a))),t.push(a)}):(e.push(U.getData(v.category,i,O(v.category),w(v.category))),t.push(v.category)),_.a.all(e).then(function(e){if(!y){var a=e.map(function(e,a){var n=t[a],r=e.data.response;return 0===r.length?null:(r.forEach(function(e){switch(e.resultType=n,n){case"files":e.id=e.file_id,e.display_name=e.title;break;case"users":e.id=e.user_id,e.display_name=e.username;break;case"playlists":e.id=e.playlist_id,e.display_name=e.title}}),r)});a=a.filter(function(e){return null!==e});var n=a.reduce(function(e,t){return e.concat(t)},[]);y||g(n)}}).catch(fe("browse")),function(){y=!0}},[i,v]),C=d.length>0?d.map(function(e){var a=e.resultType,n=e.id,c=e.display_name,o=e.username,i=e.mimetype;return r.a.createElement(me,{key:"result-".concat(a,"-").concat(n),className:t.resultItem,name:c,owner:o,result_type:a,mimetype:i,id:n,variant:"wide"})}):r.a.createElement(j.W,{variant:"h5",className:t.resultError},"No results"),r.a.createElement("div",{className:t.container},r.a.createElement(j.r,null,r.a.createElement(j.t,{expandIcon:null},r.a.createElement(j.b,{variant:"text"},r.a.createElement(x.D,null),r.a.createElement(j.W,{className:t.optionsTitle},"Search Options")),r.a.createElement("div",{key:"placeholder_for_icon",name:"necessary_for_styling"})),r.a.createElement(j.s,{className:t.options},r.a.createElement(j.u,{component:"fieldset"},r.a.createElement(j.w,{component:"legend",className:t.optionGroupLabel},"Category"),r.a.createElement(j.O,{name:"category",value:v.category,onChange:N("category"),"aria-label":"category"},r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"All",value:"all",className:t.optionLabel}),r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"File",value:"files",className:t.optionLabel}),r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"Playlist",value:"playlists",className:t.optionLabel}),r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"Channel",value:"users",className:t.optionLabel}))),r.a.createElement(j.u,{component:"fieldset"},r.a.createElement(j.w,{component:"legend",className:t.optionGroupLabel},"Type"),r.a.createElement(j.O,{name:"type",value:v.type,onChange:N("type"),"aria-label":"type"},r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"All",value:"all",className:t.optionLabel}),r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"Video",value:"video",className:t.optionLabel}),r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"Audio",value:"audio",className:t.optionLabel}),r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"Image",value:"image",className:t.optionLabel}))),r.a.createElement(j.u,{component:"fieldset"},r.a.createElement(j.w,{component:"legend",className:t.optionGroupLabel},"Sort"),r.a.createElement(j.O,{name:"sort",value:v.sort,onChange:N("sort"),"aria-label":"sort"},r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"Most Likes",value:"likes",className:t.optionLabel}),r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"Most Views",value:"views",className:t.optionLabel}),r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"Most Downloads",value:"downloads",className:t.optionLabel}),r.a.createElement(j.v,{control:r.a.createElement(j.N,null),label:"Most Subscribers",value:"subscribers",className:t.optionLabel})),r.a.createElement(j.v,{label:v.sortDsc?"Descending":"Ascending",className:t.optionLabel,control:r.a.createElement(j.R,{checked:v.sortDsc,onChange:function(){return E(Object(p.a)({},v,{sortDsc:!v.sortDsc}))}})})))),r.a.createElement("div",{className:t.results},C))}var Ce=Object(l.c)(function(e){return{player:{display:"flex",flexDirection:"column",alignItems:"center"},videoContainer:{width:"100%",backgroundColor:"black"},video:Object(u.a)({width:"100%",maxHeight:"80vh"},e.breakpoints.down("xs"),{maxHeight:"95vh"}),audioContainer:{width:"100%",height:"20vh",minHeight:100,backgroundColor:"black"},audio:{width:"100%"},imageContainer:{width:"100%",minHeight:100,backgroundColor:"black"},image:{width:"100%"},errorContainer:{display:"flex",width:"100%",height:"20vh",minHeight:100,flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"black"}}}),Se={show:!1,primary:"",secondary:""};function _e(e){var t=Ce(),a=Object(n.useState)(e.file_id),c=Object(s.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)(null),u=Object(s.a)(l,2),m=u[0],d=u[1],p=Object(n.useState)(Se),g=Object(s.a)(p,2),f=g[0],b=g[1],h=e.mimetype,v=void 0===h?"":h,E=e.name,y=void 0===E?"":E;Object(n.useEffect)(function(){i(e.file_id)},[e]),Object(n.useEffect)(function(){if(o)if(v.includes("video")||v.includes("audio")||v.includes("image")){var e="".concat(U.baseURL,"/files/").concat(o,"/g");d(e),f.show&&b(Se)}else b(""===v?{show:!0,primary:"Viewer unavailable",secondary:"Unknown mimetype"}:{show:!0,primary:"Viewer unavailable",secondary:"Unsupported mimetype ".concat(v)});else b({show:!0,primary:"Viewer unavailable",secondary:"File not found"})},[o]);var O=null;return f.show?O=r.a.createElement("div",{className:t.errorContainer},r.a.createElement(j.W,{variant:"h6"},f.primary),r.a.createElement(j.W,{variant:"h6"},f.secondary)):m&&(v.includes("video")?O=r.a.createElement("div",{className:t.videoContainer},r.a.createElement("video",{className:t.video,src:m,controls:!0})):v.includes("audio")?O=r.a.createElement("div",{className:t.audioContainer},r.a.createElement("audio",{className:t.audio,src:m,controls:!0})):v.includes("image")&&(O=r.a.createElement("div",{className:t.imageContainer},r.a.createElement("img",{className:t.image,src:m,alt:y})))),r.a.createElement("div",{className:t.player},O)}var We=a(235),De=Object(l.c)(function(e){return{menuWrapper:{width:260,zIndex:e.zIndex.modal+1},playlistMenu:{padding:e.spacing.unit},form:{display:"flex",flexDirection:"column"},playlistMenuTitle:{margin:"".concat(e.spacing.unit,"px 0"),paddingLeft:e.spacing.unit,paddingRight:e.spacing.unit},listItem:{height:"2.2em",paddingLeft:0},listItemBox:{padding:0,marginLeft:12},buttonWrapper:{textAlign:"right",paddingTop:e.spacing.unit},buttonProgress:{color:ve.blue[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}),Te={loading:!1,success:!1},Ie=function(e,t){switch(t){case"submit":return{loading:!0,success:!1};case"success":return{loading:!1,success:!0};case"error":case"initial":return Te;default:return e}},Re={name:"",description:"",privacy:"private"};function qe(e){var t=De(),a=Object(n.useState)([]),c=Object(s.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)(!1),m=Object(s.a)(l,2),d=m[0],g=m[1],f=Object(n.useState)(Re),b=Object(s.a)(f,2),h=b[0],v=b[1],E=Object(n.useReducer)(Ie,Te),y=Object(s.a)(E,2),O=y[0],w=y[1],k=L(),N=e.file_id;Object(n.useEffect)(function(){U.getData("playlists",null,[{column:"user_id",value:k,cmp:"exact"}],[]).then(function(e){console.log("playlistmenu get success",e),i(e.data.response)}).catch(fe("playlistmenu"))},[]),Object(n.useEffect)(function(){O.success&&(S(),U.getData("playlists",null,[{column:"user_id",value:k,cmp:"exact"}],[]).then(function(e){console.log("playlistmenu get refresh success",e),i(e.data.response)}).catch(fe("playlistmenu get error")))},[O]),Object(n.useEffect)(function(){var e=[];o.length>0&&(o.forEach(function(t){var a=t.playlist_id;e.push(U.getData("playlists/".concat(a,"/files"),null,[{column:"file_id",value:N,cmp:"exact"}]))}),_.a.all(e).then(function(e){console.log("playlistmenu get files success",e);var t=ge(h);e.forEach(function(e,a){e.data.response.length&&(t["checkbox-".concat(o[a].playlist_id)]=!0)}),v(t)}).catch(fe("playlistmenu get file added error")))},[o]);var C=function(){g(!0)},S=function(){g(!1)},W=function(e){e.preventDefault(),w("submit");var t=h.name,a=h.description;U.request("post","playlists/create",{title:t,description:a,user_id:L()},{},!0).then(function(e){console.log("playlistmenu post success",e),w("success");var t=e.data.response.playlist_id;T(t)()}).catch(function(e){fe("playlistmenu post")(e),w("error")})},D=function(e){return function(t){v(Object(p.a)({},h,Object(u.a)({},e,t.currentTarget.value)))}},T=function(e){return function(){var t="checkbox-".concat(e),a=!h[t],n=a?"link":"unlink";"favorites"===e?U.request(n,"users/".concat(k,"/favorites"),{file_id:N},{},!0).then(function(e){console.log("playlistmenu favorites ".concat(n),e),v(Object(p.a)({},h,Object(u.a)({},t,a)))}).catch(fe("playlistmenu favorites ".concat(n))):U.request(n,"playlists/".concat(e,"/file"),{file_id:N},{},!0).then(function(e){console.log("playlistmenu ".concat(n),e),v(Object(p.a)({},h,Object(u.a)({},t,a)))}).catch(fe("playlistmenu ".concat(n)))}},I=[r.a.createElement(j.D,{key:"plist-favorites",button:!0,onClick:T("favorites"),className:t.listItem},r.a.createElement(j.g,{checked:h["checkbox-favorites"]||!1,tabIndex:-1,disableRipple:!0,className:t.listItemBox}),r.a.createElement(j.G,{primary:"Favorites"}))];o.length>0&&I.push.apply(I,Object(We.a)(o.map(function(e){var a=e.playlist_id,n=e.title;return r.a.createElement(j.D,{key:"plist-result-".concat(a),button:!0,onClick:T(a),className:t.listItem},r.a.createElement(j.g,{checked:h["checkbox-".concat(a)]||!1,tabIndex:-1,disableRipple:!0,className:t.listItemBox}),r.a.createElement(j.G,{primary:n}))})));var R=O.loading,q=e.open,F=e.anchorEl,P=e.onClose,A=function(){S(),P()};return r.a.createElement(j.M,{open:q,anchorEl:F,transition:!0,className:t.menuWrapper},function(e){var a=e.TransitionProps,n=e.placement;return r.a.createElement(j.x,Object.assign({},a,{id:"menu-list-grow",style:{transformOrigin:"bottom"===n?"center top":"center bottom"}}),r.a.createElement(j.L,null,r.a.createElement(j.i,{onClickAway:A},r.a.createElement(j.C,{className:t.playlistMenu},r.a.createElement(j.W,{variant:"body1",className:t.playlistMenuTitle},"Add to..."),r.a.createElement(j.p,null),I,r.a.createElement(j.p,null),d?null:r.a.createElement(j.D,{key:"new-playlist",button:!0,onClick:C},r.a.createElement(j.E,null,r.a.createElement(x.c,null)),r.a.createElement(j.G,{primary:"Create new playlist"})),r.a.createElement(j.j,{in:d,timeout:"auto"},r.a.createElement("form",{className:t.form,onSubmit:W},r.a.createElement(j.U,{id:"name",label:"Playlist Name",type:"text",required:!0,className:t.textField,margin:"normal",variant:"outlined",onChange:D("name"),disabled:R,autoFocus:!0}),r.a.createElement(j.U,{id:"description",label:"Description",type:"text",required:!1,className:t.textField,margin:"normal",variant:"outlined",onChange:D("description"),disabled:R}),r.a.createElement(j.u,{className:t.selectInput,disabled:R},r.a.createElement(j.B,{htmlFor:"privacy"},"Privacy"),r.a.createElement(j.P,{native:!0,onChange:D("privacy")},r.a.createElement("option",{value:"private"},"Private"),r.a.createElement("option",{value:"unlisted"},"Unlisted"),r.a.createElement("option",{value:"public"},"Public"))),r.a.createElement("div",{className:t.buttonWrapper},r.a.createElement(j.b,{type:"submit",size:"large",color:"primary",variant:"text",disabled:R},"Submit"),R&&r.a.createElement(j.h,{size:24,className:t.buttonProgress}))))))))})}var Le=Object(l.c)(function(e){return{viewerPlaylist:{display:"flex",flexDirection:"column",flexGrow:1},resultItem:{marginTop:e.spacing.unit},filesList:{overflowY:"auto"}}});function Fe(e){var t=Le(),a=e.playlist_id,c=e.title,o=e.variant,i=Object(n.useState)([]),l=Object(s.a)(i,2),u=l[0],m=l[1],d=Object(n.useState)([]),p=Object(s.a)(d,2),g=p[0],f=p[1],b=!1;return Object(n.useEffect)(function(){return a&&U.getData("playlists/".concat(a,"/files")).then(function(e){console.log("viewerplaylist",e.data.response);var t=e.data.response.map(function(e){return e.file_id});b||m(t)}).catch(fe("viewerplaylist")),function(){b=!0}},[a]),Object(n.useEffect)(function(){var e=[];u.forEach(function(t){e.push(U.request("get","files/".concat(t)))}),_.a.all(e).then(function(e){if(!b){console.log("viewerplaylist get files:",e);var t=e.map(function(e){return console.log(e.data.response),e.data.response});console.log(t),f(t)}}).catch(fe("viewerplaylist get files"))},[u]),r.a.createElement("div",{className:t.viewerPlaylist},r.a.createElement(j.L,null,r.a.createElement(j.W,{variant:"h6"},c),r.a.createElement(j.p,null),r.a.createElement("div",{className:t.filesList,styles:{height:"player"===o?354:"100%"}},g.map(function(e){var n=e.file_id,c=e.title,o=e.username,i=e.mimetype;return r.a.createElement(me,{key:"file-".concat(n),className:t.resultItem,name:c,owner:o,result_type:"files",mimetype:i,id:n,playlist_id:a,variant:"wide"})}))))}var Ue=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"left"},fileInfo:{display:"flex",flexDirection:"column",alignItems:"stretch",textAlign:"left",padding:2*e.spacing.unit},header:{display:"flex",flexDirection:"row",width:"100%",alignItems:"end",justifyContent:"space-between",textAlign:"left"},details:{},extras:{display:"grid",gridAutoRows:"1fr",gridAutoFlow:"column",gridGap:2*e.spacing.unit},metrics:{},description:{textAlign:"left",marginTop:2*e.spacing.unit},rating:{marginTop:e.spacing.unit},rateIcon:{marginRight:2*e.spacing.unit},comment:{display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"left",marginTop:2*e.spacing.unit},comments:{display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"left",marginTop:2*e.spacing.unit},rightIcon:{marginLeft:e.spacing.unit},button:{margin:e.spacing.unit},grow:{flexGrow:1}}});function Pe(e){var t=Ue(),a=e.file_id,c=Object(n.useState)(!0),o=Object(s.a)(c,2),i=o[0],l=o[1],m=Q(),d=Object(s.a)(m,1)[0],g=Object(n.useState)([]),f=Object(s.a)(g,2),b=f[0],h=f[1],v={open:!1,title:"",message:""},E=Object(n.useState)(v),y=Object(s.a)(E,2),O=y[0],w=y[1],k={comment:""},S=Object(n.useState)(k),_=Object(s.a)(S,2),W=_[0],D=_[1],T=function(e){return function(t){switch(e){case"close":case"report":w(v)}}},I=!1;function R(){return(R=Object(C.a)(N.a.mark(function e(){var t,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=19;break}return W.file_id=a,W.user_id=parseInt(L()),console.log("comment uploading",W),e.prev=4,e.next=7,U.request("post","/comments/add_comment",W,{},!0);case 7:return t=e.sent,console.log("comment upload",t),n=t.data,l(!0),D(k),e.abrupt("return",n);case 15:throw e.prev=15,e.t0=e.catch(4),console.log("messages send",e.t0),e.t0;case 19:case"end":return e.stop()}},e,null,[[4,15]])}))).apply(this,arguments)}Object(n.useEffect)(function(){return i&&U.request("get","/comments/".concat(a)).then(function(e){console.log("comments: ",e.data.response),I||(l(!1),h(e.data.response))}).catch(function(e){var t="",a="";if(e.response){var n=e.response.status;a="Send report?",t=n>=500&&n<600?"Server error ".concat(n,", please contact the admins"):404===n?"Comments not found":403===n?"Comments permission blocked":"Sorry, unknown error ".concat(n)}else e.request?(a="Check connection",t="Could not connect to the server"):(a="Send report?",t="Sorry, unknown error");l(!1),console.log("view",e),I||w({title:a,message:t,open:!0})}),function(){I=!0}},[i]);var q;return r.a.createElement("div",{className:t.root},r.a.createElement(j.k,{open:O.open,TransitionComponent:function(e){return r.a.createElement(j.Q,Object.assign({direction:"down"},e))},keepMounted:!0,onClose:function(){return w(v)},"aria-labelledby":"alert-title","aria-describedby":"alert-description"},r.a.createElement(j.o,{id:"alert-title"},O.title),r.a.createElement(j.m,null,r.a.createElement(j.n,{id:"alert-description"},O.message)),r.a.createElement(j.l,null,r.a.createElement(j.b,{onClick:T("close"),color:"primary"},"Close"),r.a.createElement(j.b,{onClick:T("report"),color:"primary",variant:"contained",autoFocus:!0},"Send Report"))),r.a.createElement(j.p,null),r.a.createElement("div",{className:t.comment},r.a.createElement(j.U,{id:"standard-multiline-flexible",label:d?"Add a public comment. . .":"Please login to comment. . .",value:W.comment,onChange:(q="comment",function(e){D(Object(p.a)({},W,Object(u.a)({},q,e.target.value)))}),multiline:!0,rowsMax:"4",className:t.textField,variant:"outlined"}),r.a.createElement(j.V,null,r.a.createElement("div",{className:t.grow}),r.a.createElement(j.b,{color:"primary"},"Cancel"),r.a.createElement(j.b,{variant:"contained",color:"primary",className:t.button,onClick:function(){return R.apply(this,arguments)}},"Comment",r.a.createElement(x.y,{className:t.rightIcon},"send")))),r.a.createElement(j.p,null),1===b.length?r.a.createElement(j.W,{variant:"body1"},b.length+" comment"):r.a.createElement(j.W,{variant:"body1"},b.length+" comments"),r.a.createElement("div",{className:t.comments},r.a.createElement(j.C,null,b.map(function(e){return r.a.createElement(j.D,{key:e.comment_id},r.a.createElement(x.b,null),r.a.createElement(j.G,{primary:e.username+": "+e.comment}))}))))}var Ae=a(234),Me=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"left"},fileInfo:{display:"flex",flexDirection:"column",alignItems:"stretch",textAlign:"left",padding:2*e.spacing.unit},header:{display:"flex",flexDirection:"row",width:"100%",alignItems:"end",justifyContent:"space-between",textAlign:"left"},details:{},extras:{display:"grid",gridAutoRows:"1fr",gridAutoFlow:"column",gridGap:2*e.spacing.unit},metrics:{},description:{textAlign:"left",marginTop:2*e.spacing.unit},rating:{marginTop:e.spacing.unit},rateIcon:{marginRight:2*e.spacing.unit},rightIcon:{marginLeft:e.spacing.unit},button:{margin:e.spacing.unit},grow:{flexGrow:1},editForm:{display:"flex",flexDirection:"column"}}});function ze(e){return r.a.createElement(j.Q,Object.assign({direction:"down"},e))}var Ge={open:!1,title:"",message:""};function Be(e){var t=Me(),a=Q(),c=Object(s.a)(a,1)[0],o=new URLSearchParams(e.location.search),l=Object(n.useState)(o.get("playlist")||null),m=Object(s.a)(l,2),d=m[0],g=m[1],f=Object(n.useState)({file_id:e.match.params.id}),b=Object(s.a)(f,2),h=b[0],v=b[1],E=Object(n.useState)(Ge),y=Object(s.a)(E,2),O=y[0],w=y[1],k=Object(n.useState)(null),N=Object(s.a)(k,2),C=N[0],S=N[1],_={open:!1,loading:!1,error:{}},W=Object(n.useState)(_),D=Object(s.a)(W,2),T=D[0],I=D[1],R=Object(n.useState)({title:"",description:"",permissions:""}),q=Object(s.a)(R,2),F=q[0],P=q[1],A=!1;Object(n.useEffect)(function(){var t=new URLSearchParams(e.location.search).get("playlist")||null;t!==d&&g(t);var a=e.match.params.id;return U.request("get","/files/".concat(a)).then(function(e){if(!A){v(e.data.response);var t=e.data.response,a=t.title,n=t.description,r=t.permissions;P({title:a,description:n,permissions:r})}}).catch(function(e){var t="",n="";if(e.response){var r=e.response.status;n="Send report?",t=r>=500&&r<600?"Server error ".concat(r,", please contact the admins"):404===r?"File not found":403===r?"File permission blocked":"Sorry, unknown error ".concat(r)}else e.request?(n="Check connection",t="Could not connect to the server"):(n="Send report?",t="Sorry, unknown error");console.log("view",e),A||(w({title:n,message:t,open:!0}),v({file_id:a}))}),function(){A=!0}},[e]),Object(n.useEffect)(function(){T.loading&&U.request("patch","files/".concat(h.file_id),F,{},!0).then(function(e){A||(v(Object(p.a)({},h,e.data.response)),P(e.data.response),I(_))}).catch(function(e){var t="";if(e.response){var a=e.response.status;t=a>=500&&a<600?"Server error ".concat(a,", please contact the admins"):404===a?"File not found":401===a?"Not allowed":"Sorry, unknown error ".concat(a)}else t=e.request?"Could not connect to the server":"Sorry, unknown error";A||I({open:!0,loading:!1,error:Object(p.a)({},e,{message:t})})})},[T]);var M=function(e){return function(t){switch(e){case"close":case"report":w(Ge)}}},z=function(){I(_)},G=function(e){return function(t){P(Object(p.a)({},F,Object(u.a)({},e,t.currentTarget.value)))}},B=h.title,J=h.user_id,V=h.username,H=h.description,K=h.upload_date,Y=h.views,X=h.upvotes,$=h.downvotes,Z=h.permissions,ee=Boolean(C),te=[];return c&&(te.push(r.a.createElement(j.z,{key:"playlist-add","aria-label":"Add to Playlist",onClick:function(e){S(e.currentTarget)}},r.a.createElement(x.v,null))),L()===String(J)&&te.push(r.a.createElement(j.z,{key:"edit-file","aria-label":"Edit file",onClick:function(){I(Object(p.a)({},_,{open:!0}))}},r.a.createElement(x.j,null)))),r.a.createElement("div",{className:t.container},r.a.createElement(j.k,{open:O.open,TransitionComponent:ze,keepMounted:!0,onClose:function(){return w(Ge)},"aria-labelledby":"alert-title","aria-describedby":"alert-description"},r.a.createElement(j.o,{id:"alert-title"},O.title),r.a.createElement(j.m,null,r.a.createElement(j.n,{id:"alert-description"},O.message)),r.a.createElement(j.l,null,r.a.createElement(j.b,{onClick:M("close"),color:"primary"},"Close"),r.a.createElement(j.b,{onClick:M("report"),color:"primary",variant:"contained",autoFocus:!0},"Send Report"))),r.a.createElement(j.k,{open:T.open,TransitionComponent:ze,keepMounted:!0,onClose:z,"aria-labelledby":"edit-title"},r.a.createElement(j.o,{id:"edit-title"},"Edit File"),r.a.createElement("form",{className:t.editFormWrap,onSubmit:function(e){e.preventDefault(),T.loading||I(Object(p.a)({},T,{loading:!0}))}},r.a.createElement(j.m,{className:t.editForm},r.a.createElement(j.W,{variant:"body1",color:"error"},T.error.message),r.a.createElement(j.U,{id:"title",label:"Title",type:"text",required:!0,className:t.textField,margin:"normal",variant:"outlined",onChange:G("title"),disabled:T.loading,value:F.title||B||"",autoFocus:!0,error:T.error.titleError,helperText:T.error.titleErrorMsg}),r.a.createElement(j.U,{id:"description",label:"Description",type:"text",required:!0,className:t.textField,margin:"normal",variant:"outlined",multiline:!0,onChange:G("description"),disabled:T.loading,value:F.description||H||"",error:T.error.descriptionError,helperText:T.error.descriptionErrorMsg}),r.a.createElement(j.U,{id:"permissions",label:"Permissions",type:"text",required:!0,className:t.textField,margin:"normal",variant:"outlined",onChange:G("permissions"),disabled:T.loading,value:F.permissions||Z||"",error:T.error.permissionsError,helperText:T.error.permissionsErrorMsg})),r.a.createElement(j.l,null,r.a.createElement(j.b,{onClick:z,color:"primary"},"Cancel"),r.a.createElement(j.b,{type:"submit",color:"primary",variant:"contained",disabled:T.loading},"Save")))),r.a.createElement(_e,h),r.a.createElement(Fe,{playlist_id:d}),r.a.createElement(j.L,null,r.a.createElement("div",{className:t.fileInfo},r.a.createElement("div",{className:t.header},r.a.createElement("div",{className:t.details},r.a.createElement(j.W,{variant:"h6"},B),r.a.createElement(j.W,{variant:"body1",component:i.b,to:"/channel/".concat(J),style:{textDecoration:"none"}},V),r.a.createElement(j.W,{variant:"body1"},K)),r.a.createElement("div",{className:t.extras},r.a.createElement("div",{className:t.toolbar},te,r.a.createElement(j.z,{"aria-label":"Download",onClick:function(){Object(Ae.saveAs)("".concat(U.baseURL,"/files/").concat(h.file_id,"/g"),h.title)}},r.a.createElement(x.h,null))),r.a.createElement("div",{className:t.metrics},r.a.createElement(j.W,{variant:"body1"},"".concat("number"===typeof Y?Y:"?"," views")),r.a.createElement("div",{className:t.rating},r.a.createElement(j.W,{variant:"body1"},r.a.createElement(x.C,{className:t.rateIcon}),"".concat("number"===typeof X?X:"?")),r.a.createElement(j.W,{variant:"body1"},r.a.createElement(x.B,{className:t.rateIcon}),"".concat("number"===typeof $?$:"?")))))),r.a.createElement("div",{className:t.description},r.a.createElement(j.W,{variant:"body1"},H)),r.a.createElement(Pe,{file_id:e.match.params.id}))),r.a.createElement(qe,{file_id:h.file_id,anchorEl:C,open:ee,onClose:function(){S(null)}}))}var Je=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"row",textAlign:"left"},playlistInfo:{width:300},filesList:{flexGrow:1},extras:{display:"grid",gridAutoRows:"1fr",gridAutoFlow:"column",gridGap:2*e.spacing.unit},metrics:{},editForm:{display:"flex",flexDirection:"column"}}});function Ve(e){return r.a.createElement(j.Q,Object.assign({direction:"down"},e))}function He(e){var t=Je(),a=Q(),c=Object(s.a)(a,1)[0],o=Object(n.useState)({playlist_id:e.match.params.id}),l=Object(s.a)(o,2),m=l[0],d=l[1],g={open:!1,loading:!1,error:{}},f=Object(n.useState)(g),b=Object(s.a)(f,2),h=b[0],v=b[1],E=Object(n.useState)({title:"",description:""}),y=Object(s.a)(E,2),O=y[0],w=y[1];Object(n.useEffect)(function(){var t=e.match.params.id;U.request("get","/playlists/".concat(t)).then(function(e){d(e.data.response);var t=e.data.response,a=t.title,n=t.description;w({title:a,description:n})}).catch(fe("playlist"))},[e]),Object(n.useEffect)(function(){h.loading&&(console.log(O),U.request("patch","playlists/".concat(m.playlist_id),O,{},!0).then(function(e){d(Object(p.a)({},m,e.data.response)),w(e.data.response),v(g)}).catch(function(e){var t="";if(e.response){var a=e.response.status;t=a>=500&&a<600?"Server error ".concat(a,", please contact the admins"):404===a?"Playlist not found":401===a?"Not allowed":"Sorry, unknown error ".concat(a)}else t=e.request?"Could not connect to the server":"Sorry, unknown error";v({open:!0,loading:!1,error:Object(p.a)({},e,{message:t})})}))},[h]);var k=function(){v(g)},N=function(e){return function(t){w(Object(p.a)({},O,Object(u.a)({},e,t.currentTarget.value)))}},C=m.title,S=m.playlist_id,_=m.description,W=m.username,D=m.user_id,T=[];return c&&L()===String(D)&&T.push(r.a.createElement(j.z,{key:"edit-playlist","aria-label":"Edit playlist",onClick:function(){v(Object(p.a)({},g,{open:!0}))}},r.a.createElement(x.j,null))),r.a.createElement("div",{className:t.container},r.a.createElement("div",{className:t.playlistInfo},r.a.createElement(j.W,{variant:"h5"},C),r.a.createElement(j.W,{variant:"h6",component:i.b,to:"/channel/".concat(D),style:{textDecoration:"none"}},W),r.a.createElement("div",{className:t.extras},r.a.createElement("div",{className:t.toolbar},T)),r.a.createElement(j.W,{variant:"body1"},_)),r.a.createElement(Fe,{playlist_id:S}),r.a.createElement(j.k,{open:h.open,TransitionComponent:Ve,keepMounted:!0,onClose:k,"aria-labelledby":"edit-title"},r.a.createElement(j.o,{id:"edit-title"},"Edit Playlist"),r.a.createElement("form",{className:t.editFormWrap,onSubmit:function(e){e.preventDefault(),h.loading||v(Object(p.a)({},h,{loading:!0}))}},r.a.createElement(j.m,{className:t.editForm},r.a.createElement(j.W,{variant:"body1",color:"error"},h.error.message),r.a.createElement(j.U,{id:"title",label:"Title",type:"text",required:!0,className:t.textField,margin:"normal",variant:"outlined",onChange:N("title"),disabled:h.loading,value:O.title||C||"",autoFocus:!0,error:h.error.titleError,helperText:h.error.titleErrorMsg}),r.a.createElement(j.U,{id:"description",label:"Description",type:"text",required:!0,className:t.textField,margin:"normal",variant:"outlined",multiline:!0,onChange:N("description"),disabled:h.loading,value:O.description||_||"",error:h.error.descriptionError,helperText:h.error.descriptionErrorMsg})),r.a.createElement(j.l,null,r.a.createElement(j.b,{onClick:k,color:"primary"},"Cancel"),r.a.createElement(j.b,{type:"submit",color:"primary",variant:"contained",disabled:h.loading},"Save")))))}var Ke=Object(l.c)(function(e){return{about:{textAlign:"left"},headerWrap:{display:"flex"},headerTitle:{flexGrow:1},extras:{display:"grid",gridAutoRows:"1fr",gridAutoFlow:"column",gridGap:2*e.spacing.unit},editForm:{display:"flex",flexDirection:"column"}}});function Qe(e){var t=Ke(),a=Q(),c=Object(s.a)(a,1)[0],o=e.userID,i=Object(n.useState)(""),l=Object(s.a)(i,2),u=l[0],m=l[1],d=c&&L()===String(o),g={active:!1,loading:!1,error:{}},f=Object(n.useState)(g),b=Object(s.a)(f,2),h=b[0],v=b[1],E=Object(n.useState)(""),y=Object(s.a)(E,2),O=y[0],w=y[1];Object(n.useEffect)(function(){U.request("get","/users/".concat(o)).then(function(e){var t=e.data.response.channel_description,a=void 0===t?"":t;m(a),w(a)}).catch(fe("about"))},[e]),Object(n.useEffect)(function(){h.loading&&U.request("patch","/users/".concat(o),{channel_description:O},{},!0).then(function(e){var t=e.data.response.channel_description,a=void 0===t?"":t;m(a),w(a),v(g)}).catch(function(e){var t="";if(e.response){var a=e.response.status;t=a>=500&&a<600?"Server error ".concat(a,", please contact the admins"):404===a?"User not found":401===a?"Not allowed":"Sorry, unknown error ".concat(a)}else t=e.request?"Could not connect to the server":"Sorry, unknown error";v({active:!0,loading:!1,error:Object(p.a)({},e,{message:t})})})},[h]);var k=[];return d&&(h.active?(k.push(r.a.createElement(j.z,{key:"edit-cancel","aria-label":"Cancel",onClick:function(){v(Object(p.a)({},g))}},r.a.createElement(x.f,null))),k.push(r.a.createElement(j.z,{key:"edit-save","aria-label":"Save",onClick:function(){v(Object(p.a)({},h,{loading:!0}))}},r.a.createElement(x.e,null)))):k.push(r.a.createElement(j.z,{key:"edit-description","aria-label":"Edit Description",onClick:function(){v(Object(p.a)({},g,{active:!0}))}},r.a.createElement(x.j,null)))),r.a.createElement("div",{className:t.about},r.a.createElement("div",{className:t.headerWrap},r.a.createElement(j.W,{variant:"h6",className:t.headerTitle},"Description"),r.a.createElement("div",{className:t.extras},k)),h.active?r.a.createElement("div",{className:t.editForm},r.a.createElement(j.W,{variant:"body1",color:"error"},h.error.message),r.a.createElement(j.U,{id:"description",label:"Description",type:"text",required:!0,className:t.textField,margin:"normal",multiline:!0,onChange:function(e){w(e.currentTarget.value)},disabled:h.loading,value:O||"",autoFocus:!0})):r.a.createElement(j.W,{variant:"body1"},u||"No description"))}var Ye=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column"},header:{},sectionTitle:{marginBottom:4},itemsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, 210px)",gridColumnGap:e.spacing.unit,gridRowGap:e.spacing.unit},resultItem:{marginBottom:e.spacing.unit}}});function Xe(e){var t=Ye(),a=Object(n.useState)([]),c=Object(s.a)(a,2),o=c[0],i=c[1],l=e.userID,u=!1;return Object(n.useEffect)(function(){return U.getData("playlists",null,[{column:"user_id",value:l,cmp:"exact"}]).then(function(e){console.log("playlists get",e),u||i(e.data.response)}).catch(fe("playlists get")),function(){u=!0}},[]),r.a.createElement("div",{className:t.container},r.a.createElement("div",{className:t.header}),r.a.createElement(j.p,null),r.a.createElement(j.W,{variant:"h5",className:t.sectionTitle},"Created Playlists"),r.a.createElement("div",{className:t.itemsGrid},r.a.createElement(me,{key:"playlist-favorites",className:t.resultItem,name:"Favorites",result_type:"favorites",id:l,variant:"small"}),o.map(function(e){var a=e.playlist_id,n=e.title,c=e.username;return r.a.createElement(me,{key:"playlist-".concat(a),className:t.resultItem,name:n,owner:c,result_type:"playlists",id:a,variant:"small"})})))}var $e=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column",textAlign:"left"},header:{},optionsTitle:{fontSize:15,fontWeight:e.typography.fontWeightRegular,marginLeft:e.spacing.unit},sectionTitle:{marginBottom:4},itemsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, 210px)",gridColumnGap:e.spacing.unit,gridRowGap:e.spacing.unit},resultItem:{marginBottom:e.spacing.unit}}});function Ze(e){var t=$e(),a=Object(n.useState)([]),c=Object(s.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)(null),u=Object(s.a)(l,2),m=u[0],d=u[1],p=e.userID,g=!1;Object(n.useEffect)(function(){return U.request("get","users/".concat(p,"/favorites"),{},{},!0).then(function(e){g||i(e.data.response)}).catch(fe("files get")),function(){g=!0}},[]);var f=function(e){d(null)},b=function(e){return function(t){var a={column:e,descending:!0};U.getData("files",null,[{column:"user_id",value:p,cmp:"exact"}],[a]).then(function(e){g||i(e.data.response)}).catch(fe("files get")),f()}},h=Boolean(m),v=r.a.createElement(j.I,{anchorEl:m,open:h,onClose:f},r.a.createElement(j.J,{key:"views",onClick:b("views")},"Most Views"),r.a.createElement(j.J,{key:"likes",onClick:b("upvotes")},"Most Likes"));return r.a.createElement("div",{className:t.container},r.a.createElement("div",{className:t.header},r.a.createElement(j.b,{variant:"text",onClick:function(e){d(e.target)}},r.a.createElement(x.z,null),r.a.createElement(j.W,{className:t.optionsTitle},"Sort"))),r.a.createElement(j.p,null),r.a.createElement(j.W,{variant:"h5",className:t.sectionTitle},"Favorites"),r.a.createElement("div",{className:t.itemsGrid},o.length>0?o.map(function(e){var a=e.file_id,n=e.title,c=e.mimetype,o=e.username;return r.a.createElement(me,{key:"file-".concat(a),className:t.resultItem,name:n,owner:o,result_type:"files",mimetype:c,id:a,variant:"small"})}):r.a.createElement(j.W,{variant:"h6"},"No Favorites")),v)}var et=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column",textAlign:"left"},header:{},optionsTitle:{fontSize:15,fontWeight:e.typography.fontWeightRegular,marginLeft:e.spacing.unit},sectionTitle:{marginBottom:4},itemsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, 210px)",gridColumnGap:e.spacing.unit,gridRowGap:e.spacing.unit},resultItem:{marginBottom:e.spacing.unit}}});function tt(e){var t=et(),a=Object(n.useState)([]),c=Object(s.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)("upload_date"),u=Object(s.a)(l,2),m=u[0],d=u[1],p=Object(n.useState)(null),g=Object(s.a)(p,2),f=g[0],b=g[1],h=e.userID,v=!1;Object(n.useEffect)(function(){var e={column:m,descending:!0};return U.getData("files",null,[{column:"user_id",value:h,cmp:"exact"}],[e]).then(function(e){v||i(e.data.response)}).catch(fe("files get")),function(){v=!0}},[m]);var E=function(e){b(null)},y=function(e){return function(t){d(e),E()}},O=Boolean(f),w=r.a.createElement(j.I,{anchorEl:f,open:O,onClose:E},r.a.createElement(j.J,{key:"upload_date",onClick:y("upload_date")},"Most Recent"),r.a.createElement(j.J,{key:"views",onClick:y("views")},"Most Views"),r.a.createElement(j.J,{key:"likes",onClick:y("upvotes")},"Most Likes"));return r.a.createElement("div",{className:t.container},r.a.createElement("div",{className:t.header},r.a.createElement(j.b,{variant:"text",onClick:function(e){b(e.target)}},r.a.createElement(x.z,null),r.a.createElement(j.W,{className:t.optionsTitle},"Sort"))),r.a.createElement(j.p,null),r.a.createElement(j.W,{variant:"h5",className:t.sectionTitle},"Uploaded Files"),r.a.createElement("div",{className:t.itemsGrid},o.length>0?o.map(function(e){var a=e.file_id,n=e.title,c=e.mimetype,o=e.username;return r.a.createElement(me,{key:"file-".concat(a),className:t.resultItem,name:n,owner:o,result_type:"files",mimetype:c,id:a,variant:"small"})}):r.a.createElement(j.W,{variant:"h6"},"No Files")),w)}var at=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column",textAlign:"left"},header:{display:"flex",justifyContent:"space-between"},grow:{flexGrow:1},optionsTitle:{fontSize:15,fontWeight:e.typography.fontWeightRegular,marginLeft:e.spacing.unit},sectionTitle:{marginBottom:4},inputRoot:{color:"inherit"},inputInput:{padding:e.spacing.unit,paddingRight:0},itemsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, 210px)",gridColumnGap:e.spacing.unit,gridRowGap:e.spacing.unit,paddingTop:e.spacing.unit},resultItem:{marginBottom:e.spacing.unit}}});function nt(e){var t=at(),a=Object(n.useState)([]),c=Object(s.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)(null),u=Object(s.a)(l,2),m=u[0],d=u[1],p=Object(n.useState)(""),g=Object(s.a)(p,2),f=g[0],b=g[1],h=e.userID,v=Q(),E=Object(s.a)(v,1)[0]&&h===L(),y=null,O=!1,w=function(){U.getData("users/".concat(h,"/contacts"),f).then(function(e){console.log("contacts get",e),O||i(e.data.response)}).catch(function(e){fe("contacts get")(e)})};Object(n.useEffect)(function(){return E&&(clearTimeout(y),y=setTimeout(w,800)),function(){O=!0}},[f]);var k=function(e){d(null)},N=function(e){return function(t){var a={column:e,descending:!0};U.getData("users/".concat(h,"/contacts"),f,null,[a]).then(function(e){console.log("contacts get",e),O||i(e.data.response)}).catch(fe("contacts get")),k()}},C=Boolean(m),S=r.a.createElement(j.I,{anchorEl:m,open:C,onClose:k},r.a.createElement(j.J,{key:"name",onClick:N("username")},"Username"),r.a.createElement(j.J,{key:"subscribers",onClick:N("subscribed")},"Most Subscribers"));return r.a.createElement("div",{className:t.container},E?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.header},r.a.createElement(j.W,{variant:"h5",className:t.sectionTitle},"Contacts"),r.a.createElement("div",{className:t.grow}),r.a.createElement(j.A,{placeholder:"Search...",classes:{root:t.inputRoot,input:t.inputInput},value:f,onChange:function(e){b(e.currentTarget.value)},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),clearTimeout(y),w())}}),r.a.createElement(j.b,{variant:"text",onClick:function(e){d(e.target)}},r.a.createElement(x.z,null),r.a.createElement(j.W,{className:t.optionsTitle},"Sort"))),r.a.createElement(j.p,null),r.a.createElement("div",{className:t.itemsGrid},0!==o.length?o.map(function(e){var a=e.contacted_id,n=e.username;return console.log(e),r.a.createElement(me,{key:"user-".concat(a),className:t.resultItem,name:n,owner:n,result_type:"users",id:a,variant:"small"})}):r.a.createElement(j.W,{variant:"h6"},"No Contacts")),S):r.a.createElement(j.W,{variant:"h6"},"Private Content"))}function rt(){return r.a.createElement("div",null,r.a.createElement(j.W,{variant:"h4"},"404 - Page Not Found"))}var ct=Object(l.c)(function(e){return{tabbedpage:{flexGrow:1,backgroundColor:e.palette.background.paper},grow:{flexGrow:1}}});function ot(e){return r.a.createElement(j.W,{component:"div",style:{padding:24}},e.children)}var it=function(e){var t=e.split("/");return 3===t.length?"about":t[3]};function lt(e){var t=ct(),a=Object(n.useState)(it(e.location.pathname)),c=Object(s.a)(a,2),o=c[0],l=c[1],u=Object(n.useState)(e.match.params.id),m=Object(s.a)(u,2),d=m[0],g=m[1],f=Object(n.useState)({}),b=Object(s.a)(f,2),h=b[0],v=b[1],E=Object(n.useState)(null),y=Object(s.a)(E,2),O=y[0],w=y[1],k=Q(),S=Object(s.a)(k,1)[0],W=Object(n.useState)(""),D=Object(s.a)(W,2),T=D[0],I=D[1],q=Object(n.useState)(""),F=Object(s.a)(q,2),P=F[0],A=F[1],M=Object(n.useState)(),z=Object(s.a)(M,2),G=z[0],B=z[1],J=Object(n.useState)(),V=Object(s.a)(J,2),H=V[0],K=V[1],Y=Boolean(O),X=!1,$=e.match.url;Object(n.useEffect)(function(){var t=e.match.params.id;g(t)},[e]);var ee=function(e,t,a){e[t]=a,e.labels.push(t),e.list.push(a)};Object(n.useEffect)(function(){var t={list:[],labels:[]};return ee(t,"userInfo",U.getData("users/".concat(d))),ee(t,"subscribers",U.getData("users/".concat(d,"/subscribers"))),_.a.all(t.list).then(function(e){if(!X){console.log("channel get",e);for(var a={},n=0;n<e.length;++n){var r=e[n],c=t.labels[n];"userInfo"===c?a=Object(p.a)({},a,r.data.response):"subscribers"===c&&(a=Object(p.a)({},a,{subscribers:r.data.response.subscribers}))}v(a)}}).catch(function(t){if(!X){var a="";if(t.response){var n=t.response.status;404===n?e.history.push("/userNotFound"):a=n>=500&&n<600?"Server error ".concat(n,", please contact the admins"):"Sorry, unknown error ".concat(n)}else a=t.request?t.message:"Sorry, unknown error";console.log("channel",a)}}),function(){X=!0}},[d,H]),Object(n.useEffect)(function(){return S&&U.request("get","/users/".concat(L(),"/contacts")).then(function(e){X||(-1===function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a].username);return t}(e.data.response).indexOf(te)?(B(!1),I("Add contact.")):(B(!0),I("Remove contact.")))}).catch(function(e){var t="";if(e.response){console.log(e.response);var a=e.response.status;t=a>=500&&a<600?"Server error ".concat(a,", please contact the admins"):404===a?"Contacts not found":403===a?"Contacts permission blocked":"Sorry, unknown error ".concat(a)}else e.request?(console.log(e.request),t="Could not connect to the server"):(console.log(e),t="Sorry, unknown error");console.log(t,e)}),function(){X=!0}},[Y]),Object(n.useEffect)(function(){return S&&U.request("get","/users/".concat(L(),"/subscribers_info")).then(function(e){X||(-1===function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a].username);return t}(e.data.response).indexOf(te)?(K(!1),A("Subscribe.")):(K(!0),A("Unsubscribe.")))}).catch(function(e){var t="";if(e.response){console.log(e.response);var a=e.response.status;t=a>=500&&a<600?"Server error ".concat(a,", please contact the admins"):404===a?"Subscribers not found":403===a?"Subscribers permission blocked":"Sorry, unknown error ".concat(a)}else e.request?(console.log(e.request),t="Could not connect to the server"):(console.log(e),t="Sorry, unknown error");console.log(t,e)}),function(){X=!0}},[Y]);var te=h.username,ae=h.subscribers,ne=function(){w(null)};function re(){G?function(){le.apply(this,arguments)}():function(){oe.apply(this,arguments)}(),B(!G),ne()}function ce(){H?function(){se.apply(this,arguments)}():function(){ie.apply(this,arguments)}(),K(!H),ne()}function oe(){return(oe=Object(C.a)(N.a.mark(function e(){var t,a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={contacting_id:L(),contacted_id:d},console.log("adding contact",t,R()),e.prev=2,e.next=5,U.request("link","/users/add_contact",t,{},!0);case 5:return a=e.sent,console.log("contact add",a),n=a.data,e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(2),console.log("contact add",e.t0),e.t0;case 15:case"end":return e.stop()}},e,null,[[2,11]])}))).apply(this,arguments)}function ie(){return(ie=Object(C.a)(N.a.mark(function e(){var t,a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={subscribing_id:L(),subscribed_id:d},console.log("adding subscriber",t,R()),e.prev=2,e.next=5,U.request("link","/users/subscribe",t,{},!0);case 5:return a=e.sent,console.log("subscriber",a),n=a.data,e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(2),console.log("subscriber",e.t0),e.t0;case 15:case"end":return e.stop()}},e,null,[[2,11]])}))).apply(this,arguments)}function le(){return(le=Object(C.a)(N.a.mark(function e(){var t,a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={contact_removing_id:L(),contact_removed_id:d},console.log("removing contact",t,R()),e.prev=2,e.next=5,U.request("unlink","/users/remove_contact",t,{},!0);case 5:return a=e.sent,console.log("remove contact",a),n=a.data,e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(2),console.log("remove contact",e.t0),e.t0;case 15:case"end":return e.stop()}},e,null,[[2,11]])}))).apply(this,arguments)}function se(){return(se=Object(C.a)(N.a.mark(function e(){var t,a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={unsubscribing_id:L(),unsubscribed_id:d},console.log("removing subscriber",t,R()),e.prev=2,e.next=5,U.request("unlink","/users/unsubscribe",t,{},!0);case 5:return a=e.sent,console.log("remove subscriber",a),n=a.data,e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(2),console.log("remove subscriber",e.t0),e.t0;case 15:case"end":return e.stop()}},e,null,[[2,11]])}))).apply(this,arguments)}var ue=r.a.createElement(j.I,{anchorEl:O,open:Y,onClose:ne},S?[r.a.createElement(j.J,{key:"toggleContact",onClick:function(){return re()}},T),r.a.createElement(j.J,{key:"toggleSubscribe",onClick:function(){return ce()}},P)]:r.a.createElement(j.J,{component:i.b,to:"/login"},r.a.createElement(j.G,{inset:!0,primary:"Please login to contact."}),r.a.createElement(j.E,null,r.a.createElement(x.b,null))));return r.a.createElement("div",null,r.a.createElement("div",{className:t.header},r.a.createElement(j.W,{variant:"h5"},te),1===ae?r.a.createElement(j.W,{variant:"body1"},ae," subscriber"):r.a.createElement(j.W,{variant:"body1"},ae," subscribers")),r.a.createElement("div",{className:t.tabbedpage},r.a.createElement(j.a,{position:"static"},r.a.createElement(j.V,null,r.a.createElement(j.T,{value:o,onChange:function(t,a){l(a),e.history.push("".concat($,"/").concat(a))}},r.a.createElement(j.S,{label:"About",value:"about"}),r.a.createElement(j.S,{label:"Files",value:"files"}),r.a.createElement(j.S,{label:"Playlists",value:"playlists"}),r.a.createElement(j.S,{label:"Contacts",value:"contacts"})),r.a.createElement("div",{className:t.grow}),r.a.createElement(j.z,{color:"inherit","aria-haspopup":"true",onClick:function(e){d!==L()&&w(e.currentTarget)}},r.a.createElement(x.a,null)))),r.a.createElement(ot,null,r.a.createElement(Z.d,null,r.a.createElement(Z.b,{path:"".concat(e.match.path,"/"),exact:!0,render:function(){return r.a.createElement(Qe,{userID:d})}}),r.a.createElement(Z.b,{path:"".concat(e.match.path,"/about"),render:function(){return r.a.createElement(Qe,{userID:d})}}),r.a.createElement(Z.b,{path:"".concat(e.match.path,"/files"),render:function(){return r.a.createElement(tt,{userID:d})}}),r.a.createElement(Z.b,{path:"".concat(e.match.path,"/playlists/favorites"),render:function(){return r.a.createElement(Ze,{userID:d})}}),r.a.createElement(Z.b,{path:"".concat(e.match.path,"/playlists"),render:function(){return r.a.createElement(Xe,{userID:d})}}),r.a.createElement(Z.b,{path:"".concat(e.match.path,"/contacts"),render:function(){return r.a.createElement(nt,{userID:d})}}),r.a.createElement(Z.b,{component:rt})))),ue)}var st=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column",alignItems:"center"},formWrapper:{minWidth:"80%"},form:Object(u.a)({display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:2*e.spacing.unit,padding:2*e.spacing.unit},e.breakpoints.down("xs"),{display:"grid",gridTemplateColumns:"1fr",gridTemplateRows:"1fr 1fr"}),fileUploadWrapper:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",backgroundColor:e.background,color:e.primary,border:"4px dashed ".concat(e.primary),"&:hover":{backgroundColor:e.secondary,color:e.background,border:"4px dashed ".concat(e.accent)}},fileUploadChildren:{pointerEvents:"none"},fileDragOver:{backgroundColor:e.secondary,color:e.background,border:"4px dashed ".concat(e.accent)},fileUploadIcon:{fontSize:"5em"},fileUpload:{visibility:"hidden"},formTextFields:{display:"flex",flexDirection:"column"},errorMessage:{textTransform:"capitalize"},buttonWrapper:{margin:e.spacing.unit,position:"relative"},buttonSuccess:{backgroundColor:ve.green[500],"&:hover":{backgroundColor:ve.green[700]}},buttonProgress:{color:ve.blue[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}),ut={loading:!1,success:!1},mt=function(e,t){switch(t){case"submit":return{loading:!0,success:!1};case"success":return{loading:!1,success:!0};case"error":case"initial":return ut;default:return e}};function dt(e){var t=st(),a=Q(),c=Object(s.a)(a,1)[0],o=Object(n.useState)(null),i=Object(s.a)(o,2),l=i[0],m=i[1],g=Object(n.useState)(!1),f=Object(s.a)(g,2),b=f[0],h=f[1],v=Object(n.useReducer)(mt,ut),E=Object(s.a)(v,2),y=E[0],O=E[1],w=Object(n.useState)(null),k=Object(s.a)(w,2),N=k[0],C=k[1],S=Object(n.useState)({file_type:"",user_id:"",title:"",description:"",keywords:"",categories:""}),_=Object(s.a)(S,2),W=_[0],D=_[1],T=null,I=!1,R=function(e){if(console.log("got file",e),e){m(e);var t=e.name,a=t.slice(0,t.lastIndexOf(".")),n=W.title;D(Object(p.a)({},W,{file_type:e.type,title:n||a})),document.getElementById("title").select()}},q=function(e){return function(t){D(Object(p.a)({},W,Object(u.a)({},e,t.currentTarget.value)))}};Object(n.useEffect)(function(){return c||e.history.push("/login?redirect=upload"),function(){I=!0}},[c]),Object(n.useEffect)(function(){if(console.log("useeffect"),y.success)T=setTimeout(function(){e.history.push("/channel/".concat(L(),"/files"))},800);else if(y.loading){console.log("is loading");var t=new FormData;for(var a in t.append("user_id",L()),t.append("file",l),W)t.append(a,W[a]);console.log(t),U.request("post","files/upload",t,{},!0).then(function(e){I||O("success")}).catch(function(e){var t="";if(e.response){var a=e.response.status;t=a>=500&&a<600?"Server error ".concat(a,", please contact the admins"):400===a?e.response.data.error:401===a?"You must be logged in":"Sorry, unknown error ".concat(a)}else t=e.request?"Could not connect to the server":"Sorry, unknown error";I||(C(t),O("error"))})}return function(){clearTimeout(T)}},[y]);var F=y.loading,P=y.success;return r.a.createElement("div",{className:t.container},r.a.createElement(j.L,{className:t.formWrapper},r.a.createElement("form",{className:t.form,onSubmit:function(e){console.log("onsubmit",y),e.preventDefault(),y.loading||O("submit")}},r.a.createElement("label",{className:d()(t.fileUploadWrapper,Object(u.a)({},t.fileDragOver,b)),onDrop:function(e){if(e.preventDefault(),e.stopPropagation(),h(!1),e.dataTransfer.items){var t=e.dataTransfer.items[0];"file"===t.kind&&(console.log("items drag"),document.getElementById("fileUpload").files=e.dataTransfer.files,R(t.getAsFile()))}else e.dataTransfer.files&&(console.log("files drag"),document.getElementById("fileUpload").files=e.dataTransfer.files,R(e.dataTransfer.files[0]))},onDragOver:function(e){e.preventDefault(),e.stopPropagation()},onDragEnter:function(e){e.preventDefault(),e.stopPropagation(),h(!0)},onDragLeave:function(e){e.preventDefault(),e.stopPropagation(),h(!1)}},l?r.a.createElement("div",{className:t.fileUploadChildren},r.a.createElement(x.g,{className:t.fileUploadIcon,fontSize:"inherit"}),r.a.createElement(j.W,{variant:"h5",color:"inherit"},"File Ready"),r.a.createElement(j.W,{variant:"body1",color:"inherit"},l.name)):r.a.createElement("div",{className:t.fileUploadChildren},r.a.createElement(x.i,{className:t.fileUploadIcon,fontSize:"inherit"}),r.a.createElement(j.W,{variant:"h5",color:"inherit"},"Upload File")),r.a.createElement("input",{id:"fileUpload",type:"file",className:t.fileUpload,accept:"image/*,video/*,audio/*",onChange:function(e){R(e.currentTarget.files[0])},required:!0})),r.a.createElement("div",{className:t.formTextFields},r.a.createElement(j.W,{className:t.errorMessage,variant:"body1",color:"error"},N),r.a.createElement(j.U,{id:"title",label:"Title",type:"text",required:!0,className:t.textField,margin:"normal",variant:"outlined",value:W.title,onChange:q("title"),disabled:F,autoFocus:!0}),r.a.createElement(j.U,{id:"description",label:"Description",type:"text",className:t.textField,margin:"normal",variant:"outlined",value:W.description,onChange:q("description"),disabled:F}),r.a.createElement(j.U,{id:"keywords",label:"Keywords",type:"text",className:t.textField,margin:"normal",variant:"outlined",value:W.keywords,onChange:q("keywords"),disabled:F}),r.a.createElement(j.U,{id:"categories",label:"Categories",type:"text",className:t.textField,margin:"normal",variant:"outlined",value:W.categories,onChange:q("categories"),disabled:F}),r.a.createElement("div",{className:t.buttonWrapper},r.a.createElement(j.b,{type:"submit",size:"large",color:"primary",className:d()(Object(u.a)({},t.buttonSuccess,P)),variant:"contained",disabled:F||!l},"Upload"),F&&r.a.createElement(j.h,{size:24,className:t.buttonProgress}))))))}var pt=Object(l.c)(function(e){return{container:{display:"flex",flexDirection:"column",alignItems:"center"},root:Object(p.a)({display:"flex",flexDirection:"column"},e.mixins.gutters(),{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit}),form:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},buttons:{display:"flex"},buttonWrapper:{display:"flex",alignItems:"center",margin:e.spacing.unit,position:"relative"},buttonSuccess:{backgroundColor:ve.green[500],"&:hover":{backgroundColor:ve.green[700]}},buttonProgress:{color:ve.blue[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},cancelLink:{textDecoration:"none",marginTop:2*e.spacing.unit},etcOptsHeading:{},deleteButton:{backgroundColor:ve.red[700],"&:hover":{backgroundColor:ve.red[900]}}}}),gt={edit:!1,editsuccess:!1,authsuccess:!1,warn:!1,deleteloading:!1,deletesuccess:!1},ft=function(e,t){switch(t){case"submit":return Object(p.a)({},gt,{edit:!0});case"editsuccess":return Object(p.a)({},gt,{editsuccess:!0});case"authsuccess":return Object(p.a)({},gt,{authsuccess:!0});case"deletebutton":return Object(p.a)({},gt,{warn:!0});case"deleteconfirm":return Object(p.a)({},gt,{deleteloading:!0});case"deletesuccess":return Object(p.a)({},gt,{deletesuccess:!0});case"deletecancel":case"error":case"initial":return gt;default:return e}};function bt(e){var t=pt(),a=Q(),c=Object(s.a)(a,2),o=c[0],i=c[1],l=L(),m=Object(n.useReducer)(ft,gt),g=Object(s.a)(m,2),f=g[0],b=g[1],h=Object(n.useState)(""),v=Object(s.a)(h,2),E=v[0],y=v[1],O=Object(n.useState)({}),w=Object(s.a)(O,2),k=w[0],S=w[1],_=Object(n.useState)(!1),W=Object(s.a)(_,2),D=W[0],T=W[1],I=Object(n.useState)(!1),R=Object(s.a)(I,2),q=R[0],F=R[1],A=!1,M=function(e){return function(t){S(Object(p.a)({},k,Object(u.a)({},e,t.currentTarget.value)))}};Object(n.useEffect)(function(){return o||f.deletesuccess||e.history.push("/login?redirect=options"),function(){A=!0}},[o]);var z=function(){var e=Object(C.a)(N.a.mark(function e(){var t,a,n,r,c;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=k.username,a=k.password,e.next=4,P({username:t,password:a});case 4:(n=e.sent).error?(b("error"),y(n.error)):(b("authsuccess"),y("")),e.next=16;break;case 8:if(e.prev=8,e.t0=e.catch(0),A){e.next=12;break}return e.abrupt("return");case 12:r="",e.t0.response?(c=e.t0.response.status,r=401===c?"Invalid login":c>=500&&c<600?"Server error ".concat(c,", please contact the admins"):"Sorry, unknown error ".concat(c)):r=e.t0.request?e.t0.message:"Sorry, unknown error",b("error"),y(r);case 16:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){var e=f.edit,t=f.editsuccess,a=f.authsuccess,n=f.warn,r=f.deleteloading,c=f.deletesuccess;if(e){var o=k.oldUsername,s=k.oldPassword,u=k.username,m=k.password,d=k.email;U.request("patch","/users/".concat(l),{password:m,username:u,email:d},{auth:{username:o,password:s}}).then(function(e){console.log("patch",e,A),A||b("editsuccess")}).catch(function(e){if(!A){var t="";if(e.response){var a=e.response.status;t=401===a?"Invalid login":a>=500&&a<600?"Server error ".concat(a,", please contact the admins"):"Sorry, unknown error ".concat(a)}else t=e.request?e.message:"Sorry, unknown error";y(t),b("error")}})}else t?z():a||(n?T(!0):r?U.request("delete","/users/".concat(l),{},{},!0).then(function(e){A||b("deletesuccess")}).catch(function(e){if(!A){var t="";if(e.response){var a=e.response.status;t=401===a?"Invalid login":a>=500&&a<600?"Server error ".concat(a,", please contact the admins"):"Sorry, unknown error ".concat(a)}else t=e.request?e.message:"Sorry, unknown error";y(t),b("error")}}):c&&(console.log("deletesuccess"),T(!1),i({type:"logout"}),F(!0)))},[f]);var G=f.edit,B=f.authsuccess,J=f.deleteloading||G;return r.a.createElement("div",{className:t.container},r.a.createElement(j.L,{className:t.root,elevation:1},r.a.createElement(j.W,{variant:"h5"},"Options"),r.a.createElement(j.W,{variant:"body1",color:"error"},E),r.a.createElement("form",{className:t.form,onSubmit:function(e){e.preventDefault();var t=k.username,a=k.password,n=k.email;""===t&&""===a&&""===n?y("Nothing to change"):f.loading||b("submit")}},r.a.createElement(j.U,{id:"oldUsername",label:"Current Username",type:"text",required:!0,className:t.textField,margin:"normal",variant:"outlined",onChange:M("oldUsername"),disabled:J,autoFocus:!0}),r.a.createElement(j.U,{id:"oldPassword",label:"Current Password",type:"password",required:!0,className:t.textField,margin:"normal",variant:"outlined",autoComplete:"on",onChange:M("oldPassword"),disabled:J}),r.a.createElement(j.U,{id:"password",label:"New Password",type:"password",className:t.textField,margin:"normal",variant:"outlined",autoComplete:"on",onChange:M("password"),disabled:J}),r.a.createElement(j.U,{id:"username",label:"New Username",type:"text",className:t.textField,margin:"normal",variant:"outlined",onChange:M("username"),disabled:J}),r.a.createElement(j.U,{id:"email",label:"New Email",type:"text",className:t.textField,margin:"normal",variant:"outlined",autoComplete:"on",onChange:M("email"),disabled:J}),r.a.createElement("div",{className:t.buttons},r.a.createElement("div",{className:t.buttonWrapper},r.a.createElement(j.b,{type:"button",size:"medium",color:"primary",variant:"text",onClick:function(){return e.history.push("/channel/".concat(l))},disabled:J},"Cancel")),r.a.createElement("div",{className:t.buttonWrapper},r.a.createElement(j.b,{type:"submit",size:"large",color:"primary",className:d()(Object(u.a)({},t.buttonSuccess,B)),variant:"contained",disabled:J},"Save"),J&&r.a.createElement(j.h,{size:24,className:t.buttonProgress})))),r.a.createElement(j.r,null,r.a.createElement(j.t,{expandIcon:r.a.createElement(x.k,null)},r.a.createElement(j.W,{className:t.etcOptsHeading},"More Options")),r.a.createElement(j.s,null,r.a.createElement("div",{className:t.buttonWrapper},r.a.createElement(j.b,{type:"button",size:"large",className:t.deleteButton,variant:"contained",onClick:function(e){b("deletebutton")},disabled:J},"Delete Account"))))),r.a.createElement(j.k,{open:D,onClose:function(){return T(!1)},"aria-labelledby":"deleteconfirm-dialog-title","aria-describedby":"deleteconfirm-dialog-desc"},r.a.createElement(j.o,{id:"deleteconfirm-dialog-title"},"Confirm Delete Account"),r.a.createElement(j.m,null,r.a.createElement(j.n,{id:"deleteconfirm-dialog-description"},"Are you sure you want to delete your account?")),r.a.createElement(j.l,null,r.a.createElement(j.b,{onClick:function(){return T(!1)},color:"primary",autoFocus:!0},"Cancel"),r.a.createElement(j.b,{onClick:function(e){b("deleteconfirm")},className:t.deleteButton},"Delete"))),r.a.createElement(j.k,{open:q,onClose:function(){return e.history.push("/")},"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-desc"},r.a.createElement(j.o,{id:"delete-dialog-title"},"Account Deleted"),r.a.createElement(j.m,null,r.a.createElement(j.n,{id:"delete-dialog-description"},"Your account has been deleted.")),r.a.createElement(j.l,null,r.a.createElement(j.b,{onClick:function(){return e.history.push("/")},color:"primary",autoFocus:!0},"Back to home"))))}var ht=Object(l.c)(function(e){var t;return{layoutRoot:{display:"block",backgroundColor:e.background,height:"100%",width:"100%",overflow:"auto"},content:(t={display:"flex",flexDirection:"column",transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),textAlign:"center",marginTop:56,padding:3*e.spacing.unit},Object(u.a)(t,e.breakpoints.up(0)+" and (orientation: landscape)",{marginTop:48}),Object(u.a)(t,e.breakpoints.up("md"),{marginTop:64}),t),contentShift:Object(u.a)({},e.breakpoints.up("md"),{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:e.drawerWidth})}}),vt=Object(n.createContext)(null);function Et(e){var t=e.children,a=ht(),c=Object(l.d)(),o=Object(n.useReducer)(function(e,t){switch(t){case!0:case!1:return t;case"toggle":return!e;default:return e}},!(document.body.clientWidth<c.breakpoints.values.md)),i=Object(s.a)(o,2),m=i[0],p=i[1];return r.a.createElement("div",{className:a.layoutRoot},r.a.createElement(vt.Provider,{value:[m,p]},r.a.createElement(te,null),r.a.createElement(oe,null)),r.a.createElement("main",{className:d()(a.content,Object(u.a)({},a.contentShift,m))},t,r.a.createElement(Z.d,null,r.a.createElement(Z.b,{path:"/",exact:!0,component:he}),r.a.createElement(Z.b,{path:"/login",component:ye}),r.a.createElement(Z.b,{path:"/register",component:je}),r.a.createElement(Z.b,{path:"/browse",component:Ne}),r.a.createElement(Z.b,{path:"/upload",component:dt}),r.a.createElement(Z.b,{path:"/view/:id",component:Be}),r.a.createElement(Z.b,{path:"/playlist/:id",component:He}),r.a.createElement(Z.b,{path:"/channel/:id",component:lt}),r.a.createElement(Z.b,{path:"/options",component:bt}),r.a.createElement(Z.b,{component:rt}))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(i.a,{basename:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_ROOT_DIR},r.a.createElement(function(){return r.a.createElement(O,{initialTheme:"dark"},r.a.createElement(Y,null,r.a.createElement(Et,null)))},null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[5468,1,2]]]);
//# sourceMappingURL=main.a26d998b.chunk.js.map