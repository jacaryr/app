{"version":3,"sources":["patch.js","theming.js","authutils.js","apiclient.js","authentication.js","components/messages.js","components/masthead.js","components/sidebar.js","components/resultItemCard.js","components/section.js","utils.js","pages/home.js","pages/login.js","pages/register.js","pages/browse.js","components/player.js","components/playlistmenu.js","components/viewerplaylist.js","components/comments.js","pages/view.js","pages/playlist.js","pages/about.js","pages/channelplaylists.js","pages/channelfavorites.js","pages/channelfiles.js","pages/channelcontacts.js","pages/pageNotFound.js","pages/channel.js","pages/upload.js","pages/options.js","pages/layout.js","serviceWorker.js","index.js","App.js"],"names":["install","baseTheme","drawerWidth","themes","light","primary","secondary","error","background","accent","accentAlt","dark","getThemePalette","themeName","palette","main","default","getTheme","themeMode","createMuiTheme","Object","objectSpread","type","undefined","typography","useNextVariants","ThemeMode","createContext","useThemeMode","useContext","Theming","_ref","children","initialTheme","_useReducer","useReducer","state","action","_useReducer2","slicedToArray","themeModeDispatch","react_default","a","createElement","index_es","theme","Provider","value","getAccessToken","Cookies","get","isAuthenticated","getAuthenticatedUserID","getAuthenticatedUsername","apiclient","Api","server_ip","arguments","length","process","REACT_APP_SERVER_IP","secure","timeout","REACT_APP_SERVER_TIMEOUT","headers","classCallCheck","this","baseURL","concat","client","axios","create","_this","URN","data","config","request","auth","username","params","url","method","route","query","filters","sorters","start","limit","useAuth","extras","authenticate","asyncToGenerator","regenerator_default","mark","_callee","creds","response","res","tokens","expires_in","expiration","wrap","_context","prev","next","sent","expires_in_secs","Date","getTime","set","token","expires","user_id","abrupt","t0","stop","_x","apply","register","_ref2","_callee2","_context2","_x2","unauthenticate","remove","initialRegState","loading","success","regStateReducer","initialAuthState","authStateReducer","initialAuthAction","credentials","authActionReducer","AuthCtx","useAuthCtx","Authenticator","_ref3","regState","regStateDispatch","_useReducer3","_useReducer4","authState","authStateDispatch","_useReducer5","_useReducer6","authAction","authActionDispatch","_useState","useState","_useState2","isLoggedIn","setIsLoggedIn","_useState3","_useState4","errorState","setErrorState","doAction","_ref4","_callee3","msg","status","_msg","_status","_context3","message","t1","forEach","tag","console","log","t2","useEffect","useStyles","makeStyles","root","display","paper","marginRight","spacing","unit","rightIcon","marginLeft","button","margin","formControl","minWidth","Messages","props","classes","openMessagesMenu","setOpenMessagesMenu","openMessageDialog","setOpenMessageDialog","anchorEl","useRef","_useAuthCtx","_useState5","_useState6","contacts","setContacts","_useState7","Map","_useState8","contactNameIDs","setContactNameIDs","_useState9","_useState10","menuConversations","setMenuConversations","_useState11","_useState12","dialogConversations","setDialogConversations","_useState13","_useState14","currentDialog","setCurrentDialog","_useState15","_useState16","newMessage","setNewMessage","_useState17","id","name","labelWidth","_useState18","dialogContactInfo","setDialogContactInfo","prop","cancel","_sendMessage","contacting_id","parseInt","contacted_id","handleCloseMessageDialog","handleMessagesMenuClose","event","current","contains","target","requests","reqRoute","push","all","then","responses","i","contactsInfo","newContacts","newContactNameIDs","getContacts","messageInfo","newMenuConversations","newMenuConversationsMap","newDialogConversationsMap","newestMessageIndex","latestMessageIndex","contact_username","j","delete","toString","has","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","key","err","return","reverse","getConversations","catch","className","core_index_es","buttonRef","aria-owns","aria-haspopup","onClick","icons_index_es","open","placement","transition","disablePortal","TransitionProps","assign","style","transformOrigin","onClickAway","subheader","component","map","menuConversation","Fragment","handleMessageDialogOpenOld","Link","to","inset","onClose","aria-labelledby","onChange","defineProperty","renderValue","contact","dialogConversation","message_id","textAlign","label","multiline","rowsMax","textField","variant","color","masthead","appBar","breakpoints","up","zIndex","drawer","grow","flexGrow","menuButton","titleWrap","width","down","title","textDecoration","search","alignItems","position","borderRadius","shape","backgroundColor","fade","common","white","&:hover","maxWidth","searchIconWrap","height","justifyContent","searchIcon","padding","inputRoot","inputInput","paddingRight","transitions","&:focus","withRouter","_useThemeMode","_useThemeMode2","setThemeMode","_useContext","DrawerOpenDispatch","setDrawerState","menuAnchor","setMenuAnchor","_useAuthCtx2","URLSearchParams","location","searchQuery","setSearchQuery","closeMenu","handleMenu","e","history","_props$location","curPath","pathname","curParams","curParamsArr","keys","hasOthers","newParams","slice","others","encodeURIComponent","newParamsStr","submitSearch","isMenuOpen","Boolean","miscMenuItems","checked","aria-label","profileMenuItems","menu","noWrap","placeholder","input","currentTarget","onKeyPress","preventDefault","drawerWrap","flexShrink","overflowX","list","header","minHeight","paddingLeft","Sidebar","_useContext2","isOpen","useTheme","isMobileWidth","useMediaQuery","document","body","clientWidth","values","md","setTimeout","toggleDrawer","navList","Menu_default","mdUp","implementation","tabIndex","role","onKeyDown","smDown","dimensions","card","w","h","media","content","cardWrap","flexDirection","mediaWrap","cardWrapMed","cardMed","mediaWrapMed","mediaMed","contentMed","cardWrapWide","cardWide","gridTemplateColumns","mediaWrapWide","mediaWide","contentWide","thumbnailPlaceholder","fontSize","contentText","whiteSpace","overflow","textOverflow","ResultItemThumbnail","propClass","thumbnail","result_type","mimetype","image","mime","includes","getIconPlaceholder","ResultItemCard","xs","owner","playlist_id","getRoute","resultType","playlistID","getRouteFromResultType","classNames","gutterBottom","section","sectionHeader","marginBottom","filesGrid","gridColumnGap","gridRowGap","resultErrorWrap","resultError","Section","contents","files","setFiles","subscribers","getData","result","file_id","resultItem","sectionTitle","deepCopyObject","obj","cpy","basicRequestCatch","container","HomePage","topChannels","setTopChannels","column","descending","trendingFilts","cmp","trendingSorts","user","mixins","gutters","paddingTop","paddingBottom","form","buttonWrapper","buttonSuccess","green","buttonProgress","blue","top","left","marginTop","registerLink","LoginPage","redirectPath","decodeURIComponent","redirect","setRedirect","password","inputs","setInputs","timer","handleChange","clearTimeout","elevation","onSubmit","required","disabled","autoFocus","autoComplete","size","react_router","RegisterPage","email","emailError","helperText","emailErrorMsg","usernameError","usernameErrorMsg","passwordError","passwordErrorMsg","results","optionsToggle","optionsTitle","fontWeight","fontWeightRegular","options","gridAutoRows","gridAutoFlow","optionGroupLabel","optionLabel","optionRadio","getSearchType","s","initialInputs","category","sort","sortDsc","BrowsePage","setQuery","setResults","initialInputsWithType","cancelSearch","makeFilters","queryFilters","makeSorters","querySorters","updateInputs","newInputs","handleInputs","newQuery","newType","reqTypes","cat","reqResults","resType","item","filter","rankedResults","reduce","acc","val","display_name","expandIcon","control","player","videoContainer","video","maxHeight","audioContainer","audio","imageContainer","errorContainer","initialErrorState","show","Player","fileID","setFileID","blobURL","setBlobURL","errorMessage","setErrorMessage","_props$mimetype","_props$name","reqURL","viewer","src","controls","alt","menuWrapper","modal","playlistMenu","playlistMenuTitle","listItem","listItemBox","initialCreatePlaylistState","createPlaylistReducer","description","privacy","PlaylistMenu","playlists","setPlaylists","formOpen","setFormOpen","createPlaylistState","setCreatePlaylistState","userID","closeForm","playlist","openForm","submitForm","onClickPlaylist","isAdd","plistItems","disableRipple","toConsumableArray","in","selectInput","htmlFor","native","viewerPlaylist","filesList","overflowY","ViewerPlaylist","list_title","fileIDs","setFileIDs","newFileIDs","p_f_item","styles","file","fileInfo","details","gridGap","metrics","rating","rateIcon","comment","comments","Comments","fileId","commentsChanged","setCommentsChanged","setComments","initialAlertState","alertState","setAlertState","initialCommentState","newComment","setNewComment","handleDialogButton","_sendComment","TransitionComponent","direction","keepMounted","aria-describedby","comment_id","editForm","SlideTransition","ViewPage","setPlaylistID","match","setFileInfo","plistMenuAnchor","setPlistMenuAnchor","initialEditState","editState","setEditState","permissions","editInputs","setEditInputs","newPlaylistID","_res$data$response","closeEditDialog","handleEditChange","upload_date","views","upvotes","downvotes","isPlistMenuOpen","String","editFormWrap","toolbar","saveAs","playlistInfo","PlaylistPage","setPlaylistInfo","about","headerWrap","headerTitle","AboutPage","setDescription","canEdit","active","newDescription","setNewDescription","_res$data$response$ch","channel_description","_res$data$response$ch2","itemsGrid","ChannelPlaylistsPage","setPlaylistsInfo","ChannelFavoritesPage","setFilesInfo","sortMenuAnchor","setSortMenuAnchor","closeSortMenu","handleSortMenu","sorter","isSortMenuOpen","sortMenu","ChannelFilesPage","sortKey","setSortKey","ChannelContactsPage","setContactsInfo","canView","searchTimer","doSearch","contactInfo","Error404Page","tabbedpage","TabContainer","getTabFromPath","path","pieces","split","UserPage","setTabIndex","setUserID","userInfo","setUserInfo","contactMenuAnchor","setContactMenuAnchor","contactPrompt","setContactPrompt","subscribePrompt","setSubscriberPrompt","isContact","setIsContact","isSubscriber","setIsSubscriber","isContactMenuOpen","addRequest","reqMap","labels","indexOf","subscribersInfo","newSubscribers","getSubscribers","closeContactMenu","toggleIsContact","_removeContact","removeContact","_addContact","addContact","toggleIsSubscriber","_unsubscribe","unsubscribe","_subscribe","subscribe","newContact","newSubscriber","subscribing_id","subscribed_id","oldContact","contact_removing_id","contact_removed_id","_callee4","oldSubscriber","_context4","unsubscribing_id","unsubscribed_id","contactMenu","newValue","exact","render","formWrapper","gridTemplateRows","fileUploadWrapper","cursor","border","fileUploadChildren","pointerEvents","fileDragOver","fileUploadIcon","fileUpload","visibility","formTextFields","textTransform","initialReqState","reqStateReducer","UploadPage","setFile","dragOver","setDragOver","reqState","reqStateDispatch","file_type","keywords","categories","handleFile","newFile","filename","basename","lastIndexOf","getElementById","select","FormData","append","onDrop","stopPropagation","dataTransfer","items","kind","getAsFile","onDragOver","onDragEnter","onDragLeave","accept","buttons","cancelLink","etcOptsHeading","deleteButton","red","edit","editsuccess","authsuccess","warn","deleteloading","deletesuccess","OptionsPage","deleteDialogOpen","setDeleteDialogOpen","deleteSuccessDialogOpen","setDeleteSuccessDialogOpen","try_auth","oldUsername","oldPassword","_content","layoutRoot","easing","easeOut","duration","enteringScreen","contentShift","Layout","drawerOpen","drawerOpenDispatch","window","hostname","ReactDOM","react_router_dom","REACT_APP_ROOT_DIR","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.a26d998b.chunk.js","sourcesContent":["\nimport { install } from '@material-ui/styles';\n\ninstall();\n","import React, { createContext, useContext, useReducer } from 'react';\nimport { ThemeProvider } from '@material-ui/styles';\nimport { createMuiTheme } from '@material-ui/core/styles';\n\nconst baseTheme = {\n  drawerWidth: 240\n};\n\nconst lightTheme = {\n  primary:    '#C4C3C4',\n  secondary:  '#656774',\n  error:      '#AA2121',\n  background: '#F4F3F4',\n  accent:     '#000',\n  accentAlt:  '#fff'\n};\n\nconst darkTheme = {\n  primary:    '#949C9B',\n  secondary:  '#A1A4AD',\n  error:      '#ff4181',\n  background: '#241C2B',\n  accent:     '#fff',\n  accentAlt:  '#000'\n};\n\nconst themes = {\n  'light': lightTheme,\n  'dark': darkTheme\n};\n\nlet getThemePalette = (themeName) => {\n  const palette = themes[themeName];\n  if (!palette) return {};\n  return {\n    primary: {\n      main: palette.primary\n    },\n    secondary: {\n      main: palette.secondary\n    },\n    error: {\n      main: palette.error\n    },\n    background: {\n      default: palette.background\n    }\n  };\n};\n\nexport let getTheme = (themeName,themeMode) => {\n  return createMuiTheme({\n    palette: {\n      type: themeMode !== undefined ? themeMode : themeName,\n      ...getThemePalette(themeName)\n    },\n    typography: {\n      useNextVariants: true\n    },\n    ...baseTheme,\n    ...themes[themeName]\n  });\n};\n\nexport const ThemeMode = createContext(null);\n\nexport const useThemeMode = () => useContext(ThemeMode);\n\nexport default function Theming({children, initialTheme}) {\n  const themeModeReducer = (state, action) => {\n    switch (action) {\n      case 'light':\n      case 'dark':\n        return action;\n      case 'toggle':\n        return state === 'light' ? 'dark' : 'light';\n      default:\n        return state;\n    }\n  };\n  const [themeMode, themeModeDispatch] = useReducer(themeModeReducer, initialTheme);\n  return (\n    <ThemeProvider theme={getTheme(themeMode)}>\n      <ThemeMode.Provider value={[themeMode, themeModeDispatch]}>\n        {children}\n      </ThemeMode.Provider>\n    </ThemeProvider>\n  );\n}\n","import Cookies from 'js-cookie';\n\nexport const getAccessToken = () => {\n  return Cookies.get('access_token');\n};\n\nexport const isAuthenticated = () => {\n  return getAccessToken() !== undefined;\n};\n\nexport const getAuthenticatedUserID = () => {\n  return Cookies.get('user_id');\n};\n\nexport const getAuthenticatedUsername = () => {\n  return Cookies.get('username');\n};\n","import axios from 'axios';\nimport { getAccessToken } from './authutils';\n\n// export const ApiClient = axios.create({\n//   baseURL: 'http://'+process.env.REACT_APP_SERVER_IP,\n//   timeout: 10000,\n//   headers: {}\n// });\n\nclass Api {\n  constructor(\n      server_ip = process.env.REACT_APP_SERVER_IP,\n      secure = false,\n      timeout = process.env.REACT_APP_SERVER_TIMEOUT || 10000,\n      headers = {}\n    ) {\n    let schema = secure ? 'https://' : 'http://';\n    let baseURL = `${schema}${server_ip}`;\n    this.baseURL = baseURL;\n    this.client = axios.create({\n      baseURL,\n      timeout,\n      headers\n    });\n  }\n\n  makeRequester(type) {\n    return (URN, data, config) => this.request(type, URN, data, config);\n  }\n\n  request(type, URN, data = {}, config = {}, useAuth = false) {\n    if(useAuth) {\n      let auth = {username: getAccessToken()};\n      config['auth'] = auth;\n    }\n    switch(type) {\n      case 'request':\n      case 'getUri':\n        return this.client[type](config);\n      case 'get':\n      case 'delete':\n      case 'head':\n      case 'options':\n        return this.client[type](URN,{...config, params: data});\n      case 'post':\n      case 'put':\n      case 'patch':\n        return this.client[type](URN,data,config);\n      default:\n        return this.client.request({\n          url: URN,\n          method: type,\n          params: data,\n          data: data,\n          ...config\n        });\n    }\n    /*let source = axios.CancelToken.source();\n    let token = source.token;\n    let cancel = source.cancel;\n    const reqCfg = {\n      cancelToken: token,\n      ...config\n    };\n    return {\n      request: this.client[type](URN, {filters, data}, reqCfg),\n      token,\n      cancel\n    };*/\n  }\n\n  async getData(route, query=null, filters=[], sorters=[], start=0, limit=10, useAuth = false) {\n    let extras = `b=${start}&l=${limit}`;\n    if(query !== null) extras += `&q=${query}`;\n    return this.request('get',`/${route}?${extras}`, {filters, sorters}, {}, useAuth);\n  }\n}\n\nexport default (new Api());\n","import React, { createContext, useContext, useReducer, useState, useEffect } from 'react';\nimport Api from './apiclient';\nimport Cookies from 'js-cookie';\nimport {\n  isAuthenticated\n} from './authutils';\n\nconst ONE_HOUR_IN_MS = 60 * 60 * 1000;\n\nexport const authenticate = async (creds) => {\n  try {\n    const response = await Api.request('post','/login',creds);\n    const res = response.data;\n    const tokens = res.response;\n    const expires_in = tokens.expires_in_secs * 1000 - ONE_HOUR_IN_MS;\n    const expiration = new Date(new Date().getTime() + expires_in);\n\n    Cookies.set('access_token', tokens.token, {expires: expiration});\n    Cookies.set('user_id', res.response.user_id, {expires: expiration});\n    Cookies.set('username', res.response.username, {expires: expiration});\n    return res;\n  }\n  catch(err) {\n    throw err;\n  }\n};\n\nexport const register = async (creds) => {\n  try {\n    const response = await Api.request('post','/users',creds);\n    const res = response.data;\n    const tokens = res.response;\n    const expires_in = tokens.expires_in_secs * 1000 - ONE_HOUR_IN_MS;\n    const expiration = new Date(new Date().getTime() + expires_in);\n\n    Cookies.set('access_token', tokens.token, {expires: expiration});\n    Cookies.set('user_id', res.response.user_id, {expires: expiration});\n    Cookies.set('username', res.response.username, {expires: expiration});\n    return res;\n  }\n  catch(err) {\n    throw err;\n  }\n};\n\nexport const unauthenticate = () => {\n  Cookies.remove('access_token');\n};\n\nconst initialRegState = {\n  loading: false,\n  success: false\n};\nconst regStateReducer = (state, action) => {\n  switch(action) {\n    case 'submit':\n      return {\n        loading: true,\n        success: false\n      }\n    case 'success':\n      return {\n        loading: false,\n        success: true\n      }\n    case 'error':\n    case 'initial':\n      return initialRegState;\n    default:\n      return state;\n  }\n};\nconst initialAuthState = {\n  loading: false,\n  success: false\n};\nconst authStateReducer = (state, action) => {\n  switch (action) {\n    case 'loading':\n      return {\n        loading: true,\n        success: false\n      };\n    case 'success':\n      return {\n        loading: false,\n        success: true\n      };\n    case 'error':\n    case 'initial':\n      return initialAuthState;\n    default:\n      return state;\n  }\n};\nconst initialAuthAction = {\n  action: null,\n  credentials: null\n};\nconst authActionReducer = (state, action) => {\n  switch (action.type) {\n    case 'register':\n    case 'login':\n      return {\n        action: action.type,\n        credentials: action.credentials\n      };\n    case 'logout':\n      return {\n        action: action.type\n      };\n    default:\n      return state;\n  }\n};\n\nexport const AuthCtx = createContext(null);\n\nexport const useAuthCtx = () => useContext(AuthCtx);\n\nexport default function Authenticator({children}) {\n  const [regState, regStateDispatch] = useReducer(regStateReducer,initialRegState);\n  const [authState, authStateDispatch] = useReducer(authStateReducer,initialAuthState);\n  const [authAction, authActionDispatch] = useReducer(authActionReducer,initialAuthAction);\n  const [isLoggedIn, setIsLoggedIn] = useState(isAuthenticated());\n  const [errorState, setErrorState] = useState({});\n\n  let doAction = async () => {\n    let response;\n    switch(authAction.action) {\n      case 'register':\n        regStateDispatch('loading');\n        try {\n          response = await register(authAction.credentials);\n          if(response.error) {\n            regStateDispatch('error');\n            setErrorState({message:response.error});\n          }\n          else {\n            regStateDispatch('success');\n            setErrorState({});\n            setIsLoggedIn(true);\n          }\n        }\n        catch(err) {\n          let msg = '';\n          // got response from server\n          if(err.response) {\n            const { status } = err.response;\n            if (status === 400) {\n              let {error} = err.response.data;\n              if(error['not unique']) {\n                error['not unique'].forEach((tag) => {\n                  err[tag+'Error'] = true;\n                  err[tag+'ErrorMsg'] = 'Must be unique';\n                });\n              }\n              else msg = err.error;\n            }\n            else if (status >= 500 && status < 600) {\n              msg = `Server error ${status}, please contact the admins`;\n            }\n            else {\n              msg = `Sorry, unknown error ${status}`;\n            }\n          }\n          // request sent but no response\n          else if(err.request) {\n            msg = err.message;\n          }\n          // catch all\n          else {\n            msg = 'Sorry, unknown error';\n          }\n          console.log('auth',err);\n          regStateDispatch('error');\n          setErrorState({...err,message:msg});\n        }\n        break;\n      case 'login':\n        authStateDispatch('loading');\n        try {\n          response = await authenticate(authAction.credentials);\n          if(response.error) {\n            authStateDispatch('error');\n            setErrorState({message:response.error});\n          }\n          else {\n            authStateDispatch('success');\n            setErrorState({});\n            setIsLoggedIn(true);\n          }\n        }\n        catch(err) {\n          let msg = '';\n          // got response from server\n          if(err.response) {\n            const { status } = err.response;\n            if(status === 401) {\n              msg = 'Invalid login';\n            }\n            else if (status >= 500 && status < 600) {\n              msg = `Server error ${status}, please contact the admins`;\n            }\n            else {\n              msg = `Sorry, unknown error ${status}`;\n            }\n          }\n          // request sent but no response\n          else if(err.request) {\n            msg = err.message;\n          }\n          // catch all\n          else {\n            msg = 'Sorry, unknown error';\n          }\n          console.log('auth',err);\n          authStateDispatch('error');\n          setErrorState({...err,message:msg});\n        }\n        break;\n      case 'logout':\n        console.log('auth logging out');\n        unauthenticate();\n        authStateDispatch('initial');\n        regStateDispatch('initial');\n        setIsLoggedIn(false);\n        break;\n      default:\n        break;\n    }\n  }\n\n  useEffect(() => {\n    doAction();\n  }, [authAction]);\n\n  return (\n    <AuthCtx.Provider value={[isLoggedIn, authActionDispatch, errorState, authState, regState]}>\n      {children}\n    </AuthCtx.Provider>\n  )\n}\n","import React, {useState, useEffect, useRef} from 'react';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport {\r\n  ClickAwayListener,\r\n  Grow,\r\n  Paper,\r\n  Popper,\r\n  MenuItem,\r\n  MenuList,\r\n  List,\r\n  ListItem,\r\n  FormControl,\r\n  ListItemSecondaryAction,\r\n  IconButton,\r\n  ListSubheader,\r\n  ListItemText,\r\n  ListItemIcon,\r\n  Button,\r\n  TextField,\r\n  Dialog,\r\n  DialogActions,\r\n  InputLabel,\r\n  DialogContent,\r\n  Divider,\r\n  Select\r\n} from '@material-ui/core';\r\nimport {\r\n  Reply,\r\n  Forum,\r\n  AccountCircle,\r\n  Send,\r\n  Message\r\n} from '@material-ui/icons';\r\nimport {\r\n  Link\r\n} from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport Api from '../apiclient';\r\nimport {useAuthCtx} from '../authentication';\r\nimport {getAuthenticatedUsername, getAuthenticatedUserID, getAccessToken} from '../authutils';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    display: 'flex'\r\n  },\r\n  paper: {\r\n    marginRight: theme.spacing.unit * 2,\r\n  },\r\n  rightIcon: {\r\n    marginLeft: theme.spacing.unit,\r\n  },\r\n  button: {\r\n    margin: theme.spacing.unit,\r\n  },\r\n  formControl: {\r\n    margin: theme.spacing.unit,\r\n    minWidth: 160,\r\n  }\r\n}));\r\n\r\nexport default function Messages(props) {\r\n  const classes = useStyles();\r\n  const [openMessagesMenu, setOpenMessagesMenu] = useState(false);\r\n  const [openMessageDialog, setOpenMessageDialog] = useState(false);\r\n  const anchorEl = useRef(null);\r\n  const [isLoggedIn] = useAuthCtx();\r\n  let [contacts, setContacts] = useState([]);\r\n  let [contactNameIDs, setContactNameIDs] = useState(new Map());\r\n  let [menuConversations, setMenuConversations] = useState([]);\r\n  let [dialogConversations, setDialogConversations] = useState(new Map());\r\n  let [currentDialog, setCurrentDialog] = useState([]);\r\n  const [newMessage, setNewMessage] = useState({\r\n    message: '',\r\n  })\r\n  const [dialogContactInfo, setDialogContactInfo] = useState({\r\n    id: '',\r\n    name: '',\r\n    labelWidth: 0,\r\n  });\r\n\r\n  const handleChange = prop => event => {\r\n    setNewMessage({ ...newMessage, [prop]: event.target.value });\r\n  };\r\n\r\n  function getConversations(messageInfo){\r\n    let newMenuConversations = [];\r\n    var newMenuConversationsMap = new Map();\r\n    var newDialogConversationsMap = new Map();\r\n    let newestMessageIndex = messageInfo.length - 1;\r\n    let latestMessageIndex = 1;\r\n    if(messageInfo.length===0){\r\n      setDialogConversations(new Map());\r\n      return [];\r\n    }\r\n    if(messageInfo[0].contact_username !== getAuthenticatedUsername()){\r\n      newestMessageIndex--;\r\n      latestMessageIndex--;\r\n    }\r\n    for(let j = latestMessageIndex; j <= newestMessageIndex; j+=2){\r\n      //if(contactNameIDs.get(messageInfo[j].contact_username) !== undefined) {\r\n        if(messageInfo[j].contacted_id === parseInt(getAuthenticatedUserID())){\r\n          newMenuConversationsMap.delete(messageInfo[j].contact_username);\r\n          if(messageInfo[j].contact_username !== getAuthenticatedUsername()){\r\n            newMenuConversationsMap.set(messageInfo[j].contact_username, [messageInfo[j].message, messageInfo[j].contacting_id.toString()]);\r\n          }\r\n          else if(messageInfo[j].contact_username === getAuthenticatedUsername() && j%2===0){\r\n            newMenuConversationsMap.set(messageInfo[j+1].contact_username, [messageInfo[j].message, messageInfo[j].contacting_id.toString()]);\r\n          }\r\n          else {\r\n            newMenuConversationsMap.set(messageInfo[j-1].contact_username, [messageInfo[j].message, messageInfo[j].contacting_id.toString()]);\r\n          }\r\n        }\r\n        else {\r\n          newMenuConversationsMap.delete(messageInfo[j].contact_username);\r\n          if(messageInfo[j].contact_username !== getAuthenticatedUsername()){\r\n            newMenuConversationsMap.set(messageInfo[j].contact_username, [messageInfo[j].message, messageInfo[j].contacted_id.toString()]);\r\n          }\r\n          else if(messageInfo[j].contact_username === getAuthenticatedUsername() && j%2===0){\r\n            newMenuConversationsMap.set(messageInfo[j+1].contact_username, [messageInfo[j].message, messageInfo[j].contacted_id.toString()]);\r\n          }\r\n          else {\r\n            newMenuConversationsMap.set(messageInfo[j-1].contact_username, [messageInfo[j].message, messageInfo[j].contacted_id.toString()]);\r\n          }\r\n        }\r\n      //}\r\n    }\r\n    for(let i = newestMessageIndex; i >= latestMessageIndex; i-=2){\r\n      //if(contactNameIDs.get(messageInfo[i].contact_username) !== undefined) {\r\n        if(newDialogConversationsMap.has(messageInfo[i].contact_username)){\r\n          newDialogConversationsMap.set(messageInfo[i].contact_username, newDialogConversationsMap.get(messageInfo[i].contact_username).concat([messageInfo[i]]));\r\n        }\r\n        else {\r\n          newDialogConversationsMap.set(messageInfo[i].contact_username, [messageInfo[i]]);\r\n        }\r\n      //}\r\n    }\r\n    setDialogConversations(newDialogConversationsMap);\r\n    for (var [key, value] of newMenuConversationsMap) {\r\n      newMenuConversations.push([key, value]);\r\n    }\r\n    return newMenuConversations.reverse();\r\n  }\r\n\r\n  function getContacts(contactsInfo){\r\n    let newContacts = [];\r\n    let newContactNameIDs = new Map();\r\n    for(let i=0; i<contactsInfo.length; i++){\r\n      if(contactsInfo[i].contacting_id === parseInt(getAuthenticatedUserID())){\r\n        newContactNameIDs.set(contactsInfo[i].username, contactsInfo[i].contacted_id)\r\n      }\r\n      else {\r\n        newContactNameIDs.set(contactsInfo[i].username, contactsInfo[i].contacting_id)\r\n      }\r\n      newContacts.push(contactsInfo[i].username);\r\n    }\r\n    setContactNameIDs(newContactNameIDs);\r\n    return newContacts;\r\n  }\r\n\r\n  let cancel = false;\r\n\r\n\r\n  useEffect(() => {\r\n    if(openMessagesMenu && isLoggedIn){\r\n      let requests = [];\r\n      let reqRoute = [];\r\n      requests.push(Api.request('get',`/users/${getAuthenticatedUserID()}/contacts`));\r\n      reqRoute.push('contacts');\r\n      requests.push(Api.request('get',`/messages/${getAuthenticatedUserID()}`));\r\n      reqRoute.push('messages');\r\n      axios.all(requests)\r\n        .then(responses => {\r\n          if(cancel) return;\r\n          responses.forEach((res,i) => {\r\n            let route = reqRoute[i];\r\n            if(route === 'contacts') {\r\n              console.log('contacts: ',res.data.response);\r\n              setContacts(getContacts(res.data.response));\r\n            }\r\n            else if(route === 'messages') {\r\n              console.log('messages: ',res.data.response);\r\n              setMenuConversations(getConversations(res.data.response));\r\n            }\r\n          })\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n          if(cancel) return;\r\n          let msg = '';\r\n          // got response from server\r\n          if(err.response) {\r\n            console.log(err.response);\r\n            const { status } = err.response;\r\n            if (status >= 500 && status < 600) {\r\n              msg = `Server error ${status}, please contact the admins`;\r\n            }\r\n            else if (status === 404) {\r\n              msg = \"Messages not found\";\r\n            }\r\n            else if (status === 403) {\r\n              msg = \"Messages permission blocked\";\r\n            }\r\n            else {\r\n              msg = `Sorry, unknown error ${status}`;\r\n            }\r\n          }\r\n          // request sent but no response\r\n          else if(err.request) {\r\n            console.log(err.request);\r\n            msg = 'Could not connect to the server';\r\n          }\r\n          // catch all\r\n          else {\r\n            console.log(err);\r\n            msg = 'Sorry, unknown error';\r\n          }\r\n          console.log(msg, err);\r\n          //TODO: set error status message in global app status or in the messages panel\r\n        });\r\n\r\n      }\r\n\r\n      return () => {\r\n        cancel = true;\r\n      }\r\n  }, [openMessagesMenu]);\r\n\r\n  function toggleMessagesMenu() {\r\n    setOpenMessagesMenu(!openMessagesMenu);\r\n  }\r\n\r\n  async function sendMessage() {\r\n    newMessage.contacting_id = parseInt(getAuthenticatedUserID());\r\n    newMessage.contacted_id = contactNameIDs.get(dialogContactInfo.name);\r\n    console.log('messages sending',newMessage,getAccessToken());\r\n    try {\r\n      const response = await Api.request('post','/messages/upload',newMessage,{},true);\r\n      console.log('messages send',response);\r\n      const res = response.data;\r\n      handleCloseMessageDialog();\r\n      return res;\r\n    }\r\n    catch(err) {\r\n      console.log('messages send',err);\r\n      throw err;\r\n    }\r\n  }\r\n\r\n  function handleMessagesMenuClose(event) {\r\n    if (anchorEl.current.contains(event.target)) {\r\n      return;\r\n    }\r\n    setOpenMessagesMenu(false);\r\n  }\r\n\r\n  function handleMessageDialogOpenOld(menuConversation) {\r\n    setOpenMessageDialog(true);\r\n    setCurrentDialog(dialogConversations.get(menuConversation[0]).reverse());\r\n    setDialogContactInfo({\r\n      id: menuConversation[1][1],\r\n      name: menuConversation[0],\r\n      labelWidth: 0,\r\n    })\r\n  }\r\n\r\n  function handleMessageDialogOpenNew() {\r\n    setDialogContactInfo({\r\n      id: '',\r\n      name: '',\r\n      labelWidth: 0,\r\n    });\r\n    setCurrentDialog([]);\r\n    setOpenMessageDialog(true);\r\n  }\r\n\r\n  function handleCloseMessageDialog() {\r\n    setOpenMessageDialog(false);\r\n    setNewMessage(\"\");\r\n  }\r\n\r\n  function handleDialogContactChange(event) {\r\n    setDialogContactInfo({\r\n      ...dialogContactInfo,\r\n      [event.target.name]: event.target.value,\r\n    });\r\n    if(dialogConversations.get(event.target.value) === undefined){\r\n      setCurrentDialog([]);\r\n    }\r\n    else {\r\n      setCurrentDialog(dialogConversations.get(event.target.value).reverse());\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <div>\r\n        <IconButton\r\n          buttonRef={anchorEl}\r\n          aria-owns={openMessagesMenu ? 'menu-list-grow' : undefined}\r\n          aria-haspopup=\"true\"\r\n          onClick={toggleMessagesMenu}\r\n        >\r\n          <Forum/>\r\n        </IconButton>\r\n        <Popper open={openMessagesMenu} anchorEl={anchorEl.current} placement='bottom-end' transition disablePortal>\r\n          {({ TransitionProps, placement }) => (\r\n            <Grow\r\n              {...TransitionProps}\r\n              id=\"menu-list-grow\"\r\n              style={{ transformOrigin: placement === 'bottom' ? 'center top' : 'center bottom' }}\r\n            >\r\n              <Paper>\r\n                <ClickAwayListener onClickAway={handleMessagesMenuClose}>\r\n                {\r\n                  isLoggedIn ? (\r\n                    <div className={classes.root}>\r\n                      <List subheader={<ListSubheader component=\"div\">Messages</ListSubheader>}>\r\n                        <Divider />\r\n                        <ListItem>\r\n                          <ListItemText\r\n                            primary={'New message. . .'}\r\n                          />\r\n                          <ListItemSecondaryAction>\r\n                            <IconButton onClick={() => handleMessageDialogOpenNew()}>\r\n                              <Message/>\r\n                            </IconButton>\r\n                          </ListItemSecondaryAction>\r\n                        </ListItem>\r\n                        {menuConversations.map(menuConversation => (\r\n                          <ListItem key={menuConversation}>\r\n                            <ListItemText\r\n                              primary={menuConversation[0]}\r\n                              secondary={\r\n                                <>\r\n                                  {menuConversation[1][0]}\r\n                                </>\r\n                              }\r\n                            />\r\n                            <ListItemSecondaryAction>\r\n                              <IconButton onClick={() => handleMessageDialogOpenOld(menuConversation)}>\r\n                                <Reply/>\r\n                              </IconButton>\r\n                            </ListItemSecondaryAction>\r\n                          </ListItem>\r\n                        ))}\r\n                      </List>\r\n                    </div>\r\n                  ) :\r\n                  <MenuList subheader={<ListSubheader component=\"li\">Messages</ListSubheader>}>\r\n                    <MenuItem component={Link} to='/login'>\r\n                      <ListItemText inset primary=\"Please login to chat.\" />\r\n                      <ListItemIcon>\r\n                        <AccountCircle/>\r\n                      </ListItemIcon>\r\n                    </MenuItem>\r\n                  </MenuList>\r\n                }\r\n                </ClickAwayListener>\r\n              </Paper>\r\n            </Grow>\r\n          )}\r\n        </Popper>\r\n      </div>\r\n      <Dialog open={openMessageDialog} onClose={handleCloseMessageDialog} aria-labelledby=\"form-dialog-title\" >\r\n        <DialogContent>\r\n          <FormControl className={classes.formControl}>\r\n            <InputLabel>Choose contact. . .</InputLabel>\r\n            <Select\r\n              value={dialogContactInfo.name}\r\n              onChange={handleDialogContactChange}\r\n              name = \"name\"\r\n              renderValue={value => `${value}`}\r\n            >\r\n              {contacts.map(contact => (\r\n                <MenuItem key={contact} value={contact}>\r\n                  {contact}\r\n                </MenuItem>\r\n              ))}\r\n            </Select>\r\n          </FormControl>\r\n          <Divider />\r\n          <List>\r\n            {currentDialog.map((dialogConversation) => (\r\n              <ListItem key={dialogConversation.message_id}>\r\n                <ListItemText\r\n                  style={dialogConversation.contacting_id === parseInt(getAuthenticatedUserID()) ? {textAlign: \"right\"} : {textAlign: \"left\"}}\r\n                  primary={dialogConversation.contacting_id === parseInt(getAuthenticatedUserID()) ? dialogConversation.message + \" -\"  :  \"- \" + dialogConversation.message}\r\n                />\r\n              </ListItem>\r\n            ))}\r\n          </List>\r\n          <TextField\r\n            id=\"standard-multiline-flexible\"\r\n            label=\"Your message. . .\"\r\n            value={newMessage.message}\r\n            onChange={handleChange('message')}\r\n            multiline\r\n            rowsMax=\"4\"\r\n            className={classes.textField}\r\n            variant=\"outlined\"\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleCloseMessageDialog} color=\"primary\">\r\n            Cancel\r\n          </Button>\r\n          <Button variant=\"contained\" color=\"primary\" className={classes.button} onClick={sendMessage}>\r\n            Send\r\n            <Send className={classes.rightIcon}>send</Send>\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useContext, useEffect } from 'react';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport { useThemeMode } from '../theming';\r\nimport { DrawerOpenDispatch } from '../pages/layout';\r\nimport {\r\n  AppBar,\r\n  Toolbar,\r\n  Typography,\r\n  IconButton,\r\n  InputBase,\r\n  Divider,\r\n  Menu,\r\n  MenuItem,\r\n  Switch\r\n} from '@material-ui/core';\r\nimport { fade } from '@material-ui/core/styles/colorManipulator';\r\nimport {\r\n  Menu as MenuIcon,\r\n  Search as SearchIcon,\r\n  AccountCircle,\r\n  CloudUpload\r\n} from '@material-ui/icons';\r\nimport Messages from './messages';\r\nimport {\r\n  Link,\r\n  withRouter\r\n} from 'react-router-dom';\r\nimport {useAuthCtx} from '../authentication';\r\nimport {getAuthenticatedUserID} from '../authutils';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  masthead: {\r\n    display: 'flex'\r\n  },\r\n  appBar: {\r\n    [theme.breakpoints.up('sm')]: {\r\n      zIndex: theme.zIndex.drawer + 1\r\n    }\r\n  },\r\n  grow: {\r\n    flexGrow: 1\r\n  },\r\n  menuButton: {\r\n    marginLeft: 12,\r\n    marginRight: 12\r\n  },\r\n  titleWrap: {\r\n    width: '7em',\r\n    [theme.breakpoints.down('xs')]: {\r\n      display: 'none'\r\n    }\r\n  },\r\n  title: {\r\n    textDecoration: 'none'\r\n  },\r\n  search: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    position: 'relative',\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: fade(theme.palette.common.white, 0.15),\r\n    '&:hover': {\r\n      backgroundColor: fade(theme.palette.common.white, 0.25)\r\n    },\r\n    marginRight: theme.spacing.unit,\r\n    maxWidth: '50%',\r\n    [theme.breakpoints.up('sm')]: {\r\n      marginLeft: theme.spacing.unit,\r\n      width: 'auto',\r\n    },\r\n  },\r\n  searchIconWrap: {\r\n    width: theme.spacing.unit * 5,\r\n    height: '100%',\r\n    display: 'flex',\r\n    justifyContent: 'center'\r\n  },\r\n  searchIcon: {\r\n    width: theme.spacing.unit * 4,\r\n    height: theme.spacing.unit * 4,\r\n    padding: 0\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    width: '100%'\r\n  },\r\n  inputInput: {\r\n    padding: theme.spacing.unit,\r\n    paddingRight: 0,\r\n    transition: theme.transitions.create('width'),\r\n    maxWidth: '100%',\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: 160,\r\n      '&:focus': {\r\n        width: 260,\r\n      },\r\n    }\r\n  }\r\n}));\r\n\r\nfunction Masthead(props) {\r\n  const classes = useStyles();\r\n  const [themeMode, setThemeMode] = useThemeMode();\r\n  const [,setDrawerState] = useContext(DrawerOpenDispatch);\r\n\r\n  const [menuAnchor, setMenuAnchor] = useState(null);\r\n\r\n  const [isLoggedIn, authActionDispatch] = useAuthCtx();\r\n  const params = new URLSearchParams(props.location.search);\r\n  const [searchQuery, setSearchQuery] = useState(params.get('q') || '');\r\n\r\n  useEffect(() => {\r\n    setSearchQuery(params.get('q') || '');\r\n  }, [props]);\r\n\r\n  let onUploadClicked = () => {\r\n    props.history.push(`/upload`);\r\n    // if(isLoggedIn) props.history.push(`/upload`);\r\n    // else props.history.push('/login?redirect=upload');\r\n  };\r\n\r\n  let openMenu = (e) => {\r\n    setMenuAnchor(e.currentTarget);\r\n  };\r\n\r\n  let closeMenu = () => {\r\n    setMenuAnchor(null);\r\n  };\r\n  let handleMenu = label => (e) => {\r\n    switch(label) {\r\n      case 'account':\r\n        props.history.push(`/channel/${getAuthenticatedUserID()}`);\r\n        closeMenu();\r\n        break;\r\n      case 'options':\r\n        props.history.push('/options');\r\n        closeMenu();\r\n        break;\r\n      case 'login':\r\n        let {pathname:curPath,search} = props.location;\r\n        let curParams = new URLSearchParams(search);\r\n        curParams.delete('redirect');\r\n        let curParamsArr = [];\r\n        for(let key of curParams.keys()) curParamsArr.push(key);\r\n        let hasOthers = curParamsArr.length > 0;\r\n        let newParams = new URLSearchParams();\r\n        if(hasOthers || (curPath !== '/' && curPath !== '/login' && curPath !== '/register')) {\r\n          curPath = curPath.slice(1);\r\n          if(hasOthers) {\r\n            let others = curParams.toString();\r\n            newParams.set('redirect',encodeURIComponent(`${curPath}?${others}`));\r\n          }\r\n          else newParams.set('redirect',encodeURIComponent(`${curPath}`));\r\n        }\r\n        let newParamsStr = newParams.toString();\r\n        if(newParamsStr) props.history.push(`/login?${newParamsStr}`);\r\n        else props.history.push('/login');\r\n        closeMenu();\r\n        break;\r\n      case 'logout':\r\n        authActionDispatch({type:'logout'});\r\n        closeMenu();\r\n        break;\r\n      case 'toggle theme':\r\n        setThemeMode('toggle');\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  let handleSearchChange = (e) => {\r\n    setSearchQuery(e.currentTarget.value);\r\n  }\r\n  let submitSearch = () => {\r\n    props.history.push(`/browse?q=${searchQuery}`)\r\n  }\r\n  let catchSearchEnter = (e) => {\r\n    if(e.key === 'Enter') {\r\n      e.preventDefault();\r\n      submitSearch();\r\n    }\r\n  }\r\n\r\n  const isMenuOpen = Boolean(menuAnchor);\r\n\r\n  const miscMenuItems = [\r\n    <MenuItem key='toggledarkmode'>Dark Mode\r\n      <Switch checked={themeMode==='dark'} onChange={() => setThemeMode('toggle')} aria-label=\"Toggle dark mode\"/>\r\n    </MenuItem>\r\n  ];\r\n\r\n  const profileMenuItems = [\r\n    <MenuItem key='account' onClick={handleMenu('account')}>Account</MenuItem>,\r\n    <MenuItem key='options' onClick={handleMenu('options')}>Options</MenuItem>,\r\n    <MenuItem key='logout' onClick={handleMenu('logout')}>Log Out</MenuItem>\r\n  ];\r\n\r\n  const menu = (\r\n    <Menu anchorEl={menuAnchor} open={isMenuOpen} onClose={closeMenu}>\r\n      {\r\n        isLoggedIn ? [\r\n          ...profileMenuItems,\r\n        ] : (\r\n          <MenuItem key='login' onClick={handleMenu('login')}>Login</MenuItem>\r\n        )\r\n      }\r\n      <Divider key='divider'/>\r\n      {miscMenuItems}\r\n    </Menu>\r\n  );\r\n\r\n  return (\r\n    <div className={classes.masthead}>\r\n      <AppBar className={classes.appBar} position=\"fixed\">\r\n        <Toolbar>\r\n          <IconButton className={classes.menuButton} color=\"inherit\" aria-label=\"Menu\" onClick={() => setDrawerState('toggle')}>\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <div className={classes.titleWrap}>\r\n            <Typography variant=\"h6\" component={Link} to=\"/\" color=\"inherit\" className={classes.title} noWrap>\r\n              MeTube\r\n            </Typography>\r\n          </div>\r\n          <div className={classes.search}>\r\n            <div className={classes.searchIconWrap}>\r\n              <IconButton className={classes.searchIcon} color=\"inherit\" aria-label=\"Search\" onClick={submitSearch}>\r\n                <SearchIcon />\r\n              </IconButton>\r\n            </div>\r\n            <InputBase placeholder=\"Search...\" classes={{\r\n                root: classes.inputRoot,\r\n                input: classes.inputInput\r\n              }}\r\n              value={searchQuery}\r\n              onChange={handleSearchChange}\r\n              onKeyPress={catchSearchEnter}/>\r\n          </div>\r\n          <div className={classes.grow} />\r\n          { isLoggedIn && \r\n            <IconButton aria-label=\"File Upload\" onClick={onUploadClicked}>\r\n              <CloudUpload />\r\n            </IconButton>\r\n          }\r\n          <Messages/>\r\n          <IconButton aria-haspopup=\"true\" onClick={openMenu}>\r\n            <AccountCircle />\r\n          </IconButton>\r\n        </Toolbar>\r\n      </AppBar>\r\n      {menu}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withRouter(Masthead);\r\n","import React, { useContext, useEffect } from 'react';\r\nimport { makeStyles, useTheme } from '@material-ui/styles';\r\nimport { DrawerOpenDispatch } from '../pages/layout';\r\nimport {\r\n  Drawer,\r\n  Hidden,\r\n  IconButton,\r\n  Typography,\r\n  Divider,\r\n  List,\r\n  ListItem,\r\n  ListItemIcon,\r\n  ListItemText\r\n} from '@material-ui/core';\r\nimport {\r\n  unstable_useMediaQuery as useMediaQuery\r\n} from '@material-ui/core/useMediaQuery';\r\nimport {\r\n  Home,\r\n  // History,\r\n  PhotoLibrary,\r\n  VideoLibrary,\r\n  LibraryMusic,\r\n  // LibraryBooks,\r\n  // Subscriptions\r\n} from '@material-ui/icons';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport { Link } from 'react-router-dom';\r\nimport {useAuthCtx} from '../authentication';\r\n// import {getAuthenticatedUserID} from '../authutils';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  drawerWrap: {\r\n    [theme.breakpoints.up('md')]: {\r\n      width: theme.drawerWidth,\r\n      flexShrink: 0\r\n    }\r\n  },\r\n  drawer: {\r\n    overflowX: 'hidden'\r\n  },\r\n  list: {\r\n    width: theme.drawerWidth\r\n  },\r\n  header: {\r\n    display: 'flex',\r\n    position: 'relative',\r\n    alignItems: 'center',\r\n    minHeight: 64,\r\n    paddingLeft: 24,\r\n    paddingRight: 24,\r\n    color: theme.secondary\r\n  },\r\n  menuButton: {\r\n    marginLeft: 12,\r\n    marginRight: 12\r\n  },\r\n  titleWrap: {\r\n    width: '7em'\r\n  },\r\n  title: {\r\n    textDecoration: 'none'\r\n  }\r\n}));\r\n\r\nexport default function Sidebar() {\r\n  const classes = useStyles();\r\n  const [isOpen, setDrawerState] = useContext(DrawerOpenDispatch);\r\n  const [isLoggedIn] = useAuthCtx();\r\n  const theme = useTheme();\r\n  const isMobileWidth = useMediaQuery(theme.breakpoints.down('sm')) || document.body.clientWidth < theme.breakpoints.values.md;\r\n\r\n  useEffect(() => {\r\n    if(isMobileWidth) {\r\n      setDrawerState(false);\r\n    }\r\n    else {\r\n      setTimeout(() => {\r\n        if(document.body.clientWidth >= theme.breakpoints.values.md) setDrawerState(true)\r\n      }, 330);\r\n    }\r\n  }, [isMobileWidth]);\r\n\r\n  let toggleDrawer = (open) => () => {\r\n    setDrawerState(open);\r\n  };\r\n\r\n  const navList = (\r\n    <div className={classes.list}>\r\n      <div className={classes.header}>\r\n        <IconButton className={classes.menuButton} color=\"inherit\" aria-label=\"Menu\" onClick={toggleDrawer(false)}>\r\n          <MenuIcon />\r\n        </IconButton>\r\n        <div className={classes.titleWrap}>\r\n          <Typography variant=\"h6\" component={Link} to=\"/\" color=\"inherit\" className={classes.title} noWrap>\r\n            MeTube\r\n          </Typography>\r\n        </div>\r\n      </div>\r\n      <List>\r\n        <ListItem button component={Link} to='/' key='Home'>\r\n          <ListItemIcon><Home/></ListItemIcon>\r\n          <ListItemText primary='Home'/>\r\n        </ListItem>\r\n        {isLoggedIn ? (\r\n          <>\r\n            {/* <ListItem button component={Link} to='/history' key='History'>\r\n              <ListItemIcon><History/></ListItemIcon>\r\n              <ListItemText primary='History'/>\r\n            </ListItem>\r\n            <ListItem button component={Link} to={`/channel/${getAuthenticatedUserID()}/subscriptions`} key='Subscriptions'>\r\n              <ListItemIcon><Subscriptions/></ListItemIcon>\r\n              <ListItemText primary='Subscriptions'/>\r\n            </ListItem> */}\r\n          </>\r\n          ) : null\r\n        }\r\n        <Divider/>\r\n        <ListItem button component={Link} to={{pathname:'/browse',search:'?type=image'}} key='Images'>\r\n          <ListItemIcon><PhotoLibrary/></ListItemIcon>\r\n          <ListItemText primary='Images'/>\r\n        </ListItem>\r\n        <ListItem button component={Link} to={{pathname:'/browse',search:'?type=video'}} key='Videos'>\r\n          <ListItemIcon><VideoLibrary/></ListItemIcon>\r\n          <ListItemText primary='Videos'/>\r\n        </ListItem>\r\n        <ListItem button component={Link} to={{pathname:'/browse',search:'?type=audio'}} key='Music'>\r\n          <ListItemIcon><LibraryMusic/></ListItemIcon>\r\n          <ListItemText primary='Music'/>\r\n        </ListItem>\r\n      </List>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <nav className={classes.drawerWrap}>\r\n      <Hidden mdUp implementation=\"js\">\r\n        <Drawer variant=\"temporary\" open={isOpen} onClose={toggleDrawer(false)}>\r\n          <div tabIndex={0} role=\"button\" onClick={toggleDrawer(false)} onKeyDown={toggleDrawer(false)} className={classes.drawer}>\r\n            {navList}\r\n          </div>\r\n        </Drawer>\r\n      </Hidden>\r\n      <Hidden smDown implementation=\"js\">\r\n        <Drawer variant=\"persistent\" open={isOpen} onClose={toggleDrawer(false)}>\r\n          <div tabIndex={0} role=\"button\" className={classes.drawer}>\r\n            {navList}\r\n          </div>\r\n        </Drawer>\r\n      </Hidden>\r\n    </nav>\r\n  );\r\n};\r\n","import React from 'react';\nimport classNames from 'classnames';\nimport { makeStyles, useTheme } from '@material-ui/styles';\nimport {\n  unstable_useMediaQuery as useMediaQuery\n} from '@material-ui/core/useMediaQuery';\nimport {\n  Card,\n  CardActionArea,\n  CardContent,\n  CardMedia,\n  Typography,\n} from '@material-ui/core';\nimport {\n  Book,\n  PermIdentity,\n  OndemandVideo,\n  MusicVideo,\n  Photo,\n  VideoLibrary,\n  StarBorder\n} from '@material-ui/icons';\nimport { Link } from 'react-router-dom';\n\nlet dimensions = {\n  normal: {\n    card: {\n      w: 210,\n      h: 205\n    },\n    media: {\n      w: 210,\n      h: 118\n    },\n    content: {\n      w: 210,\n      h: 85\n    }\n  },\n  wide: {\n    card: {\n      w: '100%',\n      h: 118\n    },\n    media: {\n      w: 210,\n      h: 118\n    },\n    content: {\n      w: '100%',\n      h: '100%'\n    }\n  }\n}\n\nconst useStyles = makeStyles(theme => ({\n  cardWrap: {\n    width: dimensions.normal.card.w\n  },\n  card: {\n    width: dimensions.normal.card.w,\n    height: dimensions.normal.card.h,\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'stretch'\n  },\n  mediaWrap: {\n    width: dimensions.normal.media.w,\n    height: dimensions.normal.media.h\n  },\n  media: {\n    width: '100%',\n    height: '100%',\n    backgroundColor: theme.secondary\n  },\n  content: {\n    height: dimensions.normal.content.h\n  },\n\n  cardWrapMed: {\n    width: 210\n  },\n  cardMed: {\n    width: 210,\n    height: 205,\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'stretch'\n  },\n  mediaWrapMed: {\n    width: 210,\n    height: 118\n  },\n  mediaMed: {\n    width: 210,\n    height: 118,\n    backgroundColor: theme.secondary\n  },\n  contentMed: {\n    height: 85\n  },\n\n  cardWrapWide: {\n    width: dimensions.wide.card.w\n  },\n  cardWide: {\n    width: dimensions.wide.card.w,\n    height: dimensions.wide.card.h,\n    display: 'grid',\n    gridTemplateColumns: '210px 1fr'\n  },\n  mediaWrapWide: {\n    width: dimensions.wide.media.w,\n    height: dimensions.wide.media.h\n  },\n  mediaWide: {\n    width: '100%',\n    height: '100%',\n    backgroundColor: theme.secondary\n  },\n  contentWide: {\n    width: dimensions.wide.content.w\n  },\n  thumbnailPlaceholder: {\n    width: '100%',\n    height: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    fontSize: '4em',\n    color: theme.accentAlt\n  },\n  contentText: {\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis'\n  }\n}));\n\nfunction ResultItemThumbnail(props) {\n  const classes = useStyles();\n  const {className:propClass, thumbnail, name, result_type, mimetype} = props;\n\n  let getIconFromMimetype = (mime) => {\n    if(mime.includes('video')) return <OndemandVideo fontSize=\"inherit\"/>;\n    if(mime.includes('audio')) return <MusicVideo fontSize=\"inherit\"/>;\n    if(mime.includes('image')) return <Photo fontSize=\"inherit\"/>;\n    return <Book fontSize=\"inherit\"/>;\n  };\n  let getIconPlaceholder = (type) => {\n    switch(type) {\n      case 'users':\n        return <PermIdentity fontSize=\"inherit\"/>;\n      case 'playlists':\n        return <VideoLibrary fontSize=\"inherit\"/>;\n      case 'favorites':\n        return <StarBorder fontSize=\"inherit\"/>;\n      case 'files':\n        return getIconFromMimetype(mimetype);\n      default:\n        return;\n    }\n  };\n\n  if(thumbnail) {\n    return (\n      <CardMedia className={propClass}\n        title={name}\n        image={thumbnail}/>\n    );\n  }\n  else {\n    return (\n      <div className={propClass}>\n        <div className={classes.thumbnailPlaceholder}>\n          {getIconPlaceholder(result_type)}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default function ResultItemCard(props) {\n  const classes = useStyles();\n  const theme = useTheme();\n  const isMobileWidth = useMediaQuery(theme.breakpoints.down('xs')) || document.body.clientWidth < theme.breakpoints.values.xs;\n  const { \n    className:propClass,\n    variant,\n    name,\n    owner,\n    id,\n    result_type,\n    mimetype,\n    thumbnail,\n    playlist_id\n  } = props;\n\n  let getRouteFromResultType = (type) => {\n    switch(type) {\n      case 'users':\n        return '/channel';\n      case 'playlists':\n        return '/playlist';\n      case 'files':\n      default:\n        return '/view';\n    }\n  };\n\n  let getRoute = (resultType, id, playlistID) => {\n    if(resultType === 'favorites') {\n      return `/channel/${id}/playlists/favorites`;\n    }\n    let extras = '';\n    if(playlistID) extras = `?playlist=${playlistID}`;\n    return `${getRouteFromResultType(resultType)}/${id}${extras}`;\n  }\n  \n  let card = null; //FIXME: name and owner needs to be cutoff when too wide\n  if(variant === 'small' || isMobileWidth) {\n    card = (\n      <Card className={classNames(propClass,classes.cardWrap)}>\n        <CardActionArea className={classes.card} component={Link} to={getRoute(result_type,id,playlist_id)}>\n          <div className={classes.mediaWrap}>\n            <ResultItemThumbnail className={classes.media}\n              {...{name, result_type, mimetype, thumbnail}}/>\n          </div>\n          <CardContent className={classes.content}>\n            <Typography gutterBottom variant=\"subtitle1\" className={classes.contentText}>{name}</Typography>\n            <Typography gutterBottom variant=\"subtitle2\" className={classes.contentText}>{owner}</Typography>\n          </CardContent>\n        </CardActionArea>\n      </Card>\n    )\n  }\n  else if (variant === 'wide') {\n    card = (\n      <Card className={classNames(propClass,classes.cardWrapWide)}>\n        <CardActionArea className={classes.cardWide} component={Link} to={getRoute(result_type,id,playlist_id)}>\n          <div className={classes.mediaWrapWide}>\n            <ResultItemThumbnail className={classes.mediaWide}\n              {...{name, result_type, mimetype, thumbnail}}/>\n          </div>\n          <CardContent className={classes.contentWide}>\n            <Typography gutterBottom variant=\"subtitle1\" className={classes.contentText}>{name}</Typography>\n            <Typography variant=\"subtitle2\" className={classes.contentText}>{owner}</Typography>\n          </CardContent>\n        </CardActionArea>\n      </Card>\n    )\n  }\n  \n  return card;\n}\n","import React, {useState,useEffect} from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Typography,\n} from '@material-ui/core';\nimport Api from '../apiclient';\nimport ResultItemCard from '../components/resultItemCard';\n\nconst useStyles = makeStyles(theme => ({\n  section: {\n    display: 'flex',\n    flexDirection: 'column',\n    width: '100%',\n    margin: `${theme.spacing.unit*2}px 0`\n  },\n  sectionHeader: {\n    marginBottom: 4\n  },\n  filesGrid: {\n    display: 'grid',\n    gridTemplateColumns: 'repeat(auto-fit, 210px)',\n    gridColumnGap: theme.spacing.unit,\n    gridRowGap: theme.spacing.unit\n  },\n  resultErrorWrap: {\n    display: 'flex',\n    height: 100,\n    flexDirection: 'column',\n    padding: `${theme.spacing.unit}px 0`,\n    backgroundColor: theme.palette.background.paper,\n    justifyContent: 'center'\n  },\n  resultError: {\n    textAlign: 'left',\n    paddingLeft: theme.spacing.unit\n  }\n}));\n\nexport default function Section(props) {\n  const classes = useStyles();\n  const [files, setFiles] = useState([]);\n  let start = 0, count = 10;\n  let {filters, sorters, name, type, subscribers} = props;\n  let cancel = false;\n\n  useEffect(() => {\n    Api.getData('files',null,filters,sorters,start,count)\n      .then(response => {\n        console.log('section',response);\n        if(!cancel) setFiles(response.data.response);\n      })\n      .catch(err => {\n        let tag = 'section';\n        // got response from server\n        if(err.response) {\n          console.log(tag,err.response);\n        }\n        // request sent but no response\n        else if(err.request) {\n          console.log(tag,err.request);\n        }\n        // catch all\n        else {\n          console.log(tag,err);\n        }\n      });\n  }, []);\n\n  let contents;\n  if(files.length > 0) {\n    contents = (\n      <div className={classes.filesGrid}>\n        {\n          files.map(result => {\n            let {file_id,title,username,mimetype} = result;\n            return (\n              <ResultItemCard key={`result-files-${file_id}`}\n                className={classes.resultItem}\n                name={title}\n                owner={username}\n                result_type=\"files\"\n                mimetype={mimetype}\n                id={file_id}\n                variant=\"small\"/>\n            )\n          })\n        }\n      </div>\n    );\n  }\n  else contents = (\n    <div className={classes.resultErrorWrap}>\n      <Typography variant=\"h6\" className={classes.resultError}>No results</Typography>\n    </div>\n  );\n\n  return (\n    <div className={classes.section}>\n      <div className={classes.sectionHeader}>\n        <Typography variant=\"h5\" className={classes.sectionTitle}>\n          {name}\n        </Typography>\n        {type === 'channel' && \n          <Typography variant=\"body1\">\n            {`${subscribers} ${subscribers === 1 ? 'subscriber' : 'subscribers'}`}\n          </Typography>\n        }\n      </div>\n      {contents}\n    </div>\n  );\n}\n","\nexport let deepCopyObject = (obj) => {\n  let cpy = {};\n  for(let key in obj) {\n    if(obj[key] !== undefined && typeof(obj[key]) === 'object') cpy[key] = deepCopyObject(obj[key]);\n    else cpy[key] = obj[key];\n  }\n  return cpy;\n};\n\nexport let objectsDeepEqual = (lhs,rhs) => {\n  let lKeys = Object.keys(lhs);\n  let rKeys = Object.keys(rhs);\n  // keys not same length or not same\n  if(lKeys.length !== rKeys.length || !lKeys.every((lKey) => rKeys.includes(lKey))) {\n    return false;\n  }\n  return lKeys.every((key)=> {\n    if(typeof(lhs[key]) === 'object') return objectsDeepEqual(lhs[key],rhs[key]);\n    else return lhs[key] === rhs[key];\n  });\n};\n\nexport let basicRequestCatch = (tag) => (err) => {\n  // got response from server\n  if(err.response) {\n    console.log(tag,err.response);\n  }\n  // request sent but no response\n  else if(err.request) {\n    console.log(tag,err.request);\n  }\n  // catch all\n  else {\n    console.log(tag,err);\n  }\n}\n","import React, {useState,useEffect} from 'react';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport Api from '../apiclient';\r\nimport Section from '../components/section';\r\nimport { basicRequestCatch } from '../utils';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  container: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n    textAlign: 'left'\r\n  }\r\n}));\r\n\r\nexport default function HomePage() {\r\n  const classes = useStyles();\r\n  const [topChannels,setTopChannels] = useState([]);\r\n  let cancel = false;\r\n\r\n  useEffect(() => {\r\n    const topChannelSorts = [\r\n      {\r\n        'column': 'subscribers',\r\n        'descending': 'true'\r\n      }\r\n    ];\r\n    Api.getData('users/subscribers', null, [], topChannelSorts)\r\n      .then(response => {\r\n        if(!cancel) setTopChannels(response.data.response);\r\n      })\r\n      .catch(basicRequestCatch('home'));\r\n  }, []);\r\n\r\n  const trendingFilts = [\r\n    {\r\n      'column': 'upload_date',\r\n      'value': '0001-01-01',\r\n      'cmp': 'max'\r\n    }\r\n  ];\r\n  const trendingSorts = [\r\n    {\r\n      'column': 'views',\r\n      'descending': 'true'\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <div className={classes.container}>\r\n      <Section name='Trending' route='files'\r\n        filters={trendingFilts}\r\n        sorters={trendingSorts} />\r\n      {topChannels.map(user => {\r\n        let {user_id, username, subscribers} = user;\r\n        return <Section key={`channel-${user_id}`} name={username} type='channel' subscribers={subscribers}\r\n          filters={[...trendingFilts,{column:'user_id',value:user_id,cmp:'exact'}]}\r\n          sorters={trendingSorts}/>\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import React, {useState, useEffect} from 'react';\r\nimport classNames from 'classnames';\r\nimport {\r\n  blue,\r\n  green\r\n} from '@material-ui/core/colors';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport {\r\n  Paper,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  CircularProgress\r\n} from '@material-ui/core';\r\nimport { useAuthCtx } from '../authentication';\r\nimport { Redirect, Link } from 'react-router-dom';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  container: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center'\r\n  },\r\n  root: {\r\n    display: 'block',\r\n    ...theme.mixins.gutters(),\r\n    paddingTop: theme.spacing.unit * 2,\r\n    paddingBottom: theme.spacing.unit * 2\r\n  },\r\n  form: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n    alignItems: 'center'\r\n  },\r\n  buttonWrapper: {\r\n    margin: theme.spacing.unit,\r\n    position: 'relative'\r\n  },\r\n  buttonSuccess: {\r\n    backgroundColor: green[500],\r\n    '&:hover': {\r\n      backgroundColor: green[700]\r\n    }\r\n  },\r\n  buttonProgress: {\r\n    color: blue[500],\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    marginTop: -12,\r\n    marginLeft: -12\r\n  },\r\n  registerLink: {\r\n    textDecoration: 'none',\r\n    marginTop: theme.spacing.unit * 2\r\n  }\r\n}));\r\n\r\nexport default function LoginPage(props) {\r\n  const classes = useStyles();\r\n  const params = new URLSearchParams(props.location.search);\r\n  let redirectPath = decodeURIComponent(params.get('redirect') || '');\r\n  const [isLoggedIn, authActionDispatch, errorState, authState] = useAuthCtx();\r\n  const [redirect, setRedirect] = useState(false);\r\n  const [inputs, setInputs] = useState({username:'', password:''});\r\n  let timer = null;\r\n\r\n  let handleChange = (key) => (e) => {\r\n    setInputs({ ...inputs, [key]: e.currentTarget.value });\r\n  }\r\n\r\n  useEffect(() => {\r\n    if(isLoggedIn) {\r\n      setRedirect(true);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if(authState.success) {\r\n      timer = setTimeout(() => {\r\n        setRedirect(true);\r\n      }, 800);\r\n    }\r\n\r\n    return () => {\r\n      clearTimeout(timer);\r\n    }\r\n  }, [authState]);\r\n\r\n  let handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if(!authState.loading) {\r\n      authActionDispatch({\r\n        type: 'login',\r\n        credentials: inputs\r\n      });\r\n    }\r\n  }\r\n\r\n  const { loading, success } = authState;\r\n\r\n  return (\r\n    <div className={classes.container}>\r\n      <Paper className={classes.root} elevation={1}>\r\n        <Typography variant=\"h5\">\r\n          Login\r\n        </Typography>\r\n        <Typography variant=\"body1\" color=\"error\">\r\n          {errorState.message}\r\n        </Typography>\r\n        <form className={classes.form} onSubmit={handleSubmit}>\r\n          <TextField id='username' label='Username' type='text' required={true}\r\n            className={classes.textField} margin='normal' variant='outlined'\r\n            onChange={handleChange('username')}\r\n            disabled={loading}\r\n            autoFocus/>\r\n          <TextField id='password' label='Password' type='password' required={true}\r\n            className={classes.textField} margin='normal' variant='outlined' autoComplete='on'\r\n            onChange={handleChange('password')}\r\n            disabled={loading}/>\r\n          <div className={classes.buttonWrapper}>\r\n            <Button type='submit'\r\n              size='large'\r\n              color='primary'\r\n              className={classNames({\r\n                [classes.buttonSuccess]: success\r\n              })}\r\n              variant='contained'\r\n              disabled={loading}>\r\n              Log In\r\n            </Button>\r\n            {loading && <CircularProgress size={24} className={classes.buttonProgress}/>}\r\n          </div>\r\n        </form>\r\n        {redirect && <Redirect to={`/${redirectPath}`}/>}\r\n      </Paper>\r\n      <Typography className={classes.registerLink}\r\n        variant=\"body1\"\r\n        component={Link}\r\n        to={`/register${redirectPath !== '' ? `?redirect=${redirectPath}` : ''}`}>\r\n          Don't have an account? Register here!\r\n      </Typography>\r\n    </div>\r\n  );\r\n}\r\n","import React, {useState, useEffect} from 'react';\r\nimport classNames from 'classnames';\r\nimport {\r\n  blue,\r\n  green\r\n} from '@material-ui/core/colors';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport {\r\n  Paper,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  CircularProgress\r\n} from '@material-ui/core';\r\nimport { useAuthCtx } from '../authentication';\r\nimport { Redirect } from 'react-router-dom';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  container: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center'\r\n  },\r\n  root: {\r\n    display: 'block',\r\n    ...theme.mixins.gutters(),\r\n    paddingTop: theme.spacing.unit * 2,\r\n    paddingBottom: theme.spacing.unit * 2\r\n  },\r\n  form: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n    alignItems: 'center'\r\n  },\r\n  buttonWrapper: {\r\n    margin: theme.spacing.unit,\r\n    position: 'relative'\r\n  },\r\n  buttonSuccess: {\r\n    backgroundColor: green[500],\r\n    '&:hover': {\r\n      backgroundColor: green[700]\r\n    }\r\n  },\r\n  buttonProgress: {\r\n    color: blue[500],\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    marginTop: -12,\r\n    marginLeft: -12\r\n  }\r\n}));\r\n\r\nexport default function RegisterPage(props) {\r\n  const classes = useStyles();\r\n  const params = new URLSearchParams(props.location.search);\r\n  let redirectPath = params.get('redirect') || '';\r\n  const [isLoggedIn, authActionDispatch, errorState,, regState] = useAuthCtx();\r\n  const [redirect, setRedirect] = useState(false);\r\n  const [inputs, setInputs] = useState({email:'', username:'', password:''});\r\n  let timer = null;\r\n\r\n  let handleChange = (key) => (e) => {\r\n    setInputs({ ...inputs, [key]: e.currentTarget.value });\r\n  }\r\n\r\n  useEffect(() => {\r\n    if(isLoggedIn) {\r\n      setRedirect(true);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if(regState.success) {\r\n      timer = setTimeout(() => {\r\n        setRedirect(true);\r\n      }, 800);\r\n    }\r\n\r\n    return () => {\r\n      clearTimeout(timer);\r\n    }\r\n  }, [regState]);\r\n\r\n  let handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if(!regState.loading) {\r\n      authActionDispatch({\r\n        type: 'register',\r\n        credentials: inputs\r\n      });\r\n    }\r\n  }\r\n\r\n  const { loading, success } = regState;\r\n\r\n  return (\r\n    <div className={classes.container}>\r\n      <Paper className={classes.root} elevation={1}>\r\n        <Typography variant=\"h5\">\r\n          Register\r\n        </Typography>\r\n        <Typography variant=\"body1\" color=\"error\">\r\n          {errorState.message}\r\n        </Typography>\r\n        <form className={classes.form} onSubmit={handleSubmit}>\r\n          <TextField id='email' label='Email' type='email' required={true}\r\n            className={classes.textField} margin='normal' variant='outlined'\r\n            onChange={handleChange('email')}\r\n            disabled={loading}\r\n            autoFocus\r\n            error={errorState.emailError}\r\n            helperText={errorState.emailErrorMsg}/>\r\n          <TextField id='username' label='Username' type='text' required={true}\r\n            className={classes.textField} margin='normal' variant='outlined'\r\n            onChange={handleChange('username')}\r\n            disabled={loading}\r\n            error={errorState.usernameError}\r\n            helperText={errorState.usernameErrorMsg}/>\r\n          <TextField id='password' label='Password' type='password' required={true}\r\n            className={classes.textField} margin='normal' variant='outlined' autoComplete='on'\r\n            onChange={handleChange('password')}\r\n            disabled={loading}\r\n            error={errorState.passwordError}\r\n            helperText={errorState.passwordErrorMsg}/>\r\n          <div className={classes.buttonWrapper}>\r\n            <Button type='submit'\r\n              size='large'\r\n              color='primary'\r\n              className={classNames({\r\n                [classes.buttonSuccess]: success\r\n              })}\r\n              variant='contained'\r\n              disabled={loading}>\r\n              Register\r\n            </Button>\r\n            {loading && <CircularProgress size={24} className={classes.buttonProgress}/>}\r\n          </div>\r\n        </form>\r\n        {redirect && <Redirect to={`/${redirectPath}`}/>}\r\n      </Paper>\r\n    </div>\r\n  );\r\n}\r\n","import React, {useState, useEffect} from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Typography,\n  ExpansionPanel,\n  ExpansionPanelSummary,\n  ExpansionPanelDetails,\n  FormControl,\n  FormLabel,\n  RadioGroup,\n  FormControlLabel,\n  Radio,\n  Button,\n  Switch\n} from '@material-ui/core';\nimport {\n  Tune\n} from '@material-ui/icons';\nimport axios from 'axios';\nimport Api from '../apiclient';\nimport {deepCopyObject, basicRequestCatch} from '../utils';\nimport ResultItemCard from '../components/resultItemCard';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    textAlign: 'left'\n  },\n  results: {\n    marginTop: theme.spacing.unit\n  },\n  resultError: {\n    textAlign: 'center'\n  },\n  resultItem: {\n    marginBottom: theme.spacing.unit\n  },\n  optionsToggle: {\n  },\n  optionsTitle: {\n    fontSize: 15,\n    fontWeight: theme.typography.fontWeightRegular,\n    marginLeft: theme.spacing.unit\n  },\n  options: {\n    display: 'grid',\n    gridAutoRows: '1fr',\n    gridAutoFlow: 'column'\n  },\n  optionGroupLabel: {\n    marginBottom: theme.spacing.unit\n  },\n  optionLabel: {\n    height: '2.2em',\n    marginRight: theme.spacing.unit * 3\n  },\n  optionRadio: {\n    padding: '0 12px 0 0',\n    marginLeft: 12\n  }\n}));\n\nlet getSearchType = (s) => {\n  switch(s) {\n    case 'video':\n    case 'audio':\n    case 'image':\n    case 'all':\n      return s;\n    default:\n      return '';\n  }\n};\n\nconst initialInputs = {\n  'category': 'all',\n  'type': '',\n  'sort': 'views',\n  'sortDsc': true\n};\n\nexport default function BrowsePage(props) {\n  const classes = useStyles();\n  //FIXME: maybe reset sort and filters when search query changes?\n  const params = new URLSearchParams(props.location.search);\n  const [query, setQuery] = useState(params.get('q') || null);\n  const [results, setResults] = useState([]);\n  let initialInputsWithType = {\n    ...initialInputs,\n    'type': getSearchType(params.get('type'))\n  };\n  const [inputs, setInputs]   = useState({...initialInputsWithType, 'category': initialInputsWithType['type'] !== '' ? 'files' : initialInputs['category']});\n  let cancelSearch = false;\n\n  let makeFilters = (category) => {\n    let queryFilters = [];\n    if(category === 'files') {\n      if(inputs.type !== 'all') {\n        queryFilters.push({\n          'column': 'mimetype',\n          'value': inputs.type,\n          'cmp': 'contains'\n        });\n      }\n    }\n    return queryFilters;\n  };\n  let makeSorters = (category) => {\n    let querySorters = [];\n    if(category === 'files') {\n      switch(inputs.sort) {\n        case 'likes':\n          querySorters.push({\n            'column': 'upvotes',\n            'descending': inputs.sortDsc\n          });\n          break;\n        case 'downloads':\n          //TODO: need column or table in db\n          break;\n        case 'subscribers':\n          querySorters.push({\n            'column': 'subscribers',\n            'descending': inputs.sortDsc\n          });\n          break;\n        case 'views':\n        default:\n          querySorters.push({\n            'column': 'views',\n            'descending': inputs.sortDsc\n          });\n          break;\n      }\n    }\n    return querySorters;\n  };\n  let updateInputs = (key,value) => {\n    let newInputs = deepCopyObject(inputs);\n    newInputs[key] = value;\n    switch(key) {\n      case 'category':\n        switch(value) {\n          case 'all':\n          case 'playlists':\n            if(newInputs['sort'] === 'subscribers') newInputs['sort'] = initialInputs['sort'];\n            newInputs['type'] = '';\n            break;\n          case 'files':\n            if(newInputs['type'] === '') newInputs['type'] = 'all';\n            if(newInputs['sort'] === 'subscribers') newInputs['sort'] = initialInputs['sort'];\n            break;\n          case 'users':\n            newInputs['sort'] = 'subscribers';\n            newInputs['type'] = '';\n            break;\n          default:\n            break;\n        }\n        break;\n      case 'type':\n        if(value !== '') {\n          newInputs['category'] = 'files';\n          if(newInputs['sort'] === 'subscribers') newInputs['sort'] = initialInputs['sort'];\n        }\n        break;\n      case 'sort':\n        if (value === 'subscribers') {\n          newInputs['category'] = 'users';\n          newInputs['type'] = '';\n        }\n        else if (newInputs['category'] === 'users') newInputs['category'] = initialInputs['category'];\n        break;\n      default:\n        break;\n    }\n    setInputs(newInputs);\n  };\n  let handleInputs = (key) => (e) => {\n    let value = e.currentTarget.value;\n    if(key === 'type') {\n      params.set('type',value);\n      props.history.push(`/browse?${params.toString()}`);\n    }\n    updateInputs(key,value);\n  };\n\n  useEffect(() => {\n    const newParams = new URLSearchParams(props.location.search);\n    const newQuery = newParams.get('q') || null;\n    const newType  = newParams.get('type') || '';\n    if(query !== newQuery) setQuery(newQuery);\n    if(inputs['type'] !== newType) updateInputs('type',newType);\n  }, [props]);\n\n  let getRankedResults = (results) => {\n    return results.reduce((acc, val) => acc.concat(val),[]);\n  };\n\n  useEffect(() => {\n    let requests = [];\n    let reqTypes = [];\n    if (inputs.category === 'all') {\n      ['files','playlists','users'].forEach((cat) => {\n        requests.push(Api.getData(cat, query, makeFilters(cat), makeSorters(cat)));\n        reqTypes.push(cat);\n      });\n    }\n    else {\n      requests.push(Api.getData(inputs.category, query, makeFilters(inputs.category), makeSorters(inputs.category)));\n      reqTypes.push(inputs.category);\n    }\n    axios.all(requests)\n      .then(responses => {\n        if(cancelSearch) return;\n        let reqResults = responses.map((res,i) => {\n          let resType = reqTypes[i];\n          let data = res.data.response;\n          if(data.length === 0) return null;\n          data.forEach((item) => {\n            item['resultType'] = resType;\n            switch(resType) {\n              case 'files':\n                item['id'] = item.file_id;\n                item['display_name'] = item.title;\n                break;\n              case 'users':\n                item['id'] = item.user_id;\n                item['display_name'] = item.username;\n                break;\n              case 'playlists':\n                item['id'] = item.playlist_id;\n                item['display_name'] = item.title;\n                break;\n              default:\n                break;\n            }\n          });\n          return data;\n        });\n        reqResults = reqResults.filter((i) => {\n          return i !== null;\n        });\n        let rankedResults = getRankedResults(reqResults);\n        if(!cancelSearch) setResults(rankedResults);\n      })\n      .catch(basicRequestCatch('browse'));\n\n    return () => {\n      cancelSearch = true;\n    }\n  }, [query,inputs]);\n\n  let contents;\n  if(results.length > 0) {\n    contents = results.map(result => {\n      let {resultType, id, display_name, username, mimetype} = result;\n      return (\n        <ResultItemCard key={`result-${resultType}-${id}`}\n          className={classes.resultItem}\n          name={display_name}\n          owner={username}\n          result_type={resultType}\n          mimetype={mimetype}\n          id={id}\n          variant=\"wide\"/>\n      )\n    });\n  }\n  else contents = <Typography variant=\"h5\" className={classes.resultError}>No results</Typography>;\n\n  return (\n    <div className={classes.container}>\n      <ExpansionPanel>\n        <ExpansionPanelSummary expandIcon={null}>\n          <Button variant=\"text\">\n            <Tune /><Typography className={classes.optionsTitle}>Search Options</Typography>\n          </Button>\n          <div key=\"placeholder_for_icon\" name=\"necessary_for_styling\"></div>\n        </ExpansionPanelSummary>\n        <ExpansionPanelDetails className={classes.options}>\n          <FormControl component=\"fieldset\">\n            <FormLabel component=\"legend\" className={classes.optionGroupLabel}>Category</FormLabel>\n            <RadioGroup name=\"category\" value={inputs['category']} onChange={handleInputs('category')} aria-label=\"category\">\n              <FormControlLabel control={<Radio/>} label=\"All\"      value=\"all\"       className={classes.optionLabel}/>\n              <FormControlLabel control={<Radio/>} label=\"File\"     value=\"files\"     className={classes.optionLabel}/>\n              <FormControlLabel control={<Radio/>} label=\"Playlist\" value=\"playlists\" className={classes.optionLabel}/>\n              <FormControlLabel control={<Radio/>} label=\"Channel\"  value=\"users\"     className={classes.optionLabel}/>\n            </RadioGroup>\n          </FormControl>\n          <FormControl component=\"fieldset\">\n            <FormLabel component=\"legend\" className={classes.optionGroupLabel}>Type</FormLabel>\n            <RadioGroup name=\"type\" value={inputs['type']} onChange={handleInputs('type')} aria-label=\"type\">\n              <FormControlLabel control={<Radio/>} label=\"All\"   value=\"all\"   className={classes.optionLabel}/>\n              <FormControlLabel control={<Radio/>} label=\"Video\" value=\"video\" className={classes.optionLabel}/>\n              <FormControlLabel control={<Radio/>} label=\"Audio\" value=\"audio\" className={classes.optionLabel}/>\n              <FormControlLabel control={<Radio/>} label=\"Image\" value=\"image\" className={classes.optionLabel}/>\n            </RadioGroup>\n          </FormControl>\n          <FormControl component=\"fieldset\">\n            <FormLabel component=\"legend\" className={classes.optionGroupLabel}>Sort</FormLabel>\n            <RadioGroup name=\"sort\" value={inputs['sort']} onChange={handleInputs('sort')} aria-label=\"sort\">\n              <FormControlLabel control={<Radio/>} label=\"Most Likes\"       value=\"likes\"       className={classes.optionLabel}/>\n              <FormControlLabel control={<Radio/>} label=\"Most Views\"       value=\"views\"       className={classes.optionLabel}/>\n              <FormControlLabel control={<Radio/>} label=\"Most Downloads\"   value=\"downloads\"   className={classes.optionLabel}/>\n              <FormControlLabel control={<Radio/>} label=\"Most Subscribers\" value=\"subscribers\" className={classes.optionLabel}/>\n            </RadioGroup>\n            <FormControlLabel label={inputs['sortDsc'] ? \"Descending\" : \"Ascending\"} className={classes.optionLabel} control={\n                <Switch checked={inputs['sortDsc']} onChange={() => setInputs({...inputs,'sortDsc':!inputs['sortDsc']})}/>\n              }/>\n          </FormControl>\n        </ExpansionPanelDetails>\n      </ExpansionPanel>\n      <div className={classes.results}>\n        {contents}\n      </div>\n    </div>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Typography\n} from '@material-ui/core';\nimport Api from '../apiclient';\n\nconst useStyles = makeStyles(theme => ({\n  player: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center'\n  },\n  videoContainer: {\n    width: '100%',\n    backgroundColor: 'black'\n  },\n  video: {\n    width: '100%',\n    maxHeight: '80vh',\n    [theme.breakpoints.down('xs')]: {\n      maxHeight: '95vh'\n    }\n  },\n  audioContainer: {\n    width: '100%',\n    height: '20vh',\n    minHeight: 100,\n    backgroundColor: 'black'\n  },\n  audio: {\n    width: '100%'\n  },\n  imageContainer: {\n    width: '100%',\n    minHeight: 100,\n    backgroundColor: 'black'\n  },\n  image: {\n    width: '100%'\n  },\n  errorContainer: {\n    display: 'flex',\n    width: '100%',\n    height: '20vh',\n    minHeight: 100,\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: 'black'\n  },\n}));\n\nconst initialErrorState = {\n  show: false,\n  primary: '',\n  secondary: ''\n};\n\nexport default function Player(props) {\n  const classes = useStyles();\n  const [fileID, setFileID] = useState(props.file_id);\n  const [blobURL, setBlobURL] = useState(null);\n  const [errorMessage,setErrorMessage] = useState(initialErrorState);\n  let {mimetype='', name=''} = props;\n\n  useEffect(() => {\n    setFileID(props.file_id);\n  }, [props]);\n\n  useEffect(() => {\n    if(fileID) {\n      if(mimetype.includes('video') || mimetype.includes('audio') || mimetype.includes('image')) {\n        let reqURL = `${Api.baseURL}/files/${fileID}/g`;\n        setBlobURL(reqURL);\n        if(errorMessage.show) setErrorMessage(initialErrorState);\n      }\n      else if(mimetype === '') {\n        setErrorMessage({\n          show: true,\n          primary: 'Viewer unavailable',\n          secondary: `Unknown mimetype`\n        });\n      }\n      else {\n        setErrorMessage({\n          show: true,\n          primary: 'Viewer unavailable',\n          secondary: `Unsupported mimetype ${mimetype}`\n        });\n      }\n\n      // Api.request('get',`/files/${fileID}/g`,{},{responseType: 'blob'})\n      //   .then(res => {\n      //     mimetype = res.data.type;\n      //     if(mimetype.includes('video') || mimetype.includes('audio') || mimetype.includes('image')) {\n      //       let blob_url = URL.createObjectURL(res.data);\n      //       if(cancel) return;\n      //       setBlobURL(blob_url);\n      //       if(errorMessage.show) setErrorMessage(initialErrorState);\n      //     }\n      //     else {\n      //       if(cancel) return;\n      //       setErrorMessage({\n      //         show: true,\n      //         primary: 'Viewer unavailable',\n      //         secondary: `Unsupported mimetype ${mimetype}`\n      //       });\n      //     }\n      //   })\n      //   .catch(err => {\n      //     let msg = '';\n      //     // got response from server\n      //     if(err.response) {\n      //       const { status } = err.response;\n      //       if (status >= 500 && status < 600) {\n      //         msg = `Server error ${status}, please contact the admins`;\n      //       }\n      //       else if (status === 404) {\n      //         msg = \"File not found\";\n      //       }\n      //       else if (status === 403) {\n      //         msg = \"File permission blocked\";\n      //       }\n      //       else {\n      //         msg = `Sorry, unknown error ${status}`;\n      //       }\n      //     }\n      //     // request sent but no response\n      //     else if(err.request) {\n      //       msg = err.message;\n      //     }\n      //     // catch all\n      //     else {\n      //       msg = 'Sorry, unknown error';\n      //     }\n      //     console.log('player',err);\n      //     if(cancel) return;\n      //     setErrorMessage({\n      //       show: true,\n      //       primary: msg\n      //     });\n      //   })\n    }\n    else {\n      setErrorMessage({\n        show: true,\n        primary: \"Viewer unavailable\",\n        secondary: \"File not found\"\n      });\n    }\n  }, [fileID]);\n\n  let viewer = null;\n  if(errorMessage.show) {\n    viewer = (\n      <div className={classes.errorContainer}>\n        <Typography variant=\"h6\">{errorMessage.primary}</Typography>\n        <Typography variant=\"h6\">{errorMessage.secondary}</Typography>\n      </div>\n    );\n  }\n  else if (blobURL) {\n    if (mimetype.includes('video')) {\n      viewer = (\n        <div className={classes.videoContainer}>\n          <video className={classes.video} src={blobURL} controls/>\n        </div>\n      );\n    }\n    else if (mimetype.includes('audio')) {\n      viewer = (\n        <div className={classes.audioContainer}>\n          <audio className={classes.audio} src={blobURL} controls/>\n        </div>\n      )\n    }\n    /*else if (mimetype.includes('text')) {\n\n    }*/\n    else if (mimetype.includes('image')) {\n      viewer = (\n        <div className={classes.imageContainer}>\n          <img className={classes.image} src={blobURL} alt={name}/>\n        </div>\n      )\n    }\n  }\n\n  return (\n    <div className={classes.player}>\n      {viewer}\n    </div>\n  )\n}\n","import React, { useState, useEffect, useReducer } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  blue,\n} from '@material-ui/core/colors';\nimport {\n  Popper,\n  Paper,\n  Grow,\n  ClickAwayListener,\n  Divider,\n  Typography,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Checkbox,\n  Collapse,\n  TextField,\n  FormControl,\n  InputLabel,\n  Select,\n  Button,\n  CircularProgress\n} from '@material-ui/core';\nimport {\n  Add as AddIcon\n} from '@material-ui/icons';\nimport axios from 'axios';\nimport Api from '../apiclient';\nimport {getAuthenticatedUserID} from '../authutils';\nimport {deepCopyObject, basicRequestCatch} from '../utils';\n\nconst useStyles = makeStyles(theme => ({\n  menuWrapper: {\n    width: 260,\n    zIndex: theme.zIndex.modal + 1\n  },\n  playlistMenu: {\n    padding: theme.spacing.unit\n  },\n  form: {\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  playlistMenuTitle: {\n    margin: `${theme.spacing.unit}px 0`,\n    paddingLeft: theme.spacing.unit,\n    paddingRight: theme.spacing.unit\n  },\n  listItem: {\n    height: '2.2em',\n    paddingLeft: 0\n  },\n  listItemBox: {\n    padding: 0,\n    marginLeft: 12\n  },\n  buttonWrapper: {\n    textAlign: 'right',\n    paddingTop: theme.spacing.unit\n  },\n  buttonProgress: {\n    color: blue[500],\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    marginTop: -12,\n    marginLeft: -12\n  }\n}));\n\nconst initialCreatePlaylistState = {\n  loading: false,\n  success: false\n};\nconst createPlaylistReducer = (state, action) => {\n  switch(action) {\n    case 'submit':\n      return {\n        loading: true,\n        success: false\n      }\n    case 'success':\n      return {\n        loading: false,\n        success: true\n      }\n    case 'error':\n    case 'initial':\n      return initialCreatePlaylistState;\n    default:\n      return state;\n  }\n};\n\nconst initialInputs = {\n  name: '',\n  description: '',\n  privacy: 'private'\n};\n\nexport default function PlaylistMenu(props) {\n  const classes = useStyles();\n  const [playlists, setPlaylists] = useState([]);\n  const [formOpen, setFormOpen] = useState(false);\n  const [inputs, setInputs] = useState(initialInputs);\n  const [createPlaylistState, setCreatePlaylistState] = useReducer(createPlaylistReducer, initialCreatePlaylistState);\n  let userID = getAuthenticatedUserID();\n  let {file_id} = props;\n  let cancel = false;\n\n  useEffect(() => {\n    Api.getData('playlists',null,[{column:'user_id',value:userID,cmp:'exact'}],[])\n      .then(res => {\n        console.log('playlistmenu get success',res);\n        if(!cancel) setPlaylists(res.data.response);\n      })\n      .catch(basicRequestCatch('playlistmenu'));\n  }, []);\n\n  useEffect(() => {\n    if(createPlaylistState.success) {\n      closeForm();\n      Api.getData('playlists',null,[{column:'user_id',value:userID,cmp:'exact'}],[])\n        .then(res => {\n          console.log('playlistmenu get refresh success',res);\n          if(!cancel) setPlaylists(res.data.response);\n        })\n        .catch(basicRequestCatch('playlistmenu get error'));\n    }\n  }, [createPlaylistState]);\n\n  useEffect(() => {\n    let requests = [];\n    if(playlists.length > 0) {\n      playlists.forEach(playlist => {\n        let {playlist_id:id} = playlist;\n        requests.push(Api.getData(`playlists/${id}/files`,null,[{column:'file_id',value:file_id,cmp:'exact'}]));\n      });\n      axios.all(requests)\n        .then(responses => {\n          if(cancel) return;\n          console.log('playlistmenu get files success',responses);\n          let newInputs = deepCopyObject(inputs);\n          responses.forEach((res, i) => {\n            if(res.data.response.length) {\n              newInputs[`checkbox-${playlists[i].playlist_id}`] = true;\n            }\n          });\n          setInputs(newInputs);\n        })\n        .catch(basicRequestCatch('playlistmenu get file added error'));\n    }\n  }, [playlists]);\n\n  let openForm = () => {\n    setFormOpen(true);\n  };\n  let closeForm = () => {\n    setFormOpen(false);\n  };\n  let submitForm = (e) => {\n    e.preventDefault();\n    setCreatePlaylistState('submit');\n    let {name:title,description} = inputs; //TODO: add privacy setting?\n    Api.request('post','playlists/create',{title,description,user_id:getAuthenticatedUserID()},{},true)\n      .then(res => {\n        console.log('playlistmenu post success',res);\n        setCreatePlaylistState('success');\n        let {playlist_id} = res.data.response;\n        onClickPlaylist(playlist_id)();\n      })\n      .catch(err => {\n        basicRequestCatch(`playlistmenu post`)(err);\n        setCreatePlaylistState('error');\n      });\n  };\n\n  let handleChange = (key) => (e) => {\n    setInputs({...inputs, [key]: e.currentTarget.value});\n  };\n  let onClickPlaylist = (id) => () => {\n    let key = `checkbox-${id}`;\n    let isAdd = !inputs[key];\n    let method = isAdd ? 'link' : 'unlink';\n    if(id === 'favorites') {\n      Api.request(method,`users/${userID}/favorites`, {file_id:file_id}, {}, true)\n        .then(res => {\n          console.log(`playlistmenu favorites ${method}`,res);\n          setInputs({...inputs, [key]: isAdd});\n        })\n        .catch(basicRequestCatch(`playlistmenu favorites ${method}`));\n    }\n    else {\n      Api.request(method,`playlists/${id}/file`, {file_id:file_id}, {}, true)\n        .then(res => {\n          console.log(`playlistmenu ${method}`,res);\n          setInputs({...inputs, [key]: isAdd});\n        })\n        .catch(basicRequestCatch(`playlistmenu ${method}`));\n    }\n  };\n\n  let plistItems = [\n    <ListItem key={`plist-favorites`} button onClick={onClickPlaylist('favorites')} className={classes.listItem}>\n      <Checkbox checked={inputs[`checkbox-favorites`] || false} tabIndex={-1} disableRipple className={classes.listItemBox}/>\n      <ListItemText primary=\"Favorites\" />\n    </ListItem>\n  ];\n  if(playlists.length > 0) {\n    plistItems.push(...playlists.map(result => {\n      let {playlist_id, title} = result;\n      return (\n        <ListItem key={`plist-result-${playlist_id}`} button onClick={onClickPlaylist(playlist_id)} className={classes.listItem}>\n          <Checkbox checked={inputs[`checkbox-${playlist_id}`] || false} tabIndex={-1} disableRipple className={classes.listItemBox}/>\n          <ListItemText primary={title} />\n        </ListItem>\n      );\n    }));\n  }\n  // else {\n  //   plistItems = <ListItem><ListItemText primary=\"No playlists\"></ListItemText></ListItem>;\n  // }\n\n  let {loading} = createPlaylistState;\n\n  let {open, anchorEl, onClose} = props;\n\n  let closeMenu = () => {\n    closeForm();\n    onClose();\n  }\n\n  return (\n    <Popper open={open} anchorEl={anchorEl} transition className={classes.menuWrapper}>\n      {({ TransitionProps, placement }) => (\n        <Grow\n          {...TransitionProps}\n          id=\"menu-list-grow\"\n          style={{ transformOrigin: placement === 'bottom' ? 'center top' : 'center bottom' }}\n        >\n          <Paper>\n            <ClickAwayListener onClickAway={closeMenu}>\n              <List className={classes.playlistMenu}>\n                <Typography variant=\"body1\" className={classes.playlistMenuTitle}>Add to...</Typography>\n                <Divider/>\n                {plistItems}\n                <Divider/>\n                {formOpen ? null :\n                  <ListItem key=\"new-playlist\" button onClick={openForm}>\n                    <ListItemIcon><AddIcon/></ListItemIcon>\n                    <ListItemText primary=\"Create new playlist\"/>\n                  </ListItem>\n                }\n                <Collapse in={formOpen} timeout=\"auto\">\n                  <form className={classes.form} onSubmit={submitForm}>\n                    <TextField id='name' label='Playlist Name' type='text' required={true}\n                      className={classes.textField} margin='normal' variant='outlined'\n                      onChange={handleChange('name')}\n                      disabled={loading}\n                      autoFocus/>\n                    <TextField id='description' label='Description' type='text' required={false}\n                      className={classes.textField} margin='normal' variant='outlined'\n                      onChange={handleChange('description')}\n                      disabled={loading}/>\n                    <FormControl className={classes.selectInput} disabled={loading}>\n                      <InputLabel htmlFor=\"privacy\">Privacy</InputLabel>\n                      <Select native onChange={handleChange('privacy')}>\n                        <option value=\"private\">Private</option>\n                        <option value=\"unlisted\">Unlisted</option>\n                        <option value=\"public\">Public</option>\n                      </Select>\n                    </FormControl>\n                    <div className={classes.buttonWrapper}>\n                      <Button type='submit'\n                        size='large'\n                        color='primary'\n                        variant='text'\n                        disabled={loading}>\n                        Submit\n                      </Button>\n                      {loading && <CircularProgress size={24} className={classes.buttonProgress}/>}\n                    </div>\n                  </form>\n                </Collapse>\n              </List>\n            </ClickAwayListener>\n          </Paper>\n        </Grow>\n      )}\n    </Popper>\n  );\n}\n","import React, {useState, useEffect} from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Paper,\n  Divider,\n  Typography\n} from '@material-ui/core';\nimport {\n} from '@material-ui/icons';\nimport Api from '../apiclient';\nimport {basicRequestCatch} from '../utils';\nimport ResultItemCard from './resultItemCard';\nimport axios from 'axios';\n\nconst useStyles = makeStyles(theme => ({\n  viewerPlaylist: {\n    display: 'flex',\n    flexDirection: 'column',\n    flexGrow: 1\n  },\n  resultItem: {\n    marginTop: theme.spacing.unit\n  },\n  filesList: {\n    overflowY: 'auto'\n  }\n}));\n\nexport default function ViewerPlaylist(props) {\n  const classes = useStyles();\n  let {playlist_id, title:list_title, variant} = props;\n  const [fileIDs, setFileIDs] = useState([]);\n  const [files, setFiles]     = useState([]);\n  let cancel = false;\n\n  useEffect(() => {\n    if(playlist_id) {\n      Api.getData(`playlists/${playlist_id}/files`)\n        .then(res => {\n          console.log('viewerplaylist',res.data.response);\n          let data = res.data.response;\n          let newFileIDs = data.map(p_f_item => {\n            return p_f_item.file_id;\n          });\n          if(!cancel) setFileIDs(newFileIDs);\n        })\n        .catch(basicRequestCatch('viewerplaylist'));\n    }\n\n    return () => {\n      cancel = true;\n    }\n  }, [playlist_id]);\n\n  useEffect(() => {\n    let requests = [];\n    fileIDs.forEach(id => {\n      requests.push(Api.request('get',`files/${id}`));\n    });\n    axios.all(requests)\n      .then(responses => {\n        if(cancel) return;\n        console.log('viewerplaylist get files:',responses);\n        let reqResults = responses.map(res => {\n          console.log(res.data.response);\n          return res.data.response;\n        })\n        console.log(reqResults);\n        setFiles(reqResults);\n      })\n      .catch(basicRequestCatch('viewerplaylist get files'));\n  }, [fileIDs]);\n\n  return (\n    <div className={classes.viewerPlaylist}>\n      <Paper>\n        <Typography variant=\"h6\">{list_title}</Typography>\n        <Divider/>\n        <div className={classes.filesList} styles={{\n          height: variant === 'player' ? 118*3 : '100%' \n        }}>\n          {files.map((file) => {\n            let {file_id, title, username, mimetype} = file;\n            return <ResultItemCard key={`file-${file_id}`}\n                className={classes.resultItem}\n                name={title}\n                owner={username}\n                result_type=\"files\"\n                mimetype={mimetype}\n                id={file_id}\n                playlist_id={playlist_id}\n                variant=\"wide\"/>\n          })}\n        </div>\n      </Paper>\n    </div>\n  )\n}\n\n","import React, {useState, useEffect} from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  List,\n  ListItem,\n  ListItemText,\n  Button,\n  TextField,\n  Divider,\n  Toolbar,\n  Typography,\n  Slide,\n} from '@material-ui/core';\nimport {\n  AccountCircle,\n  Send\n} from '@material-ui/icons';\nimport Api from '../apiclient';\nimport {useAuthCtx} from '../authentication';\nimport {getAuthenticatedUserID} from '../authutils';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    textAlign: 'left'\n  },\n  fileInfo: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'stretch',\n    textAlign: 'left',\n    padding: theme.spacing.unit * 2\n  },\n  header: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n    alignItems: 'end',\n    justifyContent: 'space-between',\n    textAlign: 'left'\n  },\n  details: {\n  },\n  extras: {\n    display: 'grid',\n    gridAutoRows: '1fr',\n    gridAutoFlow: 'column',\n    gridGap: theme.spacing.unit * 2\n  },\n  metrics: {\n  },\n  description: {\n    textAlign: 'left',\n    marginTop: theme.spacing.unit * 2\n  },\n  rating: {\n    marginTop: theme.spacing.unit\n  },\n  rateIcon: {\n    marginRight: theme.spacing.unit * 2\n  },\n  comment: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    textAlign: 'left',\n    marginTop: theme.spacing.unit * 2\n  },\n  comments: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    textAlign: 'left',\n    marginTop: theme.spacing.unit * 2\n  },\n  rightIcon: {\n    marginLeft: theme.spacing.unit,\n  },\n  button: {\n    margin: theme.spacing.unit,\n  },\n  grow: {\n    flexGrow: 1\n  }\n}));\n\n\nexport default function Comments(props) {\n  const classes = useStyles();\n  const fileId = props.file_id;\n  const [commentsChanged, setCommentsChanged] = useState(true);\n  const [isLoggedIn] = useAuthCtx();\n  const [comments, setComments] = useState([]);\n  const initialAlertState = {\n    open: false,\n    title: '',\n    message: ''\n  };\n  const [alertState, setAlertState] = useState(initialAlertState);\n  const initialCommentState = {\n    comment: '',\n  };\n  const [newComment, setNewComment] = useState(initialCommentState)\n\n  let handleDialogButton = (type) => (e) => {\n    switch(type) {\n      case 'close':\n        setAlertState(initialAlertState);\n        break;\n      case 'report':\n        // props.history.push(`mailto:${process.env.REACT_APP_DEV_EMAIL}`);\n        setAlertState(initialAlertState);\n        break;\n      default:\n        break;\n    }\n  };\n\n  let cancel = false;\n\n  function SlideTransition(props) {\n    return <Slide direction='down' {...props}/>;\n  }\n\n  async function sendComment() {\n    if(isLoggedIn) {\n      newComment.file_id = fileId;\n      newComment.user_id = parseInt(getAuthenticatedUserID());\n      console.log('comment uploading', newComment);\n      try {\n        const response = await Api.request('post','/comments/add_comment',newComment,{},true);\n        console.log('comment upload',response);\n        const res = response.data;\n        setCommentsChanged(true);\n        setNewComment(initialCommentState);\n        return res;\n      }\n      catch(err) {\n        console.log('messages send',err);\n        throw err;\n      }\n    }\n  }\n\n  useEffect(() => {\n    if(commentsChanged){\n      Api.request('get',`/comments/${fileId}`)\n        .then(res => {\n          console.log('comments: ',res.data.response);\n          if(!cancel) {\n            setCommentsChanged(false);\n            setComments(res.data.response);\n          }\n        })\n        .catch(err => {\n          let msg = '';\n          let title = '';\n          // got response from server\n          if(err.response) {\n            const { status } = err.response;\n            title = 'Send report?';\n          if (status >= 500 && status < 600) {\n            msg = `Server error ${status}, please contact the admins`;\n          }\n          else if (status === 404) {\n            msg = \"Comments not found\";\n          }\n          else if (status === 403) {\n            msg = \"Comments permission blocked\";\n          }\n          else {\n            msg = `Sorry, unknown error ${status}`;\n          }\n        }\n        // request sent but no response\n        else if(err.request) {\n          title = 'Check connection';\n          msg = 'Could not connect to the server';\n        }\n        // catch all\n        else {\n          title = 'Send report?';\n          msg = 'Sorry, unknown error';\n        }\n        setCommentsChanged(false);\n        console.log('view',err);\n        if(cancel) return;\n        setAlertState({title: title, message: msg, open: true});\n      });\n    }\n\n      return () => {\n        cancel = true;\n      }\n  }, [commentsChanged]);\n\n  const handleChange = prop => event => {\n    setNewComment({ ...newComment, [prop]: event.target.value });\n  };\n\n  return (\n    <div className={classes.root}>\n      <Dialog open={alertState.open}\n        TransitionComponent={SlideTransition}\n        keepMounted\n        onClose={() => setAlertState(initialAlertState)}\n        aria-labelledby=\"alert-title\"\n        aria-describedby=\"alert-description\">\n        <DialogTitle id=\"alert-title\">{alertState.title}</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-description\">{alertState.message}</DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleDialogButton('close')} color=\"primary\">Close</Button>\n          <Button onClick={handleDialogButton('report')} color=\"primary\" variant=\"contained\" autoFocus>Send Report</Button>\n        </DialogActions>\n      </Dialog>\n      <Divider/>\n      <div className={classes.comment}>\n        <TextField\n          id=\"standard-multiline-flexible\"\n          label= {isLoggedIn ? \"Add a public comment. . .\" : \"Please login to comment. . .\"}\n          value={newComment.comment}\n          onChange={handleChange('comment')}\n          multiline\n          rowsMax=\"4\"\n          className={classes.textField}\n          variant=\"outlined\"\n        />\n        <Toolbar>\n          <div className={classes.grow} />\n          <Button color=\"primary\">\n            Cancel\n          </Button>\n          <Button variant=\"contained\" color=\"primary\" className={classes.button} onClick={sendComment}>\n            Comment\n            <Send className={classes.rightIcon}>send</Send>\n          </Button>\n        </Toolbar>\n      </div>\n      <Divider/>\n      {\n        comments.length === 1 ? (\n          <Typography variant=\"body1\">{comments.length+\" comment\"}</Typography>\n        ):\n          <Typography variant=\"body1\">{comments.length+\" comments\"}</Typography>\n      }\n      <div className={classes.comments}>\n        <List>\n          {comments.map((comment) => (\n            <ListItem key={comment.comment_id}>\n              <AccountCircle/>\n              <ListItemText\n                primary={comment.username + \": \" + comment.comment}\n                />\n            </ListItem>\n          ))}\n        </List>\n      </div>\n    </div>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  Slide,\n  Paper,\n  Typography,\n  IconButton,\n  TextField\n} from '@material-ui/core';\nimport {\n  CloudDownload,\n  PlaylistAdd,\n  ThumbUp,\n  ThumbDown,\n  Edit\n} from '@material-ui/icons';\nimport {\n  Link\n} from 'react-router-dom';\nimport Player from '../components/player';\nimport PlaylistMenu from '../components/playlistmenu';\nimport ViewerPlaylist from '../components/viewerplaylist';\nimport Comments from '../components/comments';\nimport Api from '../apiclient';\nimport { saveAs } from 'file-saver';\nimport {useAuthCtx} from '../authentication';\nimport {getAuthenticatedUserID} from '../authutils';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    textAlign: 'left'\n  },\n  fileInfo: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'stretch',\n    textAlign: 'left',\n    padding: theme.spacing.unit * 2\n  },\n  header: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n    alignItems: 'end',\n    justifyContent: 'space-between',\n    textAlign: 'left'\n  },\n  details: {\n  },\n  extras: {\n    display: 'grid',\n    gridAutoRows: '1fr',\n    gridAutoFlow: 'column',\n    gridGap: theme.spacing.unit * 2\n  },\n  metrics: {\n  },\n  description: {\n    textAlign: 'left',\n    marginTop: theme.spacing.unit * 2\n  },\n  rating: {\n    marginTop: theme.spacing.unit\n  },\n  rateIcon: {\n    marginRight: theme.spacing.unit * 2\n  },\n  rightIcon: {\n    marginLeft: theme.spacing.unit,\n  },\n  button: {\n    margin: theme.spacing.unit,\n  },\n  grow: {\n    flexGrow: 1\n  },\n  editForm: {\n    display: 'flex',\n    flexDirection: 'column'\n  }\n}));\n\nfunction SlideTransition(props) {\n  return <Slide direction='down' {...props}/>;\n}\n\nconst initialAlertState = {\n  open: false,\n  title: '',\n  message: ''\n};\n\nexport default function ViewPage(props) {\n  const classes = useStyles();\n  const [isLoggedIn] = useAuthCtx();\n  const params = new URLSearchParams(props.location.search);\n  const [playlistID, setPlaylistID] = useState(params.get('playlist') || null);\n  const [fileInfo, setFileInfo] = useState({file_id:props.match.params.id});\n  const [alertState, setAlertState] = useState(initialAlertState);\n  \n  const [plistMenuAnchor, setPlistMenuAnchor] = useState(null);\n\n  const initialEditState = {open:false,loading:false,error:{}};\n  const [editState, setEditState] = useState(initialEditState);\n  const [editInputs, setEditInputs] = useState({title:'',description:'',permissions:''});\n\n  let cancel = false;\n\n  useEffect(() => {\n    const newParams = new URLSearchParams(props.location.search);\n    const newPlaylistID = newParams.get('playlist') || null;\n    if(newPlaylistID !== playlistID) setPlaylistID(newPlaylistID);\n\n    let id = props.match.params.id;\n    Api.request('get',`/files/${id}`)\n      .then(res => {\n        if(!cancel) {\n          setFileInfo(res.data.response);\n          let {title, description, permissions} = res.data.response;\n          setEditInputs({title,description,permissions});\n        }\n      })\n      .catch(err => {\n        let msg = '';\n        let title = '';\n        // got response from server\n        if(err.response) {\n          const { status } = err.response;\n          title = 'Send report?';\n          if (status >= 500 && status < 600) {\n            msg = `Server error ${status}, please contact the admins`;\n          }\n          else if (status === 404) {\n            msg = \"File not found\";\n          }\n          else if (status === 403) {\n            msg = \"File permission blocked\";\n          }\n          else {\n            msg = `Sorry, unknown error ${status}`;\n          }\n        }\n        // request sent but no response\n        else if(err.request) {\n          title = 'Check connection';\n          msg = 'Could not connect to the server';\n        }\n        // catch all\n        else {\n          title = 'Send report?';\n          msg = 'Sorry, unknown error';\n        }\n        console.log('view',err);\n        if(cancel) return;\n        setAlertState({title: title, message: msg, open: true});\n        setFileInfo({file_id:id});\n      });\n\n      return () => {\n        cancel = true;\n      }\n  }, [props]);\n\n  useEffect(() => {\n    if(editState.loading) {\n      Api.request('patch',`files/${fileInfo.file_id}`,editInputs,{},true)\n        .then(res => {\n          if(cancel) return;\n          setFileInfo({...fileInfo,...res.data.response});\n          setEditInputs(res.data.response);\n          setEditState(initialEditState);\n        })\n        .catch(err => {\n          let msg = '';\n          // got response from server\n          if(err.response) {\n            const { status } = err.response;\n            if (status >= 500 && status < 600) {\n              msg = `Server error ${status}, please contact the admins`;\n            }\n            else if (status === 404) {\n              msg = \"File not found\";\n            }\n            else if (status === 401) {\n              msg = \"Not allowed\";\n            }\n            // else if (status === 400) {\n            //   let {error} = err.response.data;\n            //   if(error['not unique']) {\n            //     error['not unique'].forEach((tag) => {\n            //       err[tag+'Error'] = true;\n            //       err[tag+'ErrorMsg'] = 'Must be unique';\n            //     });\n            //   }\n            //   else msg = err.error;\n            // }\n            else {\n              msg = `Sorry, unknown error ${status}`;\n            }\n          }\n          // request sent but no response\n          else if(err.request) {\n            msg = 'Could not connect to the server';\n          }\n          // catch all\n          else {\n            msg = 'Sorry, unknown error';\n          }\n          if(cancel) return;\n          setEditState({open:true,loading:false,error:{...err,message:msg}});\n        });\n    }\n  }, [editState]);\n\n  let openPlaylistMenu = (e) => {\n    setPlistMenuAnchor(e.currentTarget);\n  };\n  let closePlistMenu = () => {\n    setPlistMenuAnchor(null);\n  };\n\n  let downloadFile = () => {\n    saveAs(`${Api.baseURL}/files/${fileInfo.file_id}/g`,fileInfo.title);\n  };\n\n  let handleDialogButton = (type) => (e) => {\n    switch(type) {\n      case 'close':\n        setAlertState(initialAlertState);\n        break;\n      case 'report':\n        // props.history.push(`mailto:${process.env.REACT_APP_DEV_EMAIL}`);\n        setAlertState(initialAlertState);\n        break;\n      default:\n        break;\n    }\n  };\n\n  let openEditDialog = () => {\n    setEditState({...initialEditState,open:true});\n  };\n  let closeEditDialog = () => {\n    setEditState(initialEditState);\n  };\n  let handleEditChange = (key) => (e) => {\n    setEditInputs({...editInputs,[key]:e.currentTarget.value});\n  };\n  let handleEditSubmit = (e) => {\n    e.preventDefault();\n    if(!editState.loading) {\n      setEditState({...editState, loading: true});\n    }\n  }\n\n  const { title, user_id, username, description, upload_date, views, upvotes, downvotes, permissions } = fileInfo;\n\n  const isPlistMenuOpen = Boolean(plistMenuAnchor);\n\n  let extras = [];\n  if(isLoggedIn) {\n    extras.push(\n      <IconButton key='playlist-add' aria-label=\"Add to Playlist\" onClick={openPlaylistMenu}>\n        <PlaylistAdd />\n      </IconButton>\n    );\n    if(getAuthenticatedUserID() === String(user_id)) {\n      extras.push(\n        <IconButton key='edit-file' aria-label=\"Edit file\" onClick={openEditDialog}>\n          <Edit />\n        </IconButton>\n      )\n    }\n  }\n\n  return (\n    <div className={classes.container}>\n      <Dialog open={alertState.open}\n          TransitionComponent={SlideTransition}\n          keepMounted\n          onClose={() => setAlertState(initialAlertState)}\n          aria-labelledby=\"alert-title\"\n          aria-describedby=\"alert-description\">\n        <DialogTitle id=\"alert-title\">{alertState.title}</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-description\">{alertState.message}</DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleDialogButton('close')} color=\"primary\">Close</Button>\n          <Button onClick={handleDialogButton('report')} color=\"primary\" variant=\"contained\" autoFocus>Send Report</Button>\n        </DialogActions>\n      </Dialog>\n      <Dialog open={editState.open}\n          TransitionComponent={SlideTransition}\n          keepMounted\n          onClose={closeEditDialog}\n          aria-labelledby=\"edit-title\">\n        <DialogTitle id=\"edit-title\">Edit File</DialogTitle>\n        <form className={classes.editFormWrap} onSubmit={handleEditSubmit}>\n          <DialogContent className={classes.editForm}>\n            <Typography variant=\"body1\" color=\"error\">\n              {editState.error.message}\n            </Typography>\n            <TextField id='title' label='Title' type='text' required={true}\n              className={classes.textField} margin='normal' variant='outlined'\n              onChange={handleEditChange('title')}\n              disabled={editState.loading}\n              value={editInputs.title || title || ''}\n              autoFocus\n              error={editState.error['titleError']}\n              helperText={editState.error['titleErrorMsg']}/>\n            <TextField id='description' label='Description' type='text' required={true}\n              className={classes.textField} margin='normal' variant='outlined' multiline\n              onChange={handleEditChange('description')}\n              disabled={editState.loading}\n              value={editInputs.description || description || ''}\n              error={editState.error['descriptionError']}\n              helperText={editState.error['descriptionErrorMsg']}/>\n            <TextField id='permissions' label='Permissions' type='text' required={true}\n              className={classes.textField} margin='normal' variant='outlined'\n              onChange={handleEditChange('permissions')}\n              disabled={editState.loading}\n              value={editInputs.permissions || permissions || ''}\n              error={editState.error['permissionsError']}\n              helperText={editState.error['permissionsErrorMsg']}/>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={closeEditDialog} color=\"primary\">Cancel</Button>\n            <Button type=\"submit\" color=\"primary\" variant=\"contained\" disabled={editState.loading}>Save</Button>\n          </DialogActions>\n        </form>\n      </Dialog>\n      <Player {...fileInfo}/>\n      <ViewerPlaylist playlist_id={playlistID} />\n      <Paper>\n        <div className={classes.fileInfo}>\n          <div className={classes.header}>\n            <div className={classes.details}>\n              <Typography variant=\"h6\">{title}</Typography>\n              <Typography variant=\"body1\" component={Link} to={`/channel/${user_id}`} style={{textDecoration: 'none'}}>{username}</Typography>\n              <Typography variant=\"body1\">{upload_date}</Typography>\n            </div>\n            <div className={classes.extras}>\n              <div className={classes.toolbar}>\n                { extras }\n                <IconButton aria-label=\"Download\" onClick={downloadFile}>\n                  <CloudDownload />\n                </IconButton>\n              </div>\n              <div className={classes.metrics}>\n                <Typography variant=\"body1\">{`${typeof(views) === \"number\" ? views : \"?\"} views`}</Typography>\n                <div className={classes.rating}>\n                  <Typography variant=\"body1\"><ThumbUp className={classes.rateIcon}/>{`${typeof(upvotes) === \"number\" ? upvotes : \"?\"}`}</Typography>\n                  <Typography variant=\"body1\"><ThumbDown className={classes.rateIcon}/>{`${typeof(downvotes) === \"number\" ? downvotes : \"?\"}`}</Typography>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className={classes.description}>\n            <Typography variant=\"body1\">{description}</Typography>\n          </div>\n          <Comments file_id={props.match.params.id}/>\n        </div>\n      </Paper>\n      <PlaylistMenu file_id={fileInfo.file_id} anchorEl={plistMenuAnchor} open={isPlistMenuOpen} onClose={closePlistMenu}/>\n    </div>\n  );\n}\n","import React, {useState, useEffect} from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  Slide,\n  Typography,\n  IconButton,\n  TextField\n} from '@material-ui/core';\nimport {\n  Edit\n} from '@material-ui/icons';\nimport {\n  Link\n} from 'react-router-dom'\nimport ViewerPlaylist from '../components/viewerplaylist';\nimport Api from '../apiclient';\nimport {basicRequestCatch} from '../utils';\nimport {useAuthCtx} from '../authentication';\nimport {getAuthenticatedUserID} from '../authutils';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'row',\n    textAlign: 'left'\n  },\n  playlistInfo: {\n    width: 300\n  },\n  filesList: {\n    flexGrow: 1\n  },\n  extras: {\n    display: 'grid',\n    gridAutoRows: '1fr',\n    gridAutoFlow: 'column',\n    gridGap: theme.spacing.unit * 2\n  },\n  metrics: {\n  },\n  editForm: {\n    display: 'flex',\n    flexDirection: 'column'\n  }\n}));\n\nfunction SlideTransition(props) {\n  return <Slide direction='down' {...props}/>;\n}\n\nexport default function PlaylistPage(props) {\n  const classes = useStyles();\n  const [isLoggedIn] = useAuthCtx();\n  const [playlistInfo,setPlaylistInfo] = useState({playlist_id:props.match.params.id});\n\n  const initialEditState = {open:false,loading:false,error:{}};\n  const [editState, setEditState] = useState(initialEditState);\n  const [editInputs, setEditInputs] = useState({title:'',description:''});\n\n  let cancel = false;\n\n  useEffect(() => {\n    let id = props.match.params.id;\n    Api.request('get',`/playlists/${id}`)\n      .then(res => {\n        if(!cancel) {\n          setPlaylistInfo(res.data.response);\n          let {title,description} = res.data.response;\n          setEditInputs({title,description});\n        }\n      })\n      .catch(basicRequestCatch('playlist'));\n  }, [props]);\n\n  useEffect(() => {\n    if(editState.loading) {\n      console.log(editInputs)\n      Api.request('patch',`playlists/${playlistInfo.playlist_id}`,editInputs,{},true)\n        .then(res => {\n          if(cancel) return;\n          setPlaylistInfo({...playlistInfo,...res.data.response});\n          setEditInputs(res.data.response);\n          setEditState(initialEditState);\n        })\n        .catch(err => {\n          let msg = '';\n          // got response from server\n          if(err.response) {\n            const { status } = err.response;\n            if (status >= 500 && status < 600) {\n              msg = `Server error ${status}, please contact the admins`;\n            }\n            else if (status === 404) {\n              msg = \"Playlist not found\";\n            }\n            else if (status === 401) {\n              msg = \"Not allowed\";\n            }\n            else {\n              msg = `Sorry, unknown error ${status}`;\n            }\n          }\n          // request sent but no response\n          else if(err.request) {\n            msg = 'Could not connect to the server';\n          }\n          // catch all\n          else {\n            msg = 'Sorry, unknown error';\n          }\n          if(cancel) return;\n          setEditState({open:true,loading:false,error:{...err,message:msg}});\n        });\n    }\n  }, [editState]);\n\n  let openEditDialog = () => {\n    setEditState({...initialEditState,open:true});\n  };\n  let closeEditDialog = () => {\n    setEditState(initialEditState);\n  };\n  let handleEditChange = (key) => (e) => {\n    setEditInputs({...editInputs,[key]:e.currentTarget.value});\n  };\n  let handleEditSubmit = (e) => {\n    e.preventDefault();\n    if(!editState.loading) {\n      setEditState({...editState, loading: true});\n    }\n  }\n\n  const {title,playlist_id,description,username,user_id} = playlistInfo;\n\n  let extras = [];\n  if(isLoggedIn) {\n    // TODO: maybe allow user copy other user's playlist, just link or full copy?\n    // extras.push(\n    //   <IconButton key='playlist-add' aria-label=\"Add to Playlist\" onClick={openPlaylistMenu}>\n    //     <PlaylistAdd />\n    //   </IconButton>\n    // );\n    if(getAuthenticatedUserID() === String(user_id)) {\n      extras.push(\n        <IconButton key='edit-playlist' aria-label=\"Edit playlist\" onClick={openEditDialog}>\n          <Edit />\n        </IconButton>\n      )\n    }\n  }\n\n  return (\n    <div className={classes.container}>\n      <div className={classes.playlistInfo}>\n        <Typography variant=\"h5\">{title}</Typography>\n        <Typography variant=\"h6\" component={Link} to={`/channel/${user_id}`} style={{textDecoration: 'none'}}>{username}</Typography>\n        <div className={classes.extras}>\n          <div className={classes.toolbar}>\n            { extras }\n          </div>\n          {/* <div className={classes.metrics}>\n            <Typography variant=\"body1\">{`${typeof(views) === \"number\" ? views : \"?\"} views`}</Typography>\n            <div className={classes.rating}>\n              <Typography variant=\"body1\"><ThumbUp className={classes.rateIcon}/>{`${typeof(upvotes) === \"number\" ? upvotes : \"?\"}`}</Typography>\n              <Typography variant=\"body1\"><ThumbDown className={classes.rateIcon}/>{`${typeof(downvotes) === \"number\" ? downvotes : \"?\"}`}</Typography>\n            </div>\n          </div> */}\n        </div>\n        <Typography variant=\"body1\">{description}</Typography>\n      </div>\n      <ViewerPlaylist playlist_id={playlist_id}/>\n      <Dialog open={editState.open}\n          TransitionComponent={SlideTransition}\n          keepMounted\n          onClose={closeEditDialog}\n          aria-labelledby=\"edit-title\">\n        <DialogTitle id=\"edit-title\">Edit Playlist</DialogTitle>\n        <form className={classes.editFormWrap} onSubmit={handleEditSubmit}>\n          <DialogContent className={classes.editForm}>\n            <Typography variant=\"body1\" color=\"error\">\n              {editState.error.message}\n            </Typography>\n            <TextField id='title' label='Title' type='text' required={true}\n              className={classes.textField} margin='normal' variant='outlined'\n              onChange={handleEditChange('title')}\n              disabled={editState.loading}\n              value={editInputs.title || title || ''}\n              autoFocus\n              error={editState.error['titleError']}\n              helperText={editState.error['titleErrorMsg']}/>\n            <TextField id='description' label='Description' type='text' required={true}\n              className={classes.textField} margin='normal' variant='outlined' multiline\n              onChange={handleEditChange('description')}\n              disabled={editState.loading}\n              value={editInputs.description || description || ''}\n              error={editState.error['descriptionError']}\n              helperText={editState.error['descriptionErrorMsg']}/>\n            {/* <TextField id='permissions' label='Permissions' type='text' required={true}\n              className={classes.textField} margin='normal' variant='outlined'\n              onChange={handleEditChange('permissions')}\n              disabled={editState.loading}\n              value={editInputs.permissions || permissions || ''}\n              error={editState.error['permissionsError']}\n              helperText={editState.error['permissionsErrorMsg']}/> */}\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={closeEditDialog} color=\"primary\">Cancel</Button>\n            <Button type=\"submit\" color=\"primary\" variant=\"contained\" disabled={editState.loading}>Save</Button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </div>\n  );\n}\n\n","import React, {useState, useEffect} from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Typography,\n  IconButton,\n  TextField\n} from '@material-ui/core';\nimport {\n  Edit,\n  Check,\n  Close\n} from '@material-ui/icons';\nimport Api from '../apiclient';\nimport {basicRequestCatch} from '../utils';\nimport {useAuthCtx} from '../authentication';\nimport {getAuthenticatedUserID} from '../authutils';\n\nconst useStyles = makeStyles(theme => ({\n  about: {\n    textAlign: 'left'\n  },\n  headerWrap: {\n    display: 'flex'\n  },\n  headerTitle: {\n    flexGrow: 1\n  },\n  extras: {\n    display: 'grid',\n    gridAutoRows: '1fr',\n    gridAutoFlow: 'column',\n    gridGap: theme.spacing.unit * 2\n  },\n  editForm: {\n    display: 'flex',\n    flexDirection: 'column'\n  }\n}));\n\nexport default function AboutPage(props) {\n  const classes = useStyles();\n  const [isLoggedIn] = useAuthCtx();\n  const {userID} = props;\n  const [description, setDescription] = useState('');\n\n  const canEdit = isLoggedIn && getAuthenticatedUserID() === String(userID);\n  const initialEditState = {active:false,loading:false,error:{}};\n  const [editState, setEditState] = useState(initialEditState);\n  const [newDescription, setNewDescription] = useState('');\n  let cancel = false;\n\n  useEffect(() => {\n    Api.request('get',`/users/${userID}` )\n      .then(res =>{\n        if(cancel) return;\n        let {channel_description=''} = res.data.response;\n        setDescription(channel_description);\n        setNewDescription(channel_description);\n      })\n      .catch(basicRequestCatch('about'));\n  }, [props]);\n\n  useEffect(() => {\n    if(editState.loading) {\n      Api.request('patch',`/users/${userID}`,{channel_description:newDescription},{},true)\n        .then(res => {\n          if(cancel) return;\n          let {channel_description=''} = res.data.response;\n          setDescription(channel_description);\n          setNewDescription(channel_description);\n          setEditState(initialEditState);\n        })\n        .catch(err => {\n          let msg = '';\n          // got response from server\n          if(err.response) {\n            const { status } = err.response;\n            if (status >= 500 && status < 600) {\n              msg = `Server error ${status}, please contact the admins`;\n            }\n            else if (status === 404) {\n              msg = \"User not found\";\n            }\n            else if (status === 401) {\n              msg = \"Not allowed\";\n            }\n            else {\n              msg = `Sorry, unknown error ${status}`;\n            }\n          }\n          // request sent but no response\n          else if(err.request) {\n            msg = 'Could not connect to the server';\n          }\n          // catch all\n          else {\n            msg = 'Sorry, unknown error';\n          }\n          if(cancel) return;\n          setEditState({active:true,loading:false,error:{...err,message:msg}});\n        });\n    }\n  }, [editState]);\n\n  let activateEdit = () => {\n    setEditState({...initialEditState,active:true});\n  }\n  let deactivateEdit = () => {\n    setEditState({...initialEditState});\n  }\n  let saveEdits = () => {\n    setEditState({...editState,loading:true});\n  }\n  let handleEditChange = (e) => {\n    setNewDescription(e.currentTarget.value);\n  }\n  \n  let extras = [];\n  if(canEdit) {\n    if(editState.active) {\n      extras.push(\n        <IconButton key='edit-cancel' aria-label=\"Cancel\" onClick={deactivateEdit}>\n          <Close />\n        </IconButton>\n      );\n      extras.push(\n        <IconButton key='edit-save' aria-label=\"Save\" onClick={saveEdits}>\n          <Check />\n        </IconButton>\n      );\n    }\n    else {\n      extras.push(\n        <IconButton key='edit-description' aria-label=\"Edit Description\" onClick={activateEdit}>\n          <Edit />\n        </IconButton>\n      );\n    }\n  }\n\n  return (\n    <div className={classes.about}>\n      <div className={classes.headerWrap}>\n        <Typography variant=\"h6\" className={classes.headerTitle}>Description</Typography>\n        <div className={classes.extras}>\n          {extras}\n        </div>\n      </div>\n      {editState.active ? (\n          <div className={classes.editForm}>\n            <Typography variant=\"body1\" color=\"error\">\n              {editState.error.message}\n            </Typography>\n            <TextField id='description' label='Description' type='text' required={true}\n              className={classes.textField} margin='normal' multiline\n              onChange={handleEditChange}\n              disabled={editState.loading}\n              value={newDescription || ''}\n              autoFocus/>\n          </div>\n        ) : (\n          <Typography variant=\"body1\">{description || 'No description'}</Typography>\n        )\n      }\n    </div>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Typography,\n  Divider\n} from '@material-ui/core';\nimport {\n\n} from '@material-ui/icons';\nimport Api from '../apiclient';\n// import { getAuthenticatedUserID } from '../authutils';\nimport { basicRequestCatch } from '../utils';\nimport ResultItemCard from '../components/resultItemCard';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  header: {\n\n  },\n  sectionTitle: {\n    marginBottom: 4\n  },\n  itemsGrid: {\n    display: 'grid',\n    gridTemplateColumns: 'repeat(auto-fit, 210px)',\n    gridColumnGap: theme.spacing.unit,\n    gridRowGap: theme.spacing.unit\n  },\n  resultItem: {\n    marginBottom: theme.spacing.unit\n  }\n}));\n\nexport default function ChannelPlaylistsPage(props) {\n  const classes = useStyles();\n  const [playlists, setPlaylistsInfo] = useState([]);\n  let {userID} = props;\n  // let canEdit = userID === getAuthenticatedUserID(); TODO: allows create, select and delete\n  let cancel = false;\n\n  useEffect(() => {\n    Api.getData('playlists',null,[{column:'user_id',value:userID,cmp:'exact'}])\n      .then(res => {\n        console.log('playlists get',res);\n        if(!cancel) setPlaylistsInfo(res.data.response);\n      })\n      .catch(basicRequestCatch('playlists get'));\n\n    return () => {\n      cancel = true;\n    };\n  }, []);\n\n  return (\n    <div className={classes.container}>\n      <div className={classes.header}>\n      </div>\n      <Divider/>\n      <Typography variant=\"h5\" className={classes.sectionTitle}>\n        Created Playlists\n      </Typography>\n      <div className={classes.itemsGrid}>\n        <ResultItemCard key={`playlist-favorites`}\n          className={classes.resultItem}\n          name=\"Favorites\"\n          result_type=\"favorites\"\n          id={userID}\n          variant=\"small\"/>\n        {playlists.map(playlist => {\n          let {playlist_id,title,username} = playlist;\n          return <ResultItemCard key={`playlist-${playlist_id}`}\n            className={classes.resultItem}\n            name={title}\n            owner={username}\n            result_type=\"playlists\"\n            id={playlist_id}\n            variant=\"small\"/>\n        })}\n      </div>\n    </div>\n  );\n}\n\n","import React, {useState, useEffect} from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {\n  Typography,\n  Divider,\n  Menu,\n  MenuItem,\n  Button\n} from '@material-ui/core';\nimport {\n  Sort\n} from '@material-ui/icons';\nimport Api from '../apiclient';\n// import { getAuthenticatedUserID } from '../authutils';\nimport { basicRequestCatch } from '../utils';\nimport ResultItemCard from '../components/resultItemCard';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'left'\n  },\n  header: {\n\n  },\n  optionsTitle: {\n    fontSize: 15,\n    fontWeight: theme.typography.fontWeightRegular,\n    marginLeft: theme.spacing.unit\n  },\n  sectionTitle: {\n    marginBottom: 4\n  },\n  itemsGrid: {\n    display: 'grid',\n    gridTemplateColumns: 'repeat(auto-fit, 210px)',\n    gridColumnGap: theme.spacing.unit,\n    gridRowGap: theme.spacing.unit\n  },\n  resultItem: {\n    marginBottom: theme.spacing.unit\n  }\n}));\n\nexport default function ChannelFavoritesPage(props) {\n  const classes = useStyles();\n  const [files, setFilesInfo] = useState([]);\n  const [sortMenuAnchor, setSortMenuAnchor] = useState(null);\n  let {userID} = props;\n  // let canEdit = userID === getAuthenticatedUserID();\n  let cancel = false;\n\n  useEffect(() => {\n    Api.request('get',`users/${userID}/favorites`,{},{},true)\n      .then(res => {\n        if(!cancel) setFilesInfo(res.data.response);\n      })\n      .catch(basicRequestCatch('files get'));\n\n    return () => {\n      cancel = true;\n    };\n  }, []);\n\n  let openSortMenu = (e) => {\n    setSortMenuAnchor(e.target);\n  };\n  let closeSortMenu = (e) => {\n    setSortMenuAnchor(null);\n  };\n  let handleSortMenu = (key) => (e) => {\n    let sorter = {\n      column: key,\n      descending: true\n    };\n    Api.getData('files',null,[{column:'user_id',value:userID,cmp:'exact'}],[sorter])\n      .then(res => {\n        if(!cancel) setFilesInfo(res.data.response);\n      })\n      .catch(basicRequestCatch('files get'));\n    closeSortMenu();\n  };\n\n  let isSortMenuOpen = Boolean(sortMenuAnchor);\n  \n  let sortMenu = (\n    <Menu anchorEl={sortMenuAnchor} open={isSortMenuOpen} onClose={closeSortMenu}>\n      <MenuItem key='views' onClick={handleSortMenu('views')}>Most Views</MenuItem>\n      <MenuItem key='likes' onClick={handleSortMenu('upvotes')}>Most Likes</MenuItem>\n    </Menu>\n  );\n\n  return (\n    <div className={classes.container}>\n      <div className={classes.header}>\n        <Button variant=\"text\" onClick={openSortMenu}>\n          <Sort /><Typography className={classes.optionsTitle}>Sort</Typography>\n        </Button>\n      </div>\n      <Divider/>\n      <Typography variant=\"h5\" className={classes.sectionTitle}>\n        Favorites\n      </Typography>\n      <div className={classes.itemsGrid}>\n        {files.length > 0 ? files.map((fileInfo) => {\n          let {file_id,title,mimetype,username} = fileInfo;\n          return <ResultItemCard key={`file-${file_id}`}\n            className={classes.resultItem}\n            name={title}\n            owner={username}\n            result_type=\"files\"\n            mimetype={mimetype}\n            id={file_id}\n            variant=\"small\"/>\n        }) : \n          <Typography variant=\"h6\">No Favorites</Typography>\n        }\n      </div>\n      {sortMenu}\n    </div>\n  );\n}\n","import React, {useState, useEffect} from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {\n  Typography,\n  Divider,\n  Menu,\n  MenuItem,\n  Button\n} from '@material-ui/core';\nimport {\n  Sort\n} from '@material-ui/icons';\nimport Api from '../apiclient';\n// import { getAuthenticatedUserID } from '../authutils';\nimport { basicRequestCatch } from '../utils';\nimport ResultItemCard from '../components/resultItemCard';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'left'\n  },\n  header: {\n\n  },\n  optionsTitle: {\n    fontSize: 15,\n    fontWeight: theme.typography.fontWeightRegular,\n    marginLeft: theme.spacing.unit\n  },\n  sectionTitle: {\n    marginBottom: 4\n  },\n  itemsGrid: {\n    display: 'grid',\n    gridTemplateColumns: 'repeat(auto-fit, 210px)',\n    gridColumnGap: theme.spacing.unit,\n    gridRowGap: theme.spacing.unit\n  },\n  resultItem: {\n    marginBottom: theme.spacing.unit\n  }\n}));\n\n//TODO: goes in channel page, shows all files uploaded by channel's user (not current logged in user) with some sort (maybe also folder/group organization) controls\n\nexport default function ChannelFilesPage(props) {\n  const classes = useStyles();\n  const [files, setFilesInfo] = useState([]);\n  const [sortKey, setSortKey] = useState('upload_date');\n  const [sortMenuAnchor, setSortMenuAnchor] = useState(null);\n  let {userID} = props;\n  // let canEdit = userID === getAuthenticatedUserID();\n  let cancel = false;\n\n  useEffect(() => {\n    let sorter = {\n      column: sortKey,\n      descending: true\n    };\n    Api.getData('files',null,[{column:'user_id',value:userID,cmp:'exact'}],[sorter])\n      .then(res => {\n        if(!cancel) setFilesInfo(res.data.response);\n      })\n      .catch(basicRequestCatch('files get'));\n\n    return () => {\n      cancel = true;\n    };\n  }, [sortKey]);\n\n  let openSortMenu = (e) => {\n    setSortMenuAnchor(e.target);\n  };\n  let closeSortMenu = (e) => {\n    setSortMenuAnchor(null);\n  };\n  let handleSortMenu = (key) => (e) => {\n    setSortKey(key);\n    closeSortMenu();\n  };\n\n  let isSortMenuOpen = Boolean(sortMenuAnchor);\n  \n  let sortMenu = (\n    <Menu anchorEl={sortMenuAnchor} open={isSortMenuOpen} onClose={closeSortMenu}>\n      <MenuItem key='upload_date' onClick={handleSortMenu('upload_date')}>Most Recent</MenuItem>\n      <MenuItem key='views' onClick={handleSortMenu('views')}>Most Views</MenuItem>\n      <MenuItem key='likes' onClick={handleSortMenu('upvotes')}>Most Likes</MenuItem>\n    </Menu>\n  );\n\n  return (\n    <div className={classes.container}>\n      <div className={classes.header}>\n        <Button variant=\"text\" onClick={openSortMenu}>\n          <Sort /><Typography className={classes.optionsTitle}>Sort</Typography>\n        </Button>\n      </div>\n      <Divider/>\n      <Typography variant=\"h5\" className={classes.sectionTitle}>\n        Uploaded Files\n      </Typography>\n      <div className={classes.itemsGrid}>\n        {files.length > 0 ? files.map((fileInfo) => {\n          let {file_id,title,mimetype,username} = fileInfo;\n          return <ResultItemCard key={`file-${file_id}`}\n            className={classes.resultItem}\n            name={title}\n            owner={username}\n            result_type=\"files\"\n            mimetype={mimetype}\n            id={file_id}\n            variant=\"small\"/>\n        }) : \n          <Typography variant=\"h6\">No Files</Typography>\n        }\n      </div>\n      {sortMenu}\n    </div>\n  );\n}\n\n","import React, {useState, useEffect} from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {\n  Typography,\n  Divider,\n  Menu,\n  MenuItem,\n  Button,\n  InputBase,\n  // Checkbox\n} from '@material-ui/core';\nimport {\n  Sort\n} from '@material-ui/icons';\nimport Api from '../apiclient';\nimport { getAuthenticatedUserID } from '../authutils';\nimport { basicRequestCatch } from '../utils';\nimport {useAuthCtx} from '../authentication';\nimport ResultItemCard from '../components/resultItemCard';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'left'\n  },\n  header: {\n    display: 'flex',\n    justifyContent: 'space-between'\n  },\n  grow: {\n    flexGrow: 1\n  },\n  optionsTitle: {\n    fontSize: 15,\n    fontWeight: theme.typography.fontWeightRegular,\n    marginLeft: theme.spacing.unit\n  },\n  sectionTitle: {\n    marginBottom: 4\n  },\n  inputRoot: {\n    color: 'inherit'\n  },\n  inputInput: {\n    padding: theme.spacing.unit,\n    paddingRight: 0\n  },\n  itemsGrid: {\n    display: 'grid',\n    gridTemplateColumns: 'repeat(auto-fit, 210px)',\n    gridColumnGap: theme.spacing.unit,\n    gridRowGap: theme.spacing.unit,\n    paddingTop: theme.spacing.unit\n  },\n  resultItem: {\n    marginBottom: theme.spacing.unit\n  }\n}));\n\nexport default function ChannelContactsPage(props) {\n  const classes = useStyles();\n  const [contacts, setContactsInfo] = useState([]);\n  const [sortMenuAnchor, setSortMenuAnchor] = useState(null);\n  const [searchQuery,setSearchQuery] = useState('');\n  let {userID} = props;\n  const [isLoggedIn] = useAuthCtx();\n  let canView = isLoggedIn && userID === getAuthenticatedUserID();\n  // let canEdit = canView;\n  let searchTimer = null;\n  let cancel = false;\n\n  let doSearch = () => {\n    Api.getData(`users/${userID}/contacts`,searchQuery)\n      .then(res => {\n        console.log('contacts get',res);\n        if(cancel) return;\n        setContactsInfo(res.data.response);\n      })\n      .catch(err => {\n        basicRequestCatch('contacts get')(err);\n      });\n  };\n\n  useEffect(() => {\n    if(canView) {\n      clearTimeout(searchTimer);\n      searchTimer = setTimeout(doSearch, 800);\n    }\n\n    return () => {\n      cancel = true;\n    };\n  }, [searchQuery]);\n\n  let handleSearchChange = (e) => {\n    setSearchQuery(e.currentTarget.value);\n  };\n  let catchSearchEnter = (e) => {\n    if(e.key === 'Enter') {\n      e.preventDefault();\n      clearTimeout(searchTimer);\n      doSearch();\n    }\n  }\n\n  let openSortMenu = (e) => {\n    setSortMenuAnchor(e.target);\n  };\n  let closeSortMenu = (e) => {\n    setSortMenuAnchor(null);\n  };\n  let handleSortMenu = (key) => (e) => {\n    let sorter = {\n      column: key,\n      descending: true\n    };\n    Api.getData(`users/${userID}/contacts`,searchQuery,null,[sorter])\n      .then(res => {\n        console.log('contacts get',res);\n        if(!cancel) setContactsInfo(res.data.response);\n      })\n      .catch(basicRequestCatch('contacts get'));\n    closeSortMenu();\n  };\n\n  let isSortMenuOpen = Boolean(sortMenuAnchor);\n  \n  let sortMenu = (\n    <Menu anchorEl={sortMenuAnchor} open={isSortMenuOpen} onClose={closeSortMenu}>\n      <MenuItem key='name' onClick={handleSortMenu('username')}>Username</MenuItem>\n      <MenuItem key='subscribers' onClick={handleSortMenu('subscribed')}>Most Subscribers</MenuItem>\n    </Menu>\n  );\n\n  return (\n    <div className={classes.container}>\n      {canView ? (\n        <>\n          <div className={classes.header}>\n            <Typography variant=\"h5\" className={classes.sectionTitle}>\n              Contacts\n            </Typography>\n            <div className={classes.grow} />\n            <InputBase placeholder=\"Search...\" classes={{\n                root: classes.inputRoot,\n                input: classes.inputInput\n              }}\n              value={searchQuery}\n              onChange={handleSearchChange}\n              onKeyPress={catchSearchEnter}/>\n            <Button variant=\"text\" onClick={openSortMenu}>\n              <Sort /><Typography className={classes.optionsTitle}>Sort</Typography>\n            </Button>\n          </div>\n          <Divider/>\n          <div className={classes.itemsGrid}>\n            {contacts.length !== 0 ? contacts.map((contactInfo) => {\n              let {contacted_id,username} = contactInfo;\n              console.log(contactInfo);\n              return (\n                <ResultItemCard key={`user-${contacted_id}`}\n                  className={classes.resultItem}\n                  name={username}\n                  owner={username}\n                  result_type=\"users\"\n                  id={contacted_id}\n                  variant=\"small\"/>\n              );\n            }) : <Typography variant=\"h6\">No Contacts</Typography>\n            }\n          </div>\n          {sortMenu}\n        </>\n      ) : (\n        <Typography variant=\"h6\">Private Content</Typography>\n      )}\n    </div>\n  );\n}\n\n","import React from 'react';\r\nimport {\r\n  Typography\r\n} from '@material-ui/core';\r\n\r\nexport default function Error404Page() {\r\n  return (\r\n    <div>\r\n      <Typography variant=\"h4\">404 - Page Not Found</Typography>\r\n    </div>\r\n  );\r\n};\r\n","import React, {useState, useEffect} from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  AppBar,\n  Typography,\n  Tabs,\n  Tab,\n  IconButton,\n  Toolbar,\n  Menu,\n  MenuItem,\n  ListItemIcon,\n  ListItemText\n} from '@material-ui/core';\nimport {\n  AccountBox,\n  AccountCircle\n} from '@material-ui/icons';\nimport AboutPage from './about';\nimport ChannelPlaylistsPage from './channelplaylists';\nimport ChannelFavoritesPage from './channelfavorites';\nimport ChannelFilesPage from './channelfiles';\nimport ChannelContactsPage from './channelcontacts';\nimport Error404Page from './pageNotFound';\nimport {\n  Route,\n  Switch,\n  Link\n} from 'react-router-dom';\nimport axios from 'axios';\nimport Api from '../apiclient';\nimport {useAuthCtx} from '../authentication';\nimport {getAuthenticatedUserID, getAccessToken} from '../authutils';\n\nconst useStyles = makeStyles(theme => ({\n  tabbedpage: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.paper,\n  },\n  grow: {\n    flexGrow: 1\n  }\n}));\n\nfunction TabContainer(props) {\n  return (\n    <Typography component=\"div\" style={{ padding: 8 * 3 }}>\n      {props.children}\n    </Typography>\n  );\n}\n\nlet getTabFromPath = (path) => {\n  let pieces = path.split('/');\n  if(pieces.length === 3) return 'about';\n  return pieces[3];\n};\n\nexport default function UserPage(props) {\n  const classes = useStyles();\n  const [tabIndex, setTabIndex] = useState(getTabFromPath(props.location.pathname));\n  const [userID, setUserID] = useState(props.match.params.id);\n  const [userInfo, setUserInfo] = useState({});\n  const [contactMenuAnchor, setContactMenuAnchor] = useState(null);\n  const [isLoggedIn] = useAuthCtx();\n  const [contactPrompt, setContactPrompt] = useState('');\n  const [subscribePrompt, setSubscriberPrompt] = useState('');\n  const [isContact, setIsContact] = useState();\n  const [isSubscriber, setIsSubscriber] = useState();\n  const isContactMenuOpen = Boolean(contactMenuAnchor);\n  let cancel = false;\n  let curPath = props.match.url;\n\n  useEffect(() => {\n    //TODO: test is this is actually needed, maybe click on someone's channel?\n    let id = props.match.params.id;\n    setUserID(id);\n  }, [props]);\n\n  let addRequest = (reqMap, label, request) => {\n    reqMap[label] = request;\n    reqMap['labels'].push(label);\n    reqMap['list'].push(request);\n  };\n\n  useEffect(() => {\n    let requests = {list: [], labels: []};\n    addRequest(requests, 'userInfo', Api.getData(`users/${userID}`));\n    addRequest(requests, 'subscribers', Api.getData(`users/${userID}/subscribers`));\n\n    axios.all(requests.list)\n      .then(responses => {\n        if(cancel) return;\n        console.log('channel get',responses);\n        let data = {};\n        for(let i=0;i<responses.length;++i) {\n          let res = responses[i];\n          let label = requests.labels[i];\n          if (label === 'userInfo') data = {...data, ...res.data.response};\n          else if(label === 'subscribers') data = {...data, subscribers: res.data.response.subscribers};\n        };\n        setUserInfo(data);\n      })\n      .catch(err => {\n        if(cancel) return;\n        let msg = '';\n        // got response from server\n        if(err.response) {\n          const { status } = err.response;\n          if(status === 404) {\n            props.history.push('/userNotFound');\n          }\n          else if (status >= 500 && status < 600) {\n            msg = `Server error ${status}, please contact the admins`;\n          }\n          else {\n            msg = `Sorry, unknown error ${status}`;\n          }\n        }\n        // request sent but no response\n        else if(err.request) {\n          msg = err.message;\n        }\n        // catch all\n        else {\n          msg = 'Sorry, unknown error';\n        }\n        console.log('channel',msg);\n      });\n\n    return () => {\n      cancel = true;\n    }\n  }, [userID, isSubscriber]);\n\n  useEffect(() => {\n    if(isLoggedIn){\n      Api.request('get',`/users/${getAuthenticatedUserID()}/contacts`)\n        .then(res => {\n          if(!cancel) {\n            if(getContacts(res.data.response).indexOf(username)===-1){\n              setIsContact(false);\n              setContactPrompt(\"Add contact.\")\n            }\n            else {\n              setIsContact(true);\n              setContactPrompt(\"Remove contact.\")\n            }\n          }\n        })\n        .catch(err => {\n          let msg = '';\n          // got response from server\n          if(err.response) {\n            console.log(err.response);\n            const { status } = err.response;\n            if (status >= 500 && status < 600) {\n              msg = `Server error ${status}, please contact the admins`;\n            }\n            else if (status === 404) {\n              msg = \"Contacts not found\";\n            }\n            else if (status === 403) {\n              msg = \"Contacts permission blocked\";\n            }\n            else {\n              msg = `Sorry, unknown error ${status}`;\n            }\n          }\n          // request sent but no response\n          else if(err.request) {\n            console.log(err.request);\n            msg = 'Could not connect to the server';\n          }\n          // catch all\n          else {\n            console.log(err);\n            msg = 'Sorry, unknown error';\n          }\n          console.log(msg, err);\n          if(cancel) return; //TODO: set error status message in global app status or in the messages panel\n        });\n      }\n\n      return () => {\n        cancel = true;\n      }\n  }, [isContactMenuOpen]);\n\n  useEffect(() => {\n    if(isLoggedIn){\n      Api.request('get',`/users/${getAuthenticatedUserID()}/subscribers_info`)\n        .then(res => {\n          if(!cancel) {\n            if(getSubscribers(res.data.response).indexOf(username)===-1){\n              setIsSubscriber(false);\n              setSubscriberPrompt(\"Subscribe.\")\n            }\n            else {\n              setIsSubscriber(true);\n              setSubscriberPrompt(\"Unsubscribe.\")\n            }\n          }\n        })\n        .catch(err => {\n          let msg = '';\n          // got response from server\n          if(err.response) {\n            console.log(err.response);\n            const { status } = err.response;\n            if (status >= 500 && status < 600) {\n              msg = `Server error ${status}, please contact the admins`;\n            }\n            else if (status === 404) {\n              msg = \"Subscribers not found\";\n            }\n            else if (status === 403) {\n              msg = \"Subscribers permission blocked\";\n            }\n            else {\n              msg = `Sorry, unknown error ${status}`;\n            }\n          }\n          // request sent but no response\n          else if(err.request) {\n            console.log(err.request);\n            msg = 'Could not connect to the server';\n          }\n          // catch all\n          else {\n            console.log(err);\n            msg = 'Sorry, unknown error';\n          }\n          console.log(msg, err);\n          if(cancel) return; //TODO: set error status message in global app status or in the messages panel\n        });\n      }\n\n      return () => {\n        cancel = true;\n      }\n  }, [isContactMenuOpen]);\n\n  let handleTabChange = (e, newValue) => {\n    setTabIndex(newValue);\n    props.history.push(`${curPath}/${newValue}`);\n  }\n\n  let {username,subscribers} = userInfo;\n\n  let openContactMenu = (e) => {\n    if(userID!==getAuthenticatedUserID()){\n      setContactMenuAnchor(e.currentTarget);\n    }\n  };\n\n  let closeContactMenu = () => {\n    setContactMenuAnchor(null);\n  };\n\n  function toggleIsContact(){\n    if(isContact){\n      removeContact();\n    }\n    else {\n      addContact();\n    }\n    setIsContact(!isContact);\n    closeContactMenu();\n  }\n\n  function toggleIsSubscriber(){\n    if(isSubscriber){\n      unsubscribe();\n    }\n    else {\n      subscribe();\n    }\n    setIsSubscriber(!isSubscriber);\n    closeContactMenu();\n  }\n\n  function getContacts(contactsInfo){\n    let newContacts = [];\n    for(let i=0; i<contactsInfo.length; i++){\n      newContacts.push(contactsInfo[i].username);\n    }\n    return newContacts;\n  }\n\n  function getSubscribers(subscribersInfo){\n    let newSubscribers = [];\n    for(let i=0; i<subscribersInfo.length; i++){\n      newSubscribers.push(subscribersInfo[i].username);\n    }\n    return newSubscribers;\n  }\n\n  async function addContact() {\n    const newContact = {\n      contacting_id: getAuthenticatedUserID(),\n      contacted_id: userID\n    }\n    console.log('adding contact',newContact,getAccessToken());\n    try {\n      const response = await Api.request('link','/users/add_contact',newContact,{},true);\n      console.log('contact add',response);\n      const res = response.data;\n      return res;\n    }\n    catch(err) {\n      console.log('contact add',err);\n      throw err;\n    }\n  }\n\n  async function subscribe() {\n    const newSubscriber = {\n      subscribing_id: getAuthenticatedUserID(),\n      subscribed_id: userID\n    }\n    console.log('adding subscriber',newSubscriber,getAccessToken());\n    try {\n      const response = await Api.request('link','/users/subscribe',newSubscriber,{},true);\n      console.log('subscriber',response);\n      const res = response.data;\n      return res;\n    }\n    catch(err) {\n      console.log('subscriber',err);\n      throw err;\n    }\n  }\n\n  async function removeContact() {\n    const oldContact = {\n      contact_removing_id: getAuthenticatedUserID(),\n      contact_removed_id: userID\n    }\n    console.log('removing contact',oldContact,getAccessToken());\n    try {\n      const response = await Api.request('unlink','/users/remove_contact',oldContact,{},true);\n      console.log('remove contact',response);\n      const res = response.data;\n      return res;\n    }\n    catch(err) {\n      console.log('remove contact',err);\n      throw err;\n    }\n  }\n\n  async function unsubscribe() {\n    const oldSubscriber = {\n      unsubscribing_id: getAuthenticatedUserID(),\n      unsubscribed_id: userID\n    }\n    console.log('removing subscriber',oldSubscriber,getAccessToken());\n    try {\n      const response = await Api.request('unlink','/users/unsubscribe',oldSubscriber,{},true);\n      console.log('remove subscriber',response);\n      const res = response.data;\n      return res;\n    }\n    catch(err) {\n      console.log('remove subscriber',err);\n      throw err;\n    }\n  }\n\n  const contactMenu = (\n    <Menu anchorEl={contactMenuAnchor} open={isContactMenuOpen} onClose={closeContactMenu} >\n      {\n        isLoggedIn ? [\n          <MenuItem key={'toggleContact'} onClick={() => toggleIsContact()}>{contactPrompt}</MenuItem>,\n          <MenuItem key={'toggleSubscribe'} onClick={() => toggleIsSubscriber()}>{subscribePrompt}</MenuItem>\n        ] : (\n          <MenuItem component={Link} to='/login'>\n            <ListItemText inset primary=\"Please login to contact.\" />\n            <ListItemIcon>\n              <AccountCircle/>\n            </ListItemIcon>\n          </MenuItem>\n        )\n      }\n    </Menu>\n  );\n\n  return (\n    <div>\n      <div className={classes.header}>\n        <Typography variant='h5'>{username}</Typography>\n        {\n          subscribers === 1 ? (\n            <Typography variant='body1'>{subscribers} subscriber</Typography>\n          ):\n            <Typography variant='body1'>{subscribers} subscribers</Typography>\n        }\n      </div>\n      <div className={classes.tabbedpage}>\n        <AppBar position=\"static\">\n          <Toolbar>\n            <Tabs value={tabIndex} onChange={handleTabChange}>\n              <Tab label=\"About\" value=\"about\"/>\n              <Tab label=\"Files\" value=\"files\"/>\n              <Tab label=\"Playlists\" value=\"playlists\"/>\n              <Tab label=\"Contacts\" value=\"contacts\"/>\n            </Tabs>\n            <div className={classes.grow} />\n            <IconButton color=\"inherit\" aria-haspopup=\"true\" onClick={openContactMenu}>\n              <AccountBox />\n            </IconButton>\n          </Toolbar>\n        </AppBar>\n        <TabContainer>\n          <Switch>\n            <Route path={`${props.match.path}/`} exact render={() => <AboutPage userID={userID} />}/>\n            <Route path={`${props.match.path}/about`} render={() => <AboutPage userID={userID} />}/>\n            <Route path={`${props.match.path}/files`} render={() => <ChannelFilesPage userID={userID} />}/>\n            <Route path={`${props.match.path}/playlists/favorites`} render={() => <ChannelFavoritesPage userID={userID} />}/>\n            <Route path={`${props.match.path}/playlists`} render={() => <ChannelPlaylistsPage userID={userID} />}/>\n            <Route path={`${props.match.path}/contacts`} render={() => <ChannelContactsPage userID={userID} />}/>\n            <Route component={Error404Page}/>\n          </Switch>\n        </TabContainer>\n      </div>\n      {contactMenu}\n    </div>\n  );\n}\n","import React, {useState, useEffect, useReducer} from 'react';\nimport classNames from 'classnames';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Paper,\n  TextField,\n  Typography,\n  Button,\n  CircularProgress,\n} from '@material-ui/core';\nimport {\n  blue,\n  green\n} from '@material-ui/core/colors';\nimport {\n  CloudUpload, CloudDone\n} from '@material-ui/icons';\nimport Api from '../apiclient';\nimport { useAuthCtx } from '../authentication';\nimport { getAuthenticatedUserID } from '../authutils';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center'\n  },\n  formWrapper: {\n    minWidth: '80%'\n  },\n  form: {\n    display: 'grid',\n    gridTemplateColumns: '1fr 1fr',\n    gridGap: theme.spacing.unit * 2,\n    padding: theme.spacing.unit * 2,\n    [theme.breakpoints.down('xs')]: {\n      display: 'grid',\n      gridTemplateColumns: '1fr',\n      gridTemplateRows: '1fr 1fr'\n    }\n  },\n  fileUploadWrapper: {\n    width: '100%',\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'center',\n    cursor: 'pointer',\n    backgroundColor: theme.background,\n    color: theme.primary,\n    border: `4px dashed ${theme.primary}`,\n    '&:hover': {\n      backgroundColor: theme.secondary,\n      color: theme.background,\n      border: `4px dashed ${theme.accent}`\n    }\n  },\n  fileUploadChildren: {\n    pointerEvents: 'none'\n  },\n  fileDragOver: {\n    backgroundColor: theme.secondary,\n    color: theme.background,\n    border: `4px dashed ${theme.accent}`\n  },\n  fileUploadIcon: {\n    fontSize: '5em'\n  },\n  fileUpload: {\n    visibility: 'hidden'\n  },\n  formTextFields: {\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  errorMessage: {\n    textTransform: 'capitalize'\n  },\n  buttonWrapper: {\n    margin: theme.spacing.unit,\n    position: 'relative'\n  },\n  buttonSuccess: {\n    backgroundColor: green[500],\n    '&:hover': {\n      backgroundColor: green[700]\n    }\n  },\n  buttonProgress: {\n    color: blue[500],\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    marginTop: -12,\n    marginLeft: -12\n  }\n}));\n\nconst initialReqState = {\n  loading: false,\n  success: false\n};\nconst reqStateReducer = (state, action) => {\n  switch(action) {\n    case 'submit':\n      return {\n        loading: true,\n        success: false\n      }\n    case 'success':\n      return {\n        loading: false,\n        success: true\n      }\n    case 'error':\n    case 'initial':\n      return initialReqState;\n    default:\n      return state;\n  }\n};\n\nexport default function UploadPage(props) {\n  const classes = useStyles();\n  const [isLoggedIn] = useAuthCtx();\n  const [file, setFile] = useState(null);\n  const [dragOver, setDragOver] = useState(false);\n  const [reqState, reqStateDispatch] = useReducer(reqStateReducer,initialReqState);\n  const [errorMessage, setErrorMessage] = useState(null);\n  const [inputs, setInputs] = useState({file_type:'', user_id:'', title:'', description:'', keywords:'', categories:''});\n  let timer = null;\n  let cancel = false;\n\n  let handleFile = (newFile) => {\n    console.log('got file',newFile);\n    if(newFile) {\n      setFile(newFile);\n      let {name:filename} = newFile;\n      let basename = filename.slice(0,filename.lastIndexOf('.'));\n      let {title} = inputs;\n      setInputs({...inputs, file_type:newFile.type, title: title || basename});\n      document.getElementById('title').select();\n    }\n  };\n  let handleFileSelect = (e) => {\n    handleFile(e.currentTarget.files[0]);\n  };\n  let handleFileDrop = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragOver(false);\n    if(e.dataTransfer.items) {\n      let item = e.dataTransfer.items[0];\n      if(item.kind === 'file') {\n        console.log('items drag');\n        document.getElementById('fileUpload').files = e.dataTransfer.files;\n        handleFile(item.getAsFile());\n      }\n    }\n    else if (e.dataTransfer.files) {\n      console.log('files drag');\n      document.getElementById('fileUpload').files = e.dataTransfer.files;\n      handleFile(e.dataTransfer.files[0]);\n    }\n  };\n  let handleDragOver = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n  let handleDragEnter = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragOver(true);\n  };\n  let handleDragLeave = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragOver(false);\n  };\n\n  let handleChange = (key) => (e) => {\n    setInputs({ ...inputs, [key]: e.currentTarget.value });\n  };\n\n  useEffect(() => {\n    if(!isLoggedIn) {\n      // redirect to login\n      props.history.push('/login?redirect=upload');\n    }\n\n    return () => {\n      cancel = true;\n    }\n  }, [isLoggedIn]);\n\n  useEffect(() => {\n    console.log('useeffect');\n    if(reqState.success) {\n      timer = setTimeout(() => {\n        props.history.push(`/channel/${getAuthenticatedUserID()}/files`);\n      }, 800);\n    }\n    else if(reqState.loading) {\n      console.log('is loading')\n      let data = new FormData();\n      // append user id to form data\n      data.append('user_id',getAuthenticatedUserID());\n      // append file to form data\n      data.append('file',file);\n  \n      // append the rest of inputs to form data\n      for (let key in inputs){\n        data.append(key,inputs[key]);\n      }\n      console.log(data);\n      \n      // send request\n      Api.request('post', 'files/upload', data, {}, true)\n        .then(res => {\n          if(!cancel) reqStateDispatch('success');\n        })\n        .catch(err => {\n          let msg = '';\n          // got response from server\n          if(err.response) {\n            const { status } = err.response;\n            if (status >= 500 && status < 600) {\n              msg = `Server error ${status}, please contact the admins`;\n            }\n            else if (status === 400) {\n              msg = err.response.data.error;\n            }\n            else if (status === 401) {\n              msg = \"You must be logged in\";\n            }\n            else {\n              msg = `Sorry, unknown error ${status}`;\n            }\n          }\n          // request sent but no response\n          else if(err.request) {\n            msg = 'Could not connect to the server';\n          }\n          // catch all\n          else {\n            msg = 'Sorry, unknown error';\n          }\n          if(cancel) return;\n          setErrorMessage(msg);\n          reqStateDispatch('error');\n        });\n    }\n\n    return () => {\n      clearTimeout(timer);\n    }\n  }, [reqState]);\n\n  let handleSubmit = (e) => {\n    console.log('onsubmit',reqState);\n    e.preventDefault();\n    if(!reqState.loading) reqStateDispatch('submit');\n  }\n\n  const { loading, success } = reqState;\n\n  return (\n    <div className={classes.container}>\n      <Paper className={classes.formWrapper}>\n        <form className={classes.form} onSubmit={handleSubmit}>\n          <label className={classNames(classes.fileUploadWrapper,{[classes.fileDragOver]:dragOver})}\n            onDrop={handleFileDrop}\n            onDragOver={handleDragOver}\n            onDragEnter={handleDragEnter}\n            onDragLeave={handleDragLeave}\n          >\n            {file ?\n              <div className={classes.fileUploadChildren}>\n                <CloudDone className={classes.fileUploadIcon} fontSize=\"inherit\"/>\n                <Typography variant=\"h5\" color=\"inherit\">File Ready</Typography>\n                <Typography variant=\"body1\" color=\"inherit\">{file.name}</Typography>\n              </div> :\n              <div className={classes.fileUploadChildren}>\n                <CloudUpload className={classes.fileUploadIcon} fontSize=\"inherit\"/>\n                <Typography variant=\"h5\" color=\"inherit\">Upload File</Typography>\n              </div>\n            }\n            <input id=\"fileUpload\" type='file' className={classes.fileUpload}\n              accept='image/*,video/*,audio/*'\n              onChange={handleFileSelect}\n              required={true}\n            />\n          </label>\n          <div className={classes.formTextFields}>\n            <Typography className={classes.errorMessage} variant=\"body1\" color=\"error\">\n              {errorMessage}\n            </Typography>\n            <TextField id='title' label='Title' type='text' required={true}\n              className={classes.textField} margin='normal' variant='outlined'\n              value={inputs['title']}\n              onChange={handleChange('title')}\n              disabled={loading}\n              autoFocus\n            />\n            <TextField id='description' label='Description' type='text'\n              className={classes.textField} margin='normal' variant='outlined'\n              value={inputs['description']}\n              onChange={handleChange('description')}\n              disabled={loading}\n            />\n            <TextField id='keywords' label='Keywords' type='text'\n              className={classes.textField} margin='normal' variant='outlined'\n              value={inputs['keywords']}\n              onChange={handleChange('keywords')}\n              disabled={loading}\n            />\n            <TextField id='categories' label='Categories' type='text'\n              className={classes.textField} margin='normal' variant='outlined'\n              value={inputs['categories']}\n              onChange={handleChange('categories')}\n              disabled={loading}\n            />\n            <div className={classes.buttonWrapper}>\n              <Button type='submit'\n                size='large'\n                color='primary'\n                className={classNames({\n                  [classes.buttonSuccess]: success\n                })}\n                variant='contained'\n                disabled={loading || !file}\n                >\n                Upload\n              </Button>\n              {loading && <CircularProgress size={24} className={classes.buttonProgress}/>}\n            </div>\n          </div>\n        </form>\n      </Paper>\n    </div>\n  );\n}\n","import React, {useState, useEffect, useReducer} from 'react';\nimport classNames from 'classnames';\nimport {\n  blue,\n  green,\n  red\n} from '@material-ui/core/colors';\nimport { makeStyles } from '@material-ui/styles';\nimport {\n  Paper,\n  Typography,\n  TextField,\n  Button,\n  CircularProgress,\n  ExpansionPanel,\n  ExpansionPanelSummary,\n  ExpansionPanelDetails,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions\n} from '@material-ui/core';\nimport {\n  ExpandMore\n} from '@material-ui/icons';\nimport Api from '../apiclient';\nimport { useAuthCtx, authenticate } from '../authentication';\nimport {getAuthenticatedUserID} from '../authutils';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center'\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    ...theme.mixins.gutters(),\n    paddingTop: theme.spacing.unit * 2,\n    paddingBottom: theme.spacing.unit * 2\n  },\n  form: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  buttons: {\n    display: 'flex'\n  },\n  buttonWrapper: {\n    display: 'flex',\n    alignItems: 'center',\n    margin: theme.spacing.unit,\n    position: 'relative'\n  },\n  buttonSuccess: {\n    backgroundColor: green[500],\n    '&:hover': {\n      backgroundColor: green[700]\n    }\n  },\n  buttonProgress: {\n    color: blue[500],\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    marginTop: -12,\n    marginLeft: -12\n  },\n  cancelLink: {\n    textDecoration: 'none',\n    marginTop: theme.spacing.unit * 2\n  },\n  etcOptsHeading: {\n\n  },\n  deleteButton: {\n    backgroundColor: red[700],\n    '&:hover': {\n      backgroundColor: red[900]\n    }\n  }\n}));\n\nconst initialReqState = {\n  edit: false,\n  editsuccess: false,\n  authsuccess: false,\n  warn: false,\n  deleteloading: false,\n  deletesuccess: false\n};\nconst reqStateReducer = (state, action) => {\n  switch (action) {\n    case 'submit':\n      return {...initialReqState, edit: true};\n    case 'editsuccess':\n      return {...initialReqState, editsuccess: true};\n    case 'authsuccess':\n      return {...initialReqState, authsuccess: true};\n    case 'deletebutton':\n      return {...initialReqState, warn: true};\n    case 'deleteconfirm':\n      return {...initialReqState, deleteloading: true};\n    case 'deletesuccess':\n      return {...initialReqState, deletesuccess: true};\n    case 'deletecancel':\n    case 'error':\n    case 'initial':\n      return initialReqState;\n    default:\n      return state;\n  }\n};\n\nexport default function OptionsPage(props) {\n  const classes = useStyles();\n  const [isLoggedIn,authActionDispatch] = useAuthCtx();\n  const userID = getAuthenticatedUserID();\n  const [reqState, reqStateDispatch] = useReducer(reqStateReducer, initialReqState);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [inputs, setInputs] = useState({});\n  const [deleteDialogOpen,setDeleteDialogOpen] = useState(false);\n  const [deleteSuccessDialogOpen,setDeleteSuccessDialogOpen] = useState(false);\n  let cancel = false;\n\n  let handleChange = (key) => (e) => {\n    setInputs({ ...inputs, [key]: e.currentTarget.value });\n  }\n\n  useEffect(() => {\n    if(!isLoggedIn && !reqState.deletesuccess) {\n      props.history.push('/login?redirect=options');\n    }\n    return () => {\n      cancel = true;\n    }\n  }, [isLoggedIn]);\n\n  let try_auth = async () => {\n    try {\n      let {username, password} = inputs;\n      let response = await authenticate({username,password});\n      if(response.error) {\n        reqStateDispatch('error');\n        setErrorMessage(response.error);\n      }\n      else {\n        reqStateDispatch('authsuccess');\n        setErrorMessage('');\n      }\n    }\n    catch(err) {\n      if(!cancel) return;\n      let msg = '';\n      // got response from server\n      if(err.response) {\n        const { status } = err.response;\n        if(status === 401) {\n          msg = 'Invalid login';\n        }\n        else if (status >= 500 && status < 600) {\n          msg = `Server error ${status}, please contact the admins`;\n        }\n        else {\n          msg = `Sorry, unknown error ${status}`;\n        }\n      }\n      // request sent but no response\n      else if(err.request) {\n        msg = err.message;\n      }\n      // catch all\n      else {\n        msg = 'Sorry, unknown error';\n      }\n      reqStateDispatch('error');\n      setErrorMessage(msg);\n    }\n  }\n\n  useEffect(() => {\n    let {edit, editsuccess, authsuccess, warn, deleteloading, deletesuccess} = reqState;\n    if(edit) {\n      let {oldUsername, oldPassword, username, password, email} = inputs;\n      Api.request('patch',`/users/${userID}`,{password,username,email},{auth:{'username':oldUsername,'password':oldPassword}})\n        .then(res => {\n          console.log('patch',res,cancel);\n          if(cancel) return;\n          reqStateDispatch('editsuccess');\n        })\n        .catch(err => {\n          if(cancel) return;\n          let msg = '';\n          // got response from server\n          if(err.response) {\n            const { status } = err.response;\n            if(status === 401) {\n              msg = 'Invalid login';\n            }\n            else if (status >= 500 && status < 600) {\n              msg = `Server error ${status}, please contact the admins`;\n            }\n            else {\n              msg = `Sorry, unknown error ${status}`;\n            }\n          }\n          // request sent but no response\n          else if(err.request) {\n            msg = err.message;\n          }\n          // catch all\n          else {\n            msg = 'Sorry, unknown error';\n          }\n          setErrorMessage(msg);\n          reqStateDispatch('error');\n        });\n    }\n    else if(editsuccess) {\n      try_auth();\n    }\n    else if(authsuccess) {\n\n    }\n    else if(warn) {\n      setDeleteDialogOpen(true);\n    }\n    else if(deleteloading) {\n      Api.request('delete',`/users/${userID}`,{},{},true)\n        .then(res => {\n          if(!cancel) reqStateDispatch('deletesuccess');\n        })\n        .catch(err => {\n          if(cancel) return;\n          let msg = '';\n          // got response from server\n          if(err.response) {\n            const { status } = err.response;\n            if(status === 401) {\n              msg = 'Invalid login';\n            }\n            else if (status >= 500 && status < 600) {\n              msg = `Server error ${status}, please contact the admins`;\n            }\n            else {\n              msg = `Sorry, unknown error ${status}`;\n            }\n          }\n          // request sent but no response\n          else if(err.request) {\n            msg = err.message;\n          }\n          // catch all\n          else {\n            msg = 'Sorry, unknown error';\n          }\n          setErrorMessage(msg);\n          reqStateDispatch('error');\n        });\n    }\n    else if(deletesuccess) {\n      console.log('deletesuccess');\n      setDeleteDialogOpen(false);\n      authActionDispatch({type:'logout'});\n      setDeleteSuccessDialogOpen(true);\n    }\n  }, [reqState]);\n\n  let handleSubmit = (e) => {\n    e.preventDefault();\n    let {username, password, email} = inputs;\n    if(username === '' && password === '' && email === '') {\n      setErrorMessage('Nothing to change');\n    }\n    else if(!reqState.loading) {\n      reqStateDispatch('submit');\n    }\n  }\n  let handleDeleteButton = (e) => {\n    reqStateDispatch('deletebutton');\n  }\n  let handleDeleteConfirmButton = (e) => {\n    reqStateDispatch('deleteconfirm');\n  }\n\n  const { edit, authsuccess, deleteloading } = reqState;\n  const loading = deleteloading || edit;\n\n  return (\n    <div className={classes.container}>\n      <Paper className={classes.root} elevation={1}>\n        <Typography variant=\"h5\">\n          Options\n        </Typography>\n        <Typography variant=\"body1\" color=\"error\">\n          {errorMessage}\n        </Typography>\n        <form className={classes.form} onSubmit={handleSubmit}>\n          <TextField id='oldUsername' label='Current Username' type='text' required={true}\n            className={classes.textField} margin='normal' variant='outlined'\n            onChange={handleChange('oldUsername')}\n            disabled={loading}\n            autoFocus/>\n          <TextField id='oldPassword' label='Current Password' type='password' required={true}\n            className={classes.textField} margin='normal' variant='outlined' autoComplete='on'\n            onChange={handleChange('oldPassword')}\n            disabled={loading}/>\n          <TextField id='password' label='New Password' type='password'\n            className={classes.textField} margin='normal' variant='outlined' autoComplete='on'\n            onChange={handleChange('password')}\n            disabled={loading}/>\n          <TextField id='username' label='New Username' type='text'\n            className={classes.textField} margin='normal' variant='outlined'\n            onChange={handleChange('username')}\n            disabled={loading}/>\n          <TextField id='email' label='New Email' type='text'\n            className={classes.textField} margin='normal' variant='outlined' autoComplete='on'\n            onChange={handleChange('email')}\n            disabled={loading}/>\n          <div className={classes.buttons}>\n            <div className={classes.buttonWrapper}>\n              <Button type='button'\n                size='medium'\n                color='primary'\n                variant='text'\n                onClick={() => props.history.push(`/channel/${userID}`)}\n                disabled={loading}>\n                Cancel\n              </Button>\n            </div>\n            <div className={classes.buttonWrapper}>\n              <Button type='submit'\n                size='large'\n                color='primary'\n                className={classNames({\n                  [classes.buttonSuccess]: authsuccess\n                })}\n                variant='contained'\n                disabled={loading}>\n                Save\n              </Button>\n              {loading && <CircularProgress size={24} className={classes.buttonProgress}/>}\n            </div>\n          </div>\n        </form>\n        <ExpansionPanel>\n          <ExpansionPanelSummary expandIcon={<ExpandMore />}>\n            <Typography className={classes.etcOptsHeading}>More Options</Typography>\n          </ExpansionPanelSummary>\n          <ExpansionPanelDetails>\n            <div className={classes.buttonWrapper}>\n              <Button type='button'\n                size='large'\n                className={classes.deleteButton}\n                variant='contained'\n                onClick={handleDeleteButton}\n                disabled={loading}>\n                Delete Account\n              </Button>\n            </div>\n          </ExpansionPanelDetails>\n        </ExpansionPanel>\n      </Paper>\n      <Dialog open={deleteDialogOpen} onClose={() => setDeleteDialogOpen(false)}\n        aria-labelledby=\"deleteconfirm-dialog-title\" aria-describedby='deleteconfirm-dialog-desc'>\n        <DialogTitle id=\"deleteconfirm-dialog-title\">Confirm Delete Account</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"deleteconfirm-dialog-description\">\n            Are you sure you want to delete your account?\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setDeleteDialogOpen(false)} color=\"primary\" autoFocus>Cancel</Button>\n          <Button onClick={handleDeleteConfirmButton} className={classes.deleteButton}>Delete</Button>\n        </DialogActions>\n      </Dialog>\n      <Dialog open={deleteSuccessDialogOpen} onClose={() => props.history.push('/')}\n        aria-labelledby=\"delete-dialog-title\" aria-describedby='delete-dialog-desc'>\n        <DialogTitle id=\"delete-dialog-title\">Account Deleted</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"delete-dialog-description\">\n            Your account has been deleted.\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => props.history.push('/')} color=\"primary\" autoFocus>Back to home</Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n","import React, { createContext, useReducer } from 'react';\nimport classNames from 'classnames';\nimport { makeStyles, useTheme } from '@material-ui/styles';\nimport Masthead from '../components/masthead';\nimport Sidebar from '../components/sidebar';\nimport HomePage from './home';\nimport LoginPage from './login';\nimport RegisterPage from './register';\nimport BrowsePage from './browse';\nimport ViewPage from './view';\nimport PlaylistPage from './playlist';\nimport UserPage from './channel';\nimport UploadPage from './upload';\nimport OptionsPage from './options';\nimport Error404Page from './pageNotFound';\nimport {\n  Route,\n  Switch\n} from 'react-router-dom';\n\nconst useStyles = makeStyles(theme => ({\n  layoutRoot: {\n    display: 'block',\n    backgroundColor: theme.background,\n    height: '100%',\n    width: '100%',\n    overflow: 'auto'\n  },\n  content: {\n    display: 'flex',\n    flexDirection: 'column',\n    // padding: theme.spacing.unit * 3,\n    transition: theme.transitions.create('margin', {\n      easing: theme.transitions.easing.easeOut,\n      duration: theme.transitions.duration.enteringScreen\n    }),\n    textAlign: 'center',\n    marginTop: 56,\n    padding: theme.spacing.unit * 3,\n    [theme.breakpoints.up(0)+' and (orientation: landscape)']: {\n      marginTop: 48\n    },\n    [theme.breakpoints.up('md')]: {\n      marginTop: 64\n    }\n  },\n  contentShift: {\n    [theme.breakpoints.up('md')]: {\n      transition: theme.transitions.create('margin', {\n        easing: theme.transitions.easing.easeOut,\n        duration: theme.transitions.duration.enteringScreen\n      }),\n      marginLeft: theme.drawerWidth\n    }\n  }\n}));\n\nexport const DrawerOpenDispatch = createContext(null);\n\nexport default function Layout({children}) {\n  const classes = useStyles();\n  const theme = useTheme();\n\n  const drawerOpenReducer = (state, action) => {\n    switch (action) {\n      case true:\n      case false:\n        return action;\n      case 'toggle':\n        return !state;\n      default:\n        return state;\n    }\n  };\n  const [drawerOpen, drawerOpenDispatch] = useReducer(drawerOpenReducer, document.body.clientWidth < theme.breakpoints.values.md ? false : true);\n\n  return (\n    <div className={classes.layoutRoot}>\n      <DrawerOpenDispatch.Provider value={[drawerOpen, drawerOpenDispatch]}>\n        <Masthead/>\n        <Sidebar/>\n      </DrawerOpenDispatch.Provider>\n      <main className={classNames(classes.content, {\n          [classes.contentShift]: drawerOpen\n        })}>\n        {children}\n        <Switch>\n          <Route path='/' exact component={HomePage}/>\n          <Route path='/login' component={LoginPage}/>\n          <Route path='/register' component={RegisterPage}/>\n          <Route path='/browse' component={BrowsePage}/>\n          <Route path='/upload' component={UploadPage}/>\n          <Route path='/view/:id' component={ViewPage}/>\n          <Route path='/playlist/:id' component={PlaylistPage}/>\n          <Route path='/channel/:id' component={UserPage}/>\n          <Route path='/options' component={OptionsPage}/>\n          <Route component={Error404Page}/>\n        </Switch>\n      </main>\n    </div>\n  );\n}\n\n// Layout.whyDidYouRender = {\n//   logOnDifferentValues: true\n// };\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport {BrowserRouter} from 'react-router-dom';\nimport './patch';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\n// if (process.env.NODE_ENV !== 'production') {\n//   const whyDidYouRender = require('@welldone-software/why-did-you-render');\n//   whyDidYouRender(React);\n// }\n\nReactDOM.render((\n  <BrowserRouter basename={process.env.REACT_APP_ROOT_DIR}>\n    <App />\n  </BrowserRouter>\n), document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React from 'react';\nimport Layout from './pages/layout';\nimport Theming from './theming';\nimport Authenticator from './authentication';\n\nexport default function App() {\n  return (\n    <Theming initialTheme={'dark'}>\n      <Authenticator>\n        <Layout/>\n      </Authenticator>\n    </Theming>\n  );\n}\n"],"sourceRoot":""}